(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{206:function(e,t,r){"use strict";r.r(t);var s=r(9),n=r.n(s),i=r(7),o=r(8),a=r(14);function c(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}var u={name:"ns-pos-discount-popup",data:function(){return{finalValue:1,virtualStock:null,popupSubscription:null,mode:"",type:"",allSelected:!0,isLoading:!1,keys:[].concat(c([7,8,9].map((function(e){return{identifier:e,value:e}}))),c([4,5,6].map((function(e){return{identifier:e,value:e}}))),c([1,2,3].map((function(e){return{identifier:e,value:e}}))),[{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}])}},mounted:function(){var e=this;this.mode=this.$popupParams.reference.discount_type||"percentage",this.type=this.$popupParams.type,"percentage"===this.mode?this.finalValue=this.$popupParams.reference.discount_percentage||1:this.finalValue=this.$popupParams.reference.discount||1,this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&e.$popup.close()}))},methods:{setPercentageType:function(e){this.mode=e},inputValue:function(e){"next"===e.identifier?(this.$popupParams.onSubmit({discount_type:this.mode,discount_percentage:"percentage"===this.mode?this.finalValue:void 0,discount:"flat"===this.mode?this.finalValue:void 0}),this.$popup.close()):"backspace"===e.identifier?this.allSelected?(this.finalValue=0,this.allSelected=!1):(this.finalValue=this.finalValue.toString(),this.finalValue=this.finalValue.substr(0,this.finalValue.length-1)||0):this.allSelected?(this.finalValue=e.value,this.finalValue=parseFloat(this.finalValue),this.allSelected=!1):(this.finalValue+=""+e.value,this.finalValue=parseFloat(this.finalValue),"percentage"===this.mode&&(this.finalValue=this.finalValue>100?100:this.finalValue))}}},d=r(1),p=Object(d.a)(u,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"bg-white shadow min-h-2/5-screen w-6/7-screen md:w-3/5-screen lg:w-3/5-screen xl:w-2/5-screen relative",attrs:{id:"discount-popup"}},[r("div",{staticClass:"flex-shrink-0 py-2 border-b border-gray-200"},["product"===e.type?r("h1",{staticClass:"text-xl font-bold text-gray-700 text-center"},[e._v("Product Discount")]):e._e(),e._v(" "),"cart"===e.type?r("h1",{staticClass:"text-xl font-bold text-gray-700 text-center"},[e._v("Cart Discount")]):e._e()]),e._v(" "),r("div",{staticClass:"h-16 bg-gray-800 text-white border-gray-200 flex items-center justify-center",attrs:{id:"screen"}},[r("h1",{staticClass:"font-bold text-3xl"},["flat"===e.mode?r("span",[e._v(e._s(e._f("currency")(e.finalValue)))]):e._e(),e._v(" "),"percentage"===e.mode?r("span",[e._v(e._s(e.finalValue)+"%")]):e._e()])]),e._v(" "),r("div",{staticClass:"flex",attrs:{id:"switch-mode"}},[r("button",{staticClass:"outline-none w-1/2 py-2 flex items-center justify-center",class:"flat"===e.mode?"bg-gray-800 text-white":"",on:{click:function(t){return e.setPercentageType("flat")}}},[e._v("Flat")]),e._v(" "),r("hr",{staticClass:"border-r border-gray-200"}),e._v(" "),r("button",{staticClass:"outline-none w-1/2 py-2 flex items-center justify-center",class:"percentage"===e.mode?"bg-gray-800 text-white":"",on:{click:function(t){return e.setPercentageType("percentage")}}},[e._v("Percentage")])]),e._v(" "),r("div",{staticClass:"grid grid-flow-row grid-cols-3 grid-rows-3",attrs:{id:"numpad"}},e._l(e.keys,(function(t,s){return r("div",{key:s,staticClass:"hover:bg-blue-400 hover:text-white hover:border-blue-600 text-xl font-bold border border-gray-200 h-24 flex items-center justify-center cursor-pointer",on:{click:function(r){return e.inputValue(t)}}},[void 0!==t.value?r("span",[e._v(e._s(t.value))]):e._e(),e._v(" "),t.icon?r("i",{staticClass:"las",class:t.icon}):e._e()])})),0)])}),[],!1,null,null,null).exports,b=r(10);function f(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}var h={name:"sample-payment",props:["label","identifier"],data:function(){return{backValue:"0",number:parseInt(1+new Array(parseInt(ns.currency.ns_currency_precision)).fill("").map((function(e){return 0})).join("")),order:null,cursor:parseInt(ns.currency.ns_currency_precision),orderSubscription:null,allSelected:!0,keys:[].concat(f([7,8,9].map((function(e){return{identifier:e,value:e}}))),f([4,5,6].map((function(e){return{identifier:e,value:e}}))),f([1,2,3].map((function(e){return{identifier:e,value:e}}))),[{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}])}},mounted:function(){var e=this;this.orderSubscription=POS.order.subscribe((function(t){e.order=t}))},destroyed:function(){this.orderSubscription.unsubscribe()},methods:{toggleDiscount:function(){var e=this;i.a.show(p,{reference:this.order,type:"cart",onSubmit:function(t){POS.updateCart(e.order,t)}})},makeFullPayment:function(){var e=this;i.a.show(b.default,{title:"Confirm Full Payment",message:"A full payment will be made using {paymentType} for {total}".replace("{paymentType}",this.label).replace("{total}",this.$options.filters.currency(this.order.total)),onAction:function(t){if(t){var r=POS.order.getValue();r.tendered<r.total&&POS.addPayment({value:e.order.total-r.tendered,identifier:e.identifier,selected:!1,label:e.label,readonly:!1}),e.$emit("submit"),e.backValue="0"}}})},increaseBy:function(e){var t=parseInt(1+new Array(this.cursor).fill("").map((function(e){return 0})).join(""));this.backValue=(parseFloat(e.value)*t+(parseFloat(this.backValue)||0)).toString(),this.allSelected=!1},inputValue:function(e){parseInt(1+new Array(this.cursor).fill("").map((function(e){return 0})).join(""));"next"===e.identifier?(POS.addPayment({value:parseFloat(this.backValue/this.number),identifier:this.identifier,selected:!1,label:this.label,readonly:!1}),this.backValue="0"):"backspace"===e.identifier?this.allSelected?(this.backValue="0",this.allSelected=!1):this.backValue=this.backValue.substr(1):e.value.toString().match(/^\d+$/)&&(this.allSelected?(this.backValue=e.value.toString(),this.allSelected=!1):(this.backValue+=e.value.toString(),"percentage"===this.mode&&(this.backValue=this.backValue>100?100:this.backValue))),"0"===this.backValue&&(this.backValue="")}}},m=Object(d.a)(h,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"h-full w-full py-2"},[e.order?r("div",{staticClass:"px-2 pb-2"},[r("div",{staticClass:"grid grid-cols-2 gap-2"},[r("div",{staticClass:"h-16 flex justify-between items-center bg-blue-400 text-white text-xl md:text-3xl p-2",attrs:{id:"details"}},[r("span",[e._v("Total : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.total)))])]),e._v(" "),r("div",{staticClass:"cursor-pointer h-16 flex justify-between items-center bg-red-400 text-white text-xl md:text-3xl p-2",attrs:{id:"discount"},on:{click:function(t){return e.toggleDiscount()}}},[r("span",[e._v("Discount : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.discount)))])]),e._v(" "),r("div",{staticClass:"h-16 flex justify-between items-center bg-green-400 text-white text-xl md:text-3xl p-2",attrs:{id:"paid"}},[r("span",[e._v("Paid : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.tendered)))])]),e._v(" "),r("div",{staticClass:"h-16 flex justify-between items-center bg-teal-400 text-white text-xl md:text-3xl p-2",attrs:{id:"change"}},[r("span",[e._v("Change : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.change)))])]),e._v(" "),r("div",{staticClass:"col-span-2 h-16 flex justify-between items-center bg-gray-300 text-gray-800 text-xl md:text-3xl p-2",attrs:{id:"change"}},[r("span",[e._v("Screen : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.backValue/e.number)))])])])]):e._e(),e._v(" "),r("div",{staticClass:"px-2 pb-2"},[r("div",{staticClass:"-mx-2 flex flex-wrap"},[r("div",{staticClass:"pl-2 pr-1 flex-auto"},[r("div",{staticClass:"grid grid-flow-row grid-cols-3 gap-2 grid-rows-3",staticStyle:{padding:"1px"},attrs:{id:"numpad"}},[e._l(e.keys,(function(t,s){return r("div",{key:s,staticClass:"hover:bg-gray-400 hover:text-gray-800 bg-gray-300 text-2xl text-gray-700 border h-16 flex items-center justify-center cursor-pointer",staticStyle:{margin:"-1px"},on:{click:function(r){return e.inputValue(t)}}},[void 0!==t.value?r("span",[e._v(e._s(t.value))]):e._e(),e._v(" "),t.icon?r("i",{staticClass:"las",class:t.icon}):e._e()])})),e._v(" "),r("div",{staticClass:"hover:bg-green-500 col-span-3 bg-green-400 text-2xl text-white border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.makeFullPayment()}}},[e._v("\n                        Full Payment")])],2)]),e._v(" "),r("div",{staticClass:"w-1/2 md:w-72 pr-2 pl-1"},[r("div",{staticClass:"grid grid-flow-row grid-rows-1 gap-2"},[r("div",{staticClass:"hover:bg-gray-400 hover:text-gray-800 bg-gray-300 text-2xl text-gray-700 border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.increaseBy({value:100})}}},[r("span",[e._v(e._s(e._f("currency")(100)))])]),e._v(" "),r("div",{staticClass:"hover:bg-gray-400 hover:text-gray-800 bg-gray-300 text-2xl text-gray-700 border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.increaseBy({value:500})}}},[r("span",[e._v(e._s(e._f("currency")(500)))])]),e._v(" "),r("div",{staticClass:"hover:bg-gray-400 hover:text-gray-800 bg-gray-300 text-2xl text-gray-700 border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.increaseBy({value:1e3})}}},[r("span",[e._v(e._s(e._f("currency")(1e3)))])])])])])])])}),[],!1,null,null,null).exports,_={name:"cash-payment",props:["identifier"],components:{samplePayment:m}},g=Object(d.a)(_,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("sample-payment",{attrs:{identifier:e.identifier,label:"Cash"},on:{submit:function(t){return e.$emit("submit")}}})}),[],!1,null,null,null).exports,y={name:"creditcart-payment",props:["identifier"]},x=Object(d.a)(y,(function(){var e=this.$createElement;return(this._self._c||e)("h1",[this._v("Credit Card")])}),[],!1,null,null,null).exports,C={name:"bank-payment",props:["identifier"],components:{samplePayment:m}},w=Object(d.a)(C,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("sample-payment",{attrs:{identifier:e.identifier,label:"Bank Transfer"},on:{submit:function(t){return e.$emit("submit")}}})}),[],!1,null,null,null).exports,S=r(20),k=r(0),P={name:"ns-account-payment",components:{nsNumpad:S.a},props:["identifier","label"],data:function(){return{subscription:null,screenValue:0,order:null}},methods:{handleChange:function(e){this.screenValue=e},proceedAddingPayment:function(e){var t=parseFloat(e),r=this.order.payments;return t<=0?k.nsSnackBar.error("Please provide a valid payment amount.").subscribe():r.filter((function(e){return"account-payment"===e.identifier})).length>0?k.nsSnackBar.error("The customer account can only be used once per order. Consider deleting the previously used payment.").subscribe():t>this.order.customer.account_amount?k.nsSnackBar.error("Not enough funds to add {amount} as a payment. Available balance {balance}.".replace("{amount}",this.$options.filters.currency(t)).replace("{balance}",this.$options.filters.currency(this.order.customer.account_amount))).subscribe():(POS.addPayment({value:t,identifier:"account-payment",selected:!1,label:this.label,readonly:!1}),this.order.customer.account_amount-=t,POS.selectCustomer(this.order.customer),void this.$emit("submit"))},proceedFullPayment:function(){this.proceedAddingPayment(this.order.total)},makeFullPayment:function(){var e=this;Popup.show(b.default,{title:"Confirm Full Payment",message:"You're about to use {amount} from the customer account to make a payment. Would you like to proceed ?".replace("{amount}",this.$options.filters.currency(this.order.total)),onAction:function(t){t&&e.proceedFullPayment()}})}},mounted:function(){var e=this;this.subscription=POS.order.subscribe((function(t){return e.order=t}))},destroyed:function(){this.subscription.unsubscribe()}},O=Object(d.a)(P,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"h-full w-full py-2"},[e.order?r("div",{staticClass:"px-2 pb-2"},[r("div",{staticClass:"grid grid-cols-2 gap-2"},[r("div",{staticClass:"h-16 flex justify-between items-center bg-blue-400 text-white text-xl md:text-3xl p-2",attrs:{id:"details"}},[r("span",[e._v("Total : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.total)))])]),e._v(" "),r("div",{staticClass:"cursor-pointer h-16 flex justify-between items-center bg-red-400 text-white text-xl md:text-3xl p-2",attrs:{id:"discount"},on:{click:function(t){return e.toggleDiscount()}}},[r("span",[e._v("Discount : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.discount)))])]),e._v(" "),r("div",{staticClass:"h-16 flex justify-between items-center bg-green-400 text-white text-xl md:text-3xl p-2",attrs:{id:"paid"}},[r("span",[e._v("Paid : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.tendered)))])]),e._v(" "),r("div",{staticClass:"h-16 flex justify-between items-center bg-teal-400 text-white text-xl md:text-3xl p-2",attrs:{id:"change"}},[r("span",[e._v("Change : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.change)))])]),e._v(" "),r("div",{staticClass:"col-span-2 h-16 flex justify-between items-center bg-blue-400 text-white text-xl md:text-3xl p-2",attrs:{id:"change"}},[r("span",[e._v("Current Balance : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.customer.account_amount)))])]),e._v(" "),r("div",{staticClass:"col-span-2 h-16 flex justify-between items-center bg-gray-300 text-gray-800 text-xl md:text-3xl p-2",attrs:{id:"change"}},[r("span",[e._v("Screen : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.screenValue)))])])])]):e._e(),e._v(" "),r("div",{staticClass:"px-2 pb-2"},[r("div",{staticClass:"-mx-2 flex flex-wrap"},[r("div",{staticClass:"pl-2 pr-1 flex-auto"},[r("ns-numpad",{on:{changed:function(t){return e.handleChange(t)},next:function(t){return e.proceedAddingPayment(t)}},scopedSlots:e._u([{key:"numpad-footer",fn:function(){return[r("div",{staticClass:"hover:bg-green-500 col-span-3 bg-green-400 text-2xl text-white border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.makeFullPayment()}}},[e._v("\n                        Full Payment")])]},proxy:!0}])})],1),e._v(" "),r("div",{staticClass:"w-1/2 md:w-72 pr-2 pl-1"},[r("div",{staticClass:"grid grid-flow-row grid-rows-1 gap-2"},[r("div",{staticClass:"hover:bg-gray-400 hover:text-gray-800 bg-gray-300 text-2xl text-gray-700 border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.increaseBy({value:100})}}},[r("span",[e._v(e._s(e._f("currency")(100)))])]),e._v(" "),r("div",{staticClass:"hover:bg-gray-400 hover:text-gray-800 bg-gray-300 text-2xl text-gray-700 border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.increaseBy({value:500})}}},[r("span",[e._v(e._s(e._f("currency")(500)))])]),e._v(" "),r("div",{staticClass:"hover:bg-gray-400 hover:text-gray-800 bg-gray-300 text-2xl text-gray-700 border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.increaseBy({value:1e3})}}},[r("span",[e._v(e._s(e._f("currency")(1e3)))])])])])])])])}),[],!1,null,null,null).exports,j={name:"ns-pos-loading-popup"},T=Object(d.a)(j,(function(){var e=this.$createElement;return(this._self._c||e)("ns-spinner")}),[],!1,null,null,null).exports;function $(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var E={name:"ns-pos-payment",data:function(){return{paymentTypesSubscription:null,paymentsType:[],order:null,showPayment:!1,orderSubscription:null,currentPaymentComponent:null}},computed:{activePayment:function(){var e;return(e=this.paymentsType.filter((function(e){return e.selected}))).length>0&&e[0]},expectedPayment:function(){var e=this.order.customer.group.minimal_credit_payment;return this.order.total*e/100}},mounted:function(){var e=this;this.$popup.event.subscribe((function(t){switch(t.event){case"click-overlay":e.closePopup()}})),this.orderSubscription=POS.order.subscribe((function(t){return e.order=t})),this.paymentTypesSubscription=POS.paymentsType.subscribe((function(t){e.paymentsType=t}))},watch:{activePayment:function(e){this.loadPaymentComponent(e)}},destroyed:function(){this.orderSubscription.unsubscribe(),this.paymentTypesSubscription.unsubscribe()},methods:{resolveIfQueued:a.a,loadPaymentComponent:function(e){switch(e.identifier){case"cash-payment":this.currentPaymentComponent=g;break;case"creditcard-payment":this.currentPaymentComponent=x;break;case"bank-payment":this.currentPaymentComponent=w;break;case"account-payment":this.currentPaymentComponent=O}},select:function(e){this.showPayment=!1,POS.setPaymentActive(e)},closePopup:function(){this.$popup.close()},deletePayment:function(e){POS.removePayment(e)},selectPaymentAsActive:function(e){this.select(this.paymentsType.filter((function(t){return t.identifier===e.target.value}))[0])},submitOrder:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.a.show(T);try{var s=V(V({},POS.order.getValue()),t);POS.submitOrder(s).then((function(t){r.close(),k.nsSnackBar.success(t.message).subscribe(),POS.printOrder(t.data.order.id),e.$popup.close()}),(function(e){r.close(),k.nsSnackBar.error(e.message).subscribe()}))}catch(e){r.close(),k.nsSnackBar.error(error.message).subscribe()}}}},F=Object(d.a)(E,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.order?r("div",{staticClass:"w-screen h-screen p-4 flex overflow-hidden"},[r("div",{staticClass:"flex flex-col flex-auto lg:flex-row bg-white shadow-xl"},[r("div",{staticClass:"w-full lg:w-56 bg-gray-300 lg:h-full flex justify-between px-2 lg:px-0 lg:block items-center lg:items-start"},[r("h3",{staticClass:"text-xl text-center my-4 font-bold lg:my-8 text-gray-700"},[e._v("Payments Gateway")]),e._v(" "),r("ul",{staticClass:"hidden lg:block"},[e._l(e.paymentsType,(function(t){return r("li",{key:t.identifier,staticClass:"cursor-pointer hover:bg-gray-400 py-2 px-3",class:t.selected&&!e.showPayment?"bg-white text-gray-800":"text-gray-700",on:{click:function(r){return e.select(t)}}},[e._v(e._s(t.label))])})),e._v(" "),r("li",{staticClass:"cursor-pointer text-gray-700 hover:bg-gray-400 py-2 px-3 border-t border-gray-400 mt-4 flex items-center justify-between",class:e.showPayment?"bg-white text-gray-800":"text-gray-700",on:{click:function(t){e.showPayment=!0}}},[r("span",[e._v("Payment List")]),e._v(" "),r("span",{staticClass:"px-2 rounded-full h-8 w-8 flex items-center justify-center bg-green-500 text-white"},[e._v(e._s(e.order.payments.length))])])],2),e._v(" "),r("ns-close-button",{staticClass:"lg:hidden",on:{click:function(t){return e.closePopup()}}})],1),e._v(" "),r("div",{staticClass:"overflow-hidden flex flex-col flex-auto"},[r("div",{staticClass:"flex flex-col flex-auto overflow-hidden"},[r("div",{staticClass:"h-12 bg-gray-300 hidden items-center justify-between lg:flex"},[r("div"),e._v(" "),r("div",{staticClass:"px-2"},[r("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)]),e._v(" "),e.showPayment?e._e():r("div",{staticClass:"flex flex-auto overflow-y-auto"},[r(e.currentPaymentComponent,{tag:"component",attrs:{label:e.activePayment.label,identifier:e.activePayment.identifier},on:{submit:function(t){return e.submitOrder()}}})],1),e._v(" "),e.showPayment?r("div",{staticClass:"flex flex-auto overflow-y-auto p-2 flex-col"},[r("h3",{staticClass:"text-center font-bold py-2 text-gray-700"},[e._v("List Of Payments")]),e._v(" "),r("ul",{staticClass:"flex-auto"},[0===e.order.payments.length?r("li",{staticClass:"p-2 bg-gray-200 flex justify-center mb-2 items-center"},[r("h3",{staticClass:"font-semibold"},[e._v("No Payment added.")])]):e._e(),e._v(" "),e._l(e.order.payments,(function(t,s){return r("li",{key:s,staticClass:"p-2 bg-gray-200 flex justify-between mb-2 items-center"},[r("span",[e._v(e._s(t.label))]),e._v(" "),r("div",{staticClass:"flex items-center"},[r("span",[e._v(e._s(e._f("currency")(t.value)))]),e._v(" "),r("button",{staticClass:"rounded-full bg-red-400 h-8 w-8 flex items-center justify-center text-white ml-2",on:{click:function(r){return e.deletePayment(t)}}},[r("i",{staticClass:"las la-trash-alt"})])])])}))],2)]):e._e()]),e._v(" "),r("div",{staticClass:"flex flex-col lg:flex-row w-full bg-gray-300 justify-between p-2"},[r("div",{staticClass:"flex mb-1"},[r("div",{staticClass:"flex items-center lg:hidden"},[r("h3",{staticClass:"font-semibold mr-2"},[e._v("Select Payment")]),e._v(" "),r("select",{staticClass:"p-2 rounded border-2 border-blue-400 bg-white shadow",on:{change:function(t){return e.selectPaymentAsActive(t)}}},[r("option",{attrs:{value:""}},[e._v("Choose Payment")]),e._v(" "),e._l(e.paymentsType,(function(t){return r("option",{key:t.identifier,domProps:{selected:e.activePayment.identifier===t.identifier,value:t.identifier},on:{click:function(r){return e.select(t)}}},[e._v(e._s(t.label))])}))],2)])]),e._v(" "),r("div",{staticClass:"flex justify-end"},[e.order.tendered>=e.order.total?r("ns-button",{attrs:{type:e.order.tendered>=e.order.total?"success":"info"},on:{click:function(t){return e.submitOrder()}}},[r("span",[r("i",{staticClass:"las la-cash-register"}),e._v(" Submit Payment")])]):e._e(),e._v(" "),e.order.tendered<e.order.total?r("ns-button",{attrs:{type:e.order.tendered>=e.order.total?"success":"info"},on:{click:function(t){return e.submitOrder({payment_status:"unpaid"})}}},[r("span",[r("i",{staticClass:"las la-bookmark"}),e._v(" Layaway — "+e._s(e._f("currency")(e.expectedPayment)))])]):e._e()],1)])])])]):e._e()}),[],!1,null,null,null).exports,I=(r(208),r(66)),B=r(55),D=r(38);class N{constructor(e){this.order=e}run(){return new Promise((e,t)=>0===this.order.products.length?(k.nsSnackBar.error("You need to provide some products before proceeding.").subscribe(),t(!1)):e(!0))}}class G{constructor(e){this.order=e}run(){return new Promise((e,t)=>void 0===this.order.customer?i.a.show(D.a,{resolve:e,reject:t}):e(!0))}}class H{constructor(e){this.order=e}run(){return new Promise((e,t)=>{i.a.show(F,{resolve:e,reject:t})})}}const L=r(55).default;class W{constructor(e){this.order=e}run(){return new Promise((e,t)=>{if(void 0===this.order.type)return i.a.show(L,{resolve:e,reject:t});e(!0)})}}var R=r(67),q=r(61),U=r(13),z={name:"ns-pos-hold-orders",data:function(){return{order:{},title:""}},mounted:function(){this.popupCloser(),this.$refs.reference.focus(),this.$refs.reference.select(),this.order=this.$popupParams.order,this.title=this.$popupParams.order.title||""},methods:{popupCloser:U.a,submitHold:function(){this.$popup.close(),this.$popupParams.resolve({title:this.title})}}},Q=Object(d.a)(z,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"bg-white shadow-lg w-6/7-screen md:w-3/7-screen lg:w-2/6-screen"},[r("div",{staticClass:"p-2 flex justify-between border-b items-center"},[r("h3",{staticClass:"font-semibold"},[e._v("Hold Order")]),e._v(" "),r("div",[r("ns-close-button",{on:{click:function(t){return e.$popup.close()}}})],1)]),e._v(" "),r("div",{staticClass:"flex-auto"},[r("div",{staticClass:"border-b h-16 flex items-center justify-center"},[r("span",{staticClass:"text-5xl text-gray-700"},[e._v(e._s(e._f("currency")(e.order.total)))])]),e._v(" "),r("div",{staticClass:"p-2"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"title"}],ref:"reference",staticClass:"rounded border-2 border-blue-400 bg-white p-2 w-full",attrs:{type:"text",placeholder:"Order Reference"},domProps:{value:e.title},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitHold()},input:function(t){t.target.composing||(e.title=t.target.value)}}})]),e._v(" "),e._m(0)]),e._v(" "),r("div",{staticClass:"flex"},[r("div",{staticClass:" cursor-pointer w-1/2 py-3 flex justify-center items-center bg-green-500 text-white font-semibold",on:{click:function(t){return e.submitHold()}}},[e._v("\n            Confirm\n        ")]),e._v(" "),r("div",{staticClass:"cursor-pointer w-1/2 py-3 flex justify-center items-center bg-red-500 text-white font-semibold",on:{click:function(t){return e.$popup.close()}}},[e._v("\n            Cancel\n        ")])])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"p-2"},[t("p",{staticClass:"text-gray-600"},[this._v("\n                The current order will be set on hold. You can retreive this order from the pending order button. \n                Providing a reference to it might help you to identify the order more quickly.\n            ")])])}],!1,null,null,null).exports,M={name:"ns-pos-note-popup",data:function(){return{validation:new o.a,fields:[{label:"Note",name:"note",value:"",description:"More details about this order",type:"textarea"},{label:"Display On Receipt",name:"note_visibility",value:"",options:[{label:"Yes",value:"visible"},{label:"No",value:"hidden"}],description:"Will display the note on the receipt",type:"switch"}]}},mounted:function(){var e=this;this.popupCloser(),this.fields.forEach((function(t){"note"===t.name?t.value=e.$popupParams.note:"note_visibility"===t.name&&(t.value=e.$popupParams.note_visibility)}))},methods:{popupResolver:a.a,popupCloser:U.a,closePopup:function(){this.popupResolver(!1)},saveNote:function(){if(!this.validation.validateFields(this.fields)){var e=this.validation.validateFieldsErrors(this.fields);return this.validation.triggerFieldsErrors(this.fields,e),this.$forceUpdate(),console.log(this.fields),k.nsSnackBar.error("Unable to proceed the form is not valid.").subscribe()}return this.popupResolver(this.validation.extractFields(this.fields))}}},Y=Object(d.a)(M,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"shadow-lg bg-white w-95vw md:w-3/5-screen lg:w-2/5-screen"},[r("div",{staticClass:"p-2 flex justify-between items-center border-b border-gray-200"},[r("h3",{staticClass:"font-bold"},[e._v("Order Note")]),e._v(" "),r("div",[r("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)]),e._v(" "),r("div",{staticClass:"p-2 border-b border-gray-200"},e._l(e.fields,(function(e,t){return r("ns-field",{key:t,attrs:{field:e}})})),1),e._v(" "),r("div",{staticClass:"p-2 flex justify-end"},[r("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.saveNote()}}},[e._v("Save")])],1)])}),[],!1,null,null,null).exports,J={name:"ns-pos-tax-popup",data:function(){return{validation:new o.a,tax_group:[],order:null,orderSubscriber:null,optionsSubscriber:null,options:{},tax_groups:[],activeTab:"",group_fields:[{label:"Select Tax",name:"tax_group_id",description:"Define the tax that apply to the sale.",type:"select",disabled:!0,value:"",options:[]},{label:"Type",name:"tax_type",disabled:!0,value:"",description:"Define how the tax is computed",type:"select",options:[{label:"Exclusive",value:"exclusive"},{label:"Inclusive",value:"inclusive"}]}]}},mounted:function(){var e=this;this.loadGroups(),this.popupCloser(),this.activeTab=this.$popupParams.activeTab||"settings",this.group_fields.forEach((function(t){t.value=e.$popupParams[t.name]||void 0})),this.orderSubscriber=POS.order.subscribe((function(t){e.order=t})),this.optionsSubscriber=POS.options.subscribe((function(t){e.options=t,["variable_vat","products_variable_vat"].includes(e.options.ns_pos_vat)&&e.group_fields.forEach((function(e){return e.disabled=!1}))}))},destroyed:function(){this.orderSubscriber.unsubscribe(),this.optionsSubscriber.unsubscribe()},methods:{popupCloser:U.a,popupResolver:a.a,changeActive:function(e){this.activeTab=e},closePopup:function(){this.popupResolver(!1)},saveTax:function(){var e=this.validation.extractFields(this.group_fields);this.popupResolver(e)},loadGroups:function(){var e=this;k.nsHttpClient.get("/api/nexopos/v4/taxes/groups").subscribe((function(t){e.groups=t,e.group_fields.forEach((function(t){"tax_group_id"===t.name&&(t.options=e.groups.map((function(e){return{label:e.name,value:e.id}})))}))}))}}},K=Object(d.a)(J,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"bg-white shadow-lg w-95vw md:w-3/5-screen lg:w-2/5-screen"},[r("div",{staticClass:"p-2 flex justify-between items-center border-b border-gray-200"},[r("h3",{staticClass:"text-blog"},[e._v("Tax & Summary")]),e._v(" "),r("div",[r("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)]),e._v(" "),r("div",{staticClass:"p-2 bg-gray-50"},[r("ns-tabs",{attrs:{active:e.activeTab},on:{changeTab:function(t){return e.changeActive(t)}}},[r("ns-tabs-item",{attrs:{padding:"0",label:"Settings",identifier:"settings",active:!0}},[r("div",{staticClass:"p-2 border-b border-gray-200"},e._l(e.group_fields,(function(e,t){return r("ns-field",{key:t,attrs:{field:e}})})),1),e._v(" "),r("div",{staticClass:"flex justify-end p-2"},[r("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.saveTax()}}},[e._v("Save")])],1)]),e._v(" "),r("ns-tabs-item",{attrs:{padding:"0",label:"Summary",identifier:"summary",active:!1}},[e.order?r("div",{staticClass:"p-2"},[e._l(e.order.taxes,(function(t){return r("div",{key:t.id,staticClass:"border-blue-200 mb-2 border bg-blue-100 shadow p-2 w-full flex justify-between items-center text-gray-700"},[r("span",[e._v(e._s(t.tax_name))]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(t.tax_value)))])])})),e._v(" "),0===e.order.taxes.length?r("div",{staticClass:"p-2 text-center text-gray-600"},[e._v("No tax is active")]):e._e()],2):e._e()])],1)],1)])}),[],!1,null,null,null).exports,X={name:"ns-pos-coupons-popup",data:function(){return{orderSubscriber:null,hasLoaded:!1,order:null,coupons:[]}},mounted:function(){var e=this;this.popupCloser(),this.orderSubscriber=POS.order.subscribe((function(t){e.order=t})),this.loadCoupons()},destroyed:function(){this.orderSubscriber.unsubscribe()},methods:{popupCloser:U.a,popupResolver:a.a,closePopup:function(){this.popupResolver(!1)},loadCoupons:function(){var e=this;this.hasLoaded=!1,nsHttpClient.get("/api/nexopos/v4/customers/".concat(this.order.customer_id,"/coupons")).subscribe((function(t){e.hasLoaded=!0,e.coupons=t}))}}},Z=(Object(d.a)(X,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"shadow-lg bg-white w-95vw md:w-3/5-screen lg:w-2/5-screen"},[r("div",{staticClass:"border-b border-gray-200 p-2 flex justify-between items-center"},[r("h3",{staticClass:"font-bold"},[e._v("Coupons")]),e._v(" "),r("div",[r("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)]),e._v(" "),r("div",{staticClass:"p-2"},[e.hasLoaded?e._e():r("div",{staticClass:"p-4"},[r("ns-spinner")],1),e._v(" "),e.hasLoaded?r("ul",[e._l(e.coupons,(function(t){return r("li",{key:t.id,staticClass:"p-2 cursor-pointer flex justify-between bg-gray-100 hover:bg-blue-200"},[r("span",[e._v(e._s(t.name))]),e._v(" "),e._m(0,!0)])})),e._v(" "),0===e.coupons.length&&e.hasLoaded?r("li",{staticClass:"py-3 text-center"},[e._v("No coupon available for this customer")]):e._e()],2):e._e()])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("span",[t("button",{staticClass:"rounded-full px-3 py-1"},[this._v("Use")])])}],!1,null,null,null).exports,r(5)),ee=(r(204),{name:"ns-pos-coupons-load-popup",data:function(){return{placeHolder:Object(Z.a)("Coupon Code"),couponCode:null,order:null,activeTab:"apply-coupon",orderSubscriber:null,customerCoupon:null}},mounted:function(){var e=this;this.popupCloser(),this.$refs.coupon.select(),this.orderSubscriber=POS.order.subscribe((function(t){e.order=t,e.order.coupons.length>0&&(e.activeTab="active-coupons")}))},destroyed:function(){this.orderSubscriber.unsubscribe()},methods:{__:Z.a,popupCloser:U.a,popupResolver:a.a,selectCustomer:function(){Popup.show(D.a)},cancel:function(){this.customerCoupon=null,this.couponCode=null},removeCoupon:function(e){this.order.coupons.splice(e,1),POS.refreshCart()},apply:function(){var e=this;try{var t=this.customerCoupon;if(null!==this.customerCoupon.coupon.valid_hours_start&&!ns.date.moment.isAfter(this.customerCoupon.coupon.valid_hours_start)&&this.customerCoupon.coupon.valid_hours_start.length>0)return k.nsSnackBar.error(Object(Z.a)("The coupon is out from validity date range.")).subscribe();if(null!==this.customerCoupon.coupon.valid_hours_end&&!ns.date.moment.isBefore(this.customerCoupon.coupon.valid_hours_end)&&this.customerCoupon.coupon.valid_hours_end.length>0)return k.nsSnackBar.error(Object(Z.a)("The coupon is out from validity date range.")).subscribe();var r=this.customerCoupon.coupon.products;if(r.length>0){var s=r.map((function(e){return e.product_id}));if(0===this.order.products.filter((function(e){return s.includes(e.product_id)})).length)return k.nsSnackBar.error(Object(Z.a)("This coupon requires products that aren't available on the cart at the moment.")).subscribe()}var n=this.customerCoupon.coupon.categories;if(n.length>0){var i=n.map((function(e){return e.category_id}));if(0===this.order.products.filter((function(e){return i.includes(e.$original().category_id)})).length)return k.nsSnackBar.error(Object(Z.a)("This coupon requires products that belongs to specific categories that aren't included at the moment.").replace("%s")).subscribe()}this.cancel();var o={active:t.coupon.active,customer_coupon_id:t.id,minimum_cart_value:t.coupon.minimum_cart_value,maximum_cart_value:t.coupon.maximum_cart_value,name:t.coupon.name,type:t.coupon.type,value:0,limit_usage:t.coupon.limit_usage,code:t.coupon.code,discount_value:t.coupon.discount_value,categories:t.coupon.categories,products:t.coupon.products};POS.pushCoupon(o),this.activeTab="active-coupons",setTimeout((function(){e.popupResolver(o)}),500),k.nsSnackBar.success(Object(Z.a)("The coupon has applied to the cart.")).subscribe()}catch(e){console.log(e)}},getCouponType:function(e){switch(e){case"percentage_discount":return Object(Z.a)("Percentage");case"flat_discount":return Object(Z.a)("Flat");default:return Object(Z.a)("Unknown Type")}},getDiscountValue:function(e){switch(e.type){case"percentage_discount":return e.discount_value+"%";case"flat_discount":return this.$options.filters.currency(e.discount_value)}},closePopup:function(){this.popupResolver(!1)},setActiveTab:function(e){this.activeTab=e},loadCoupon:function(){var e=this,t=this.couponCode;k.nsHttpClient.post("/api/nexopos/v4/customers/coupons/".concat(t),{customer_id:this.order.customer_id}).subscribe((function(t){e.customerCoupon=t,k.nsSnackBar.success(Object(Z.a)("The coupon has been loaded.")).subscribe()}),(function(e){k.nsSnackBar.error(e.message||Object(Z.a)("An unexpected error occured.")).subscribe()}))}}}),te=Object(d.a)(ee,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"shadow-lg bg-white w-95vw md:w-3/6-screen lg:w-2/6-screen"},[r("div",{staticClass:"border-b border-gray-200 p-2 flex justify-between items-center"},[r("h3",{staticClass:"font-bold text-gray-700"},[e._v(e._s(e.__("Load Coupon")))]),e._v(" "),r("div",[r("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)]),e._v(" "),r("div",{staticClass:"p-1"},[r("ns-tabs",{attrs:{active:e.activeTab},on:{changeTab:function(t){return e.setActiveTab(t)}}},[r("ns-tabs-item",{attrs:{label:e.__("Apply A Coupon"),padding:"p-2",identifier:"apply-coupon"}},[r("div",{staticClass:"border-2 border-blue-400 rounded flex"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.couponCode,expression:"couponCode"}],ref:"coupon",staticClass:"w-full p-2",attrs:{type:"text",placeholder:e.placeHolder},domProps:{value:e.couponCode},on:{input:function(t){t.target.composing||(e.couponCode=t.target.value)}}}),e._v(" "),r("button",{staticClass:"bg-blue-400 text-white px-3 py-2",on:{click:function(t){return e.loadCoupon()}}},[e._v(e._s(e.__("Load")))])]),e._v(" "),r("div",{staticClass:"pt-2"},[r("p",{staticClass:"p-2 text-center bg-green-100 text-green-600"},[e._v(e._s(e.__("Input the coupon code that should apply to the POS. If a coupon is issued for a customer, that customer must be selected priorly.")))])]),e._v(" "),e.order&&void 0===e.order.customer_id?r("div",{staticClass:"pt-2",on:{click:function(t){return e.selectCustomer()}}},[r("p",{staticClass:"p-2 cursor-pointer text-center bg-red-100 text-red-600"},[e._v(e._s(e.__("Click here to choose a customer.")))])]):e._e(),e._v(" "),e.order&&void 0!==e.order.customer_id?r("div",{staticClass:"pt-2"},[r("p",{staticClass:"p-2 text-center bg-green-100 text-green-600"},[e._v(e._s(e.__("Loading Coupon For : ")+e.order.customer.name+" "+e.order.customer.surname))])]):e._e(),e._v(" "),r("div",{staticClass:"overflow-hidden"},[e.customerCoupon?r("div",{staticClass:"pt-2 fade-in-entrance anim-duration-500 overflow-y-auto h-64"},[r("table",{staticClass:"w-full"},[r("thead",[r("tr",[r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.__("Coupon Name")))]),e._v(" "),r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.customerCoupon.name))])]),e._v(" "),r("tr",[r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.__("Discount"))+" ("+e._s(e.getCouponType(e.customerCoupon.coupon.type))+")")]),e._v(" "),r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.getDiscountValue(e.customerCoupon.coupon)))])]),e._v(" "),r("tr",[r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.__("Usage")))]),e._v(" "),r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.customerCoupon.usage+"/"+(e.customerCoupon.limit_usage||e.__("Unlimited"))))])]),e._v(" "),r("tr",[r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.__("Valid From")))]),e._v(" "),r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.customerCoupon.coupon.valid_hours_start))])]),e._v(" "),r("tr",[r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.__("Valid Till")))]),e._v(" "),r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.customerCoupon.coupon.valid_hours_end))])]),e._v(" "),r("tr",[r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.__("Categories")))]),e._v(" "),r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[r("ul",e._l(e.customerCoupon.coupon.categories,(function(t){return r("li",{key:t.id,staticClass:"rounded-full px-3 py-1 border border-gray-200"},[e._v(e._s(t.category.name))])})),0)])]),e._v(" "),r("tr",[r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.__("Products")))]),e._v(" "),r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[r("ul",e._l(e.customerCoupon.coupon.products,(function(t){return r("li",{key:t.id,staticClass:"rounded-full px-3 py-1 border border-gray-200"},[e._v(e._s(t.product.name))])})),0)])])])])]):e._e()])]),e._v(" "),r("ns-tabs-item",{attrs:{label:e.__("Active Coupons"),padding:"p-1",identifier:"active-coupons"}},[e.order?r("ul",[e._l(e.order.coupons,(function(t,s){return r("li",{key:s,staticClass:"flex justify-between bg-gray-100 items-center px-2 py-1"},[r("div",{staticClass:"flex-auto"},[r("h3",{staticClass:"font-semibold text-gray-700 p-2 flex justify-between"},[r("span",[e._v(e._s(t.name))]),e._v(" "),r("span",[e._v(e._s(e.getDiscountValue(t)))])])]),e._v(" "),r("div",[r("ns-close-button",{on:{click:function(t){return e.removeCoupon(s)}}})],1)])})),e._v(" "),0===e.order.coupons.length?r("li",{staticClass:"flex justify-between bg-gray-100 items-center p-2"},[e._v("\n                        No coupons applies to the cart.\n                    ")]):e._e()],2):e._e()])],1)],1),e._v(" "),e.customerCoupon?r("div",{staticClass:"flex"},[r("button",{staticClass:"w-1/2 px-3 py-2 bg-green-400 text-white font-bold",on:{click:function(t){return e.apply()}}},[e._v("\n            "+e._s(e.__("Apply"))+"\n        ")]),e._v(" "),r("button",{staticClass:"w-1/2 px-3 py-2 bg-red-400 text-white font-bold",on:{click:function(t){return e.cancel()}}},[e._v("\n            "+e._s(e.__("Cancel"))+"\n        ")])]):e._e()])}),[],!1,null,null,null).exports;function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?re(Object(r),!0).forEach((function(t){ne(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ne(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ie(e,t,r,s,n,i,o){try{var a=e[i](o),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(s,n)}function oe(e){return function(){var t=this,r=arguments;return new Promise((function(s,n){var i=e.apply(t,r);function o(e){ie(i,s,n,o,a,"next",e)}function a(e){ie(i,s,n,o,a,"throw",e)}o(void 0)}))}}var ae={name:"ns-pos-cart",data:function(){return{popup:null,products:[],visibleSection:null,visibleSectionSubscriber:null,typeSubscribe:null,orderSubscribe:null,productSubscribe:null,types:[],order:{}}},computed:{selectedType:function(){return this.order.type?this.order.type.label:"N/A"},isVisible:function(){return"cart"===this.visibleSection},customerName:function(){return this.order.customer?this.order.customer.name:"N/A"},couponName:function(){return"Apply Coupon"}},mounted:function(){var e=this;this.typeSubscribe=POS.types.subscribe((function(t){return e.types=t})),this.orderSubscribe=POS.order.subscribe((function(t){e.order=t})),this.productSubscribe=POS.products.subscribe((function(t){e.products=t,e.$forceUpdate()})),this.visibleSectionSubscriber=POS.visibleSection.subscribe((function(t){e.visibleSection=t}))},destroyed:function(){this.visibleSectionSubscriber.unsubscribe(),this.typeSubscribe.unsubscribe(),this.orderSubscribe.unsubscribe(),this.productSubscribe.unsubscribe()},methods:{switchTo:R.a,selectCoupon:function(){return oe(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,t){i.a.show(te,{resolve:e,reject:t})}));case 3:e.sent,e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})))()},openNotePopup:function(){var e=this;return oe(n.a.mark((function t(){var r,s;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,r){var s=e.order.note,n=e.order.note_visibility;i.a.show(Y,{resolve:t,reject:r,note:s,note_visibility:n})}));case 3:r=t.sent,s=se(se({},e.order),r),POS.order.next(s),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),!1!==t.t0&&k.nsSnackBar.error(t.t0.message).subscribe();case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},selectTaxGroup:function(){var e=arguments,t=this;return oe(n.a.mark((function r(){var s,o,a;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=e.length>0&&void 0!==e[0]?e[0]:"settings",r.prev=1,r.next=4,new Promise((function(e,r){var n=t.order.taxes,o=t.order.tax_group_id,a=t.order.tax_type;i.a.show(K,{resolve:e,reject:r,taxes:n,tax_group_id:o,tax_type:a,activeTab:s})}));case 4:o=r.sent,a=se(se({},t.order),o),POS.order.next(a),POS.refreshCart(),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(1),console.log(r.t0);case 13:case"end":return r.stop()}}),r,null,[[1,10]])})))()},openTaxSummary:function(){this.selectTaxGroup("summary")},voidOngoingOrder:function(){POS.voidOrder(this.order)},holdOrder:function(){var e=this;return oe(n.a.mark((function t(){var r,s,o;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("hold"!==e.order.payment_status&&e.order.payments.length>0)){t.next=2;break}return t.abrupt("return",k.nsSnackBar.error("Unable to hold an order which payment status has been updated already.").subscribe());case 2:r=k.nsHooks.applyFilters("ns-hold-queue",[N,G,W]),t.t0=n.a.keys(r);case 4:if((t.t1=t.t0()).done){t.next=18;break}return s=t.t1.value,t.prev=6,o=new r[s](e.order),t.next=10,o.run();case 10:t.sent,t.next=16;break;case 13:return t.prev=13,t.t2=t.catch(6),t.abrupt("return",!1);case 16:t.next=4;break;case 18:k.nsHooks.applyFilters("ns-override-hold-popup",(function(){new Promise((function(t,r){i.a.show(Q,{resolve:t,reject:r,order:e.order})})).then((function(t){e.order.title=t.title,e.order.payment_status="hold",POS.order.next(e.order);var r=i.a.show(T);POS.submitOrder().then((function(e){r.close(),k.nsSnackBar.success(e.message).subscribe()}),(function(e){r.close(),k.nsSnackBar.error(e.message).subscribe()}))}))}))();case 20:case"end":return t.stop()}}),t,null,[[6,13]])})))()},openDiscountPopup:function(e,t){i.a.show(p,{reference:e,type:t,onSubmit:function(r){"product"===t?POS.updateProduct(e,r):"cart"===t&&POS.updateCart(e,r)}},{popupClass:"bg-white h:2/3 shadow-lg xl:w-1/4 lg:w-2/5 md:w-2/3 w-full"})},selectCustomer:function(){i.a.show(D.a)},toggleMode:function(e){"normal"===e.mode?i.a.show(b.default,{title:"Enable WholeSale Price",message:"Would you like to switch to wholesale price ?",onAction:function(t){t&&POS.updateProduct(e,{mode:"wholesale"})}}):i.a.show(b.default,{title:"Enable Normal Price",message:"Would you like to switch to normal price ?",onAction:function(t){t&&POS.updateProduct(e,{mode:"normal"})}})},remove:function(e){i.a.show(b.default,{title:"Confirm Your Action",message:"Would you like to delete this product ?",onAction:function(t){t&&POS.removeProduct(e)}})},changeQuantity:function(e){new I.a(e).run({unit_quantity_id:e.unit_quantity_id,unit_name:e.unit_name,$quantities:e.$quantities}).then((function(t){POS.updateProduct(e,t)}))},payOrder:function(){var e=this;return oe(n.a.mark((function t(){var r,s,i;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=[N,G,W,H],t.t0=n.a.keys(r);case 2:if((t.t1=t.t0()).done){t.next=16;break}return s=t.t1.value,t.prev=4,i=new r[s](e.order),t.next=8,i.run();case 8:t.sent,t.next=14;break;case 11:return t.prev=11,t.t2=t.catch(4),t.abrupt("return",!1);case 14:t.next=2;break;case 16:case"end":return t.stop()}}),t,null,[[4,11]])})))()},openOrderType:function(){i.a.show(B.default)},openShippingPopup:function(){i.a.show(q.default)}}},ce=Object(d.a)(ae,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"flex-auto flex flex-col",attrs:{id:"pos-cart"}},["cart"===e.visibleSection?r("div",{staticClass:"flex pl-2",attrs:{id:"tools"}},[r("div",{staticClass:"flex cursor-pointer rounded-tl-lg rounded-tr-lg px-3 py-2 bg-white font-semibold text-gray-700",on:{click:function(t){return e.switchTo("cart")}}},[r("span",[e._v("Cart")]),e._v(" "),e.order?r("span",{staticClass:"flex items-center justify-center text-sm rounded-full h-6 w-6 bg-green-500 text-white ml-1"},[e._v(e._s(e.order.products.length))]):e._e()]),e._v(" "),r("div",{staticClass:"cursor-pointer rounded-tl-lg rounded-tr-lg px-3 py-2 bg-gray-300 border-t border-r border-l border-gray-300 text-gray-600",on:{click:function(t){return e.switchTo("grid")}}},[e._v("\n            Products\n        ")])]):e._e(),e._v(" "),r("div",{staticClass:"rounded shadow bg-white flex-auto flex overflow-hidden"},[r("div",{staticClass:"cart-table flex flex-auto flex-col overflow-hidden"},[r("div",{staticClass:"w-full p-2 border-b border-gray-300"},[r("div",{staticClass:"border border-gray-300 rounded overflow-hidden"},[r("div",{staticClass:"flex flex-wrap"},[r("div",[r("button",{staticClass:"w-full h-10 px-3 bg-gray-200 border-r border-gray-300 outline-none",on:{click:function(t){return e.openNotePopup()}}},[r("i",{staticClass:"las la-comment"}),e._v(" "),r("span",{staticClass:"ml-1 hidden md:inline-block"},[e._v("Comments")])])]),e._v(" "),r("div",[r("button",{staticClass:"w-full h-10 px-3 bg-gray-200 border-r border-gray-300 outline-none flex items-center",on:{click:function(t){return e.selectTaxGroup()}}},[r("i",{staticClass:"las la-balance-scale-left"}),e._v(" "),r("span",{staticClass:"ml-1 hidden md:inline-block"},[e._v("Taxes")]),e._v(" "),e.order.taxes&&e.order.taxes.length>0?r("span",{staticClass:"ml-1 rounded-full flex items-center justify-center h-6 w-6 bg-blue-400 text-white"},[e._v(e._s(e.order.taxes.length))]):e._e()])]),e._v(" "),r("div",[r("button",{staticClass:"w-full h-10 px-3 bg-gray-200 border-r border-gray-300 outline-none flex items-center",on:{click:function(t){return e.selectCoupon()}}},[r("i",{staticClass:"las la-tags"}),e._v(" "),r("span",{staticClass:"ml-1 hidden md:inline-block"},[e._v("Coupons")]),e._v(" "),e.order.coupons&&e.order.coupons.length>0?r("span",{staticClass:"ml-1 rounded-full flex items-center justify-center h-6 w-6 bg-blue-400 text-white"},[e._v(e._s(e.order.coupons.length))]):e._e()])]),e._v(" "),e._m(0)])])]),e._v(" "),e._m(1),e._v(" "),r("div",{staticClass:"flex flex-auto flex-col overflow-auto"},[0===e.products.length?r("div",{staticClass:"text-gray-700 flex"},[e._m(2)]):e._e(),e._v(" "),e._l(e.products,(function(t,s){return r("div",{key:t.barcode,staticClass:"text-gray-700 flex",attrs:{"product-index":s}},[r("div",{staticClass:"w-full lg:w-4/6 p-2 border border-l-0 border-t-0 border-gray-200"},[r("div",{staticClass:"flex justify-between product-details mb-1"},[r("h3",{staticClass:"font-semibold"},[e._v("\n                                "+e._s(t.name)+" — "+e._s(t.unit_name)+"\n                            ")]),e._v(" "),r("div",{staticClass:"-mx-1 flex product-options"},[r("div",{staticClass:"px-1"},[r("a",{staticClass:"hover:text-red-400 cursor-pointer outline-none border-dashed py-1 border-b border-red-400 text-sm",on:{click:function(r){return e.remove(t)}}},[r("i",{staticClass:"las la-trash text-xl"})])]),e._v(" "),r("div",{staticClass:"px-1"},[r("a",{staticClass:"hover:text-blue-600 cursor-pointer outline-none border-dashed py-1 border-b  text-sm",class:"wholesale"===t.mode?"text-green-600 border-green-600":"border-blue-400",on:{click:function(r){return e.toggleMode(t)}}},[r("i",{staticClass:"las la-award text-xl"})])])])]),e._v(" "),r("div",{staticClass:"flex justify-between product-controls"},[r("div",{staticClass:"-mx-1 flex flex-wrap"},[r("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1"},[r("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b  text-sm",class:"wholesale"===t.mode?"text-green-600 hover:text-green-700 border-green-600":"hover:text-blue-400 border-blue-400"},[e._v("Price : "+e._s(e._f("currency")(t.unit_price)))])]),e._v(" "),r("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1"},[r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(r){return e.openDiscountPopup(t,"product")}}},[e._v("Discount "),"percentage"===t.discount_type?r("span",[e._v(e._s(t.discount_percentage)+"%")]):e._e(),e._v(" : "+e._s(e._f("currency")(t.discount)))])]),e._v(" "),r("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1 lg:hidden"},[r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(r){return e.changeQuantity(t)}}},[e._v("Quantity : "+e._s(t.quantity))])]),e._v(" "),r("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1 lg:hidden"},[r("span",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm"},[e._v("Total : "+e._s(e._f("currency")(t.total_price)))])])])])]),e._v(" "),r("div",{staticClass:"hidden lg:flex w-1/6 p-2 border-b border-gray-200 items-center justify-center cursor-pointer hover:bg-blue-100",on:{click:function(r){return e.changeQuantity(t)}}},[r("span",{staticClass:"border-b border-dashed border-blue-400 p-2"},[e._v(e._s(t.quantity))])]),e._v(" "),r("div",{staticClass:"hidden lg:flex w-1/6 p-2 border border-r-0 border-t-0 border-gray-200 items-center justify-center"},[e._v(e._s(e._f("currency")(t.total_price)))])])}))],2),e._v(" "),r("div",{staticClass:"flex"},["both"===e.visibleSection?r("table",{staticClass:"table w-full text-sm text-gray-700"},[r("tr",[r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.selectCustomer()}}},[e._v("Customer : "+e._s(e.customerName))])]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[e._v("Sub Total")]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2 text-right",attrs:{width:"200"}},[e._v(e._s(e._f("currency")(e.order.subtotal)))])]),e._v(" "),r("tr",[r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.openOrderType()}}},[e._v("Type : "+e._s(e.selectedType))])]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("span",[e._v("Discount")]),e._v(" "),"percentage"===e.order.discount_type?r("span",[e._v("("+e._s(e.order.discount_percentage)+"%)")]):e._e(),e._v(" "),"flat"===e.order.discount_type?r("span",[e._v("(Flat)")]):e._e()]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2 text-right",attrs:{width:"200"}},[r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.openDiscountPopup(e.order,"cart")}}},[e._v(e._s(e._f("currency")(e.order.discount)))])])]),e._v(" "),e.order.type&&"delivery"===e.order.type.identifier?r("tr",[r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}}),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.openShippingPopup()}}},[e._v("Shipping")])]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2 text-right",attrs:{width:"200"}},[e._v(e._s(e._f("currency")(e.order.shipping)))])]):e._e(),e._v(" "),r("tr",{staticClass:"bg-green-200"},[r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[e.order?r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.openTaxSummary()}}},[e._v("Tax : "+e._s(e._f("currency")(e.order.tax_value)))]):e._e()]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[e._v("Total")]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2 text-right",attrs:{width:"200"}},[e._v(e._s(e._f("currency")(e.order.total)))])])]):e._e(),e._v(" "),"cart"===e.visibleSection?r("table",{staticClass:"table w-full text-sm text-gray-700"},[r("tr",[r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.selectCustomer()}}},[e._v("Customer : "+e._s(e.customerName))])]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("div",{staticClass:"flex justify-between"},[r("span",[e._v("Sub Total")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.subtotal)))])])])]),e._v(" "),r("tr",[r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.openOrderType()}}},[e._v("Type : "+e._s(e.selectedType))])]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("div",{staticClass:"flex justify-between items-center"},[r("p",[r("span",[e._v("Discount")]),e._v(" "),"percentage"===e.order.discount_type?r("span",[e._v("("+e._s(e.order.discount_percentage)+"%)")]):e._e(),e._v(" "),"flat"===e.order.discount_type?r("span",[e._v("(Flat)")]):e._e()]),e._v(" "),r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.openDiscountPopup(e.order,"cart")}}},[e._v(e._s(e._f("currency")(e.order.discount)))])])])]),e._v(" "),e.order.type&&"delivery"===e.order.type.identifier?r("tr",[r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}}),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.openShippingPopup()}}},[e._v("Shipping")]),e._v(" "),r("span")])]):e._e(),e._v(" "),r("tr",{staticClass:"bg-green-200"},[r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[e.order?r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.openTaxSummary()}}},[e._v("Tax : "+e._s(e._f("currency")(e.order.tax_value)))]):e._e()]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("div",{staticClass:"flex justify-between w-full"},[r("span",[e._v("Total")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.total)))])])])])]):e._e()]),e._v(" "),r("div",{staticClass:"h-16 flex flex-shrink-0 border-t border-gray-200"},[r("div",{staticClass:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-green-500 text-white hover:bg-green-600 border-r border-green-600 flex-auto",attrs:{id:"pay-button"},on:{click:function(t){return e.payOrder()}}},[r("i",{staticClass:"mr-2 text-xl lg:text-3xl las la-cash-register"}),e._v(" "),r("span",{staticClass:"text-lg lg:text-2xl"},[e._v("Pay")])]),e._v(" "),r("div",{staticClass:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-blue-500 text-white border-r hover:bg-blue-600 border-blue-600 flex-auto",attrs:{id:"hold-button"},on:{click:function(t){return e.holdOrder()}}},[r("i",{staticClass:"mr-2 text-xl lg:text-3xl las la-pause"}),e._v(" "),r("span",{staticClass:"text-lg lg:text-2xl"},[e._v("Hold")])]),e._v(" "),r("div",{staticClass:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-white border-r border-gray-200 hover:bg-indigo-100 flex-auto text-gray-700",attrs:{id:"discount-button"},on:{click:function(t){return e.openDiscountPopup(e.order,"cart")}}},[r("i",{staticClass:"mr-2 text-xl lg:text-3xl las la-percent"}),e._v(" "),r("span",{staticClass:"text-lg lg:text-2xl"},[e._v("Discount")])]),e._v(" "),r("div",{staticClass:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-red-500 text-white border-gray-200 hover:bg-red-600 flex-auto",attrs:{id:"void-button"},on:{click:function(t){return e.voidOngoingOrder(e.order)}}},[r("i",{staticClass:"mr-2 text-xl lg:text-3xl las la-trash"}),e._v(" "),r("span",{staticClass:"text-lg lg:text-2xl"},[e._v("Void")])])])])])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"flex-auto"},[t("button",{staticClass:"w-full h-10 px-3 bg-gray-200 border-r border-gray-300 outline-none flex items-center",attrs:{disabled:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"w-full text-gray-700 font-semibold flex"},[t("div",{staticClass:"w-full lg:w-4/6 p-2 border border-l-0 border-t-0 border-gray-200 bg-gray-100"},[this._v("Product")]),this._v(" "),t("div",{staticClass:"hidden lg:flex lg:w-1/6 p-2 border-b border-t-0 border-gray-200 bg-gray-100"},[this._v("Quantity")]),this._v(" "),t("div",{staticClass:"hidden lg:flex lg:w-1/6 p-2 border border-r-0 border-t-0 border-gray-200 bg-gray-100"},[this._v("Total")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"w-full text-center py-4 border-b border-gray-200"},[t("h3",{staticClass:"text-gray-600"},[this._v("No products added...")])])}],!1,null,null,null);t.default=ce.exports},207:function(e,t,r){"use strict";r.r(t);var s=r(0),n=r(67),i={name:"ns-pos-search-product",data:function(){return{searchValue:"",products:[],isLoading:!1}},mounted:function(){this.$refs.searchField.focus(),this.popupCloser()},methods:{popupCloser:r(13).a,addToCart:function(e){POS.addToCart(e),this.$popup.close()},search:function(){var e=this;this.isLoading=!0,s.nsHttpClient.post("/api/nexopos/v4/products/search",{search:this.searchValue}).subscribe((function(t){e.isLoading=!1,e.products=t,1===e.products.length&&e.addToCart(e.products[0])}),(function(t){e.isLoading=!1,s.nsSnackBar.error(t.message).subscribe()}))}}},o=r(1),a=Object(o.a)(i,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"bg-white shadow-lg w-95vw h-95vh md:h-3/5-screen md:w-2/4-screen flex flex-col overflow-hidden"},[r("div",{staticClass:"p-2 border-b border-gray-300 flex justify-between items-center"},[r("h3",{staticClass:"text-gray-700"},[e._v("Search Product")]),e._v(" "),r("div",[r("ns-close-button",{on:{click:function(t){return e.$popup.close()}}})],1)]),e._v(" "),r("div",{staticClass:"flex-auto overflow-hidden flex flex-col"},[r("div",{staticClass:"p-2 border-b border-gray-300"},[r("div",{staticClass:"flex border-blue-400 border-2 rounded overflow-hidden"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.searchValue,expression:"searchValue"}],ref:"searchField",staticClass:"p-2  outline-none flex-auto text-gray-700 bg-blue-100",attrs:{type:"text"},domProps:{value:e.searchValue},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search()},input:function(t){t.target.composing||(e.searchValue=t.target.value)}}}),e._v(" "),r("button",{staticClass:"px-2 bg-blue-400 text-white",on:{click:function(t){return e.search()}}},[e._v("Search")])])]),e._v(" "),r("div",{staticClass:"overflow-y-auto flex-auto relative"},[r("ul",[e._l(e.products,(function(t){return r("li",{key:t.id,staticClass:"hover:bg-blue-100 cursor-pointer p-2 flex justify-between border-b",on:{click:function(r){return e.addToCart(t)}}},[r("div",{staticClass:"text-gray-700"},[e._v("\n                        "+e._s(t.name)+"\n                    ")]),e._v(" "),r("div")])})),e._v(" "),0===e.products.length?r("li",{staticClass:"text-gray-700 text-center p-2"},[e._v("There is nothing to display. Have you started the search ?")]):e._e()],2),e._v(" "),e.isLoading?r("div",{staticClass:"absolute h-full w-full flex items-center justify-center z-10 top-0",staticStyle:{background:"rgb(187 203 214 / 29%)"}},[r("ns-spinner")],1):e._e()])])])}),[],!1,null,null,null).exports,c={name:"ns-pos-grid",data:function(){return{items:Array.from({length:1e3},(function(e,t){return{data:"#"+t}})),products:[],categories:[],breadcrumbs:[],autoFocus:!1,barcode:"",previousCategory:null,order:null,visibleSection:null,breadcrumbsSubsribe:null,orderSubscription:null,visibleSectionSubscriber:null,currentCategory:null,interval:null,searchTimeout:null,gridItemsWidth:0,gridItemsHeight:0,screenSubscriber:null,rebuildGridTimeout:null,rebuildGridComplete:!1}},computed:{hasCategories:function(){return this.categories.length>0}},watch:{barcode:function(){var e=this;clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((function(){e.submitSearch(e.barcode)}),200)}},mounted:function(){var e=this;this.loadCategories(),this.breadcrumbsSubsribe=POS.breadcrumbs.subscribe((function(t){e.breadcrumbs=t})),this.visibleSectionSubscriber=POS.visibleSection.subscribe((function(t){e.visibleSection=t})),this.screenSubscriber=POS.screen.subscribe((function(t){clearTimeout(e.rebuildGridTimeout),e.rebuildGridComplete=!1,e.rebuildGridTimeout=setTimeout((function(){e.rebuildGridComplete=!0,e.computeGridWidth()}),500)})),this.orderSubscription=POS.order.subscribe((function(t){return e.order=t})),this.interval=setInterval((function(){return e.checkFocus()}),500)},destroyed:function(){this.orderSubscription.unsubscribe(),this.breadcrumbsSubsribe.unsubscribe(),this.visibleSectionSubscriber.unsubscribe(),this.this.screenSubscriber.unsubscribe(),clearInterval(this.interval)},methods:{switchTo:n.a,computeGridWidth:function(){this.gridItemsWidth=document.getElementById("grid-items").offsetWidth,this.gridItemsHeight=document.getElementById("grid-items").offsetHeight},cellSizeAndPositionGetter:function(e,t){var r={xs:{width:this.gridItemsWidth/2,items:2,height:200},sm:{width:this.gridItemsWidth/2,items:2,height:200},md:{width:this.gridItemsWidth/3,items:3,height:150},lg:{width:this.gridItemsWidth/4,items:4,height:150},xl:{width:this.gridItemsWidth/6,items:6,height:150}},s=r[POS.responsive.screenIs].width,n=r[POS.responsive.screenIs].height;return{width:s-0,height:n,x:t%r[POS.responsive.screenIs].items*s-0,y:parseInt(t/r[POS.responsive.screenIs].items)*n}},openSearchPopup:function(){Popup.show(a)},submitSearch:function(e){var t=this;e.length>0&&s.nsHttpClient.get("/api/nexopos/v4/products/search/using-barcode/".concat(e)).subscribe((function(e){t.barcode="",POS.addToCart(e.product)}),(function(e){t.barcode="",s.nsSnackBar.error(e.message).subscribe()}))},checkFocus:function(){this.autoFocus&&(0===document.querySelectorAll(".is-popup").length&&this.$refs.search.focus())},loadCategories:function(e){var t=this;s.nsHttpClient.get("/api/nexopos/v4/categories/pos/".concat(e?e.id:"")).subscribe((function(e){t.categories=e.categories.map((function(e){return{data:e}})),t.products=e.products.map((function(e){return{data:e}})),t.previousCategory=e.previousCategory,t.currentCategory=e.currentCategory,t.updateBreadCrumb(t.currentCategory)}))},updateBreadCrumb:function(e){if(console.log(e),e){var t=this.breadcrumb.filter((function(t){return t.id===e.id}));if(t.length>0){var r=!0,s=this.breadcrumb.filter((function(e){return e.id===t[0].id&&r?(r=!1,!0):r}));this.breadcrumb=s}else this.breadcrumb.push(e)}else this.breadcrumb=[];POS.breadcrumbs.next(this.breadcrumb)},addToTheCart:function(e){POS.addToCart(e)}}},l=Object(o.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"flex-auto flex flex-col",attrs:{id:"pos-grid"}},["grid"===e.visibleSection?r("div",{staticClass:"flex pl-2",attrs:{id:"tools"}},[r("div",{staticClass:"flex cursor-pointer rounded-tl-lg rounded-tr-lg px-3 py-2 bg-gray-300 border-t border-r border-l border-gray-300 text-gray-600",on:{click:function(t){return e.switchTo("cart")}}},[r("span",[e._v("Cart")]),e._v(" "),e.order?r("span",{staticClass:"flex items-center justify-center text-sm rounded-full h-6 w-6 bg-green-500 text-white ml-1"},[e._v(e._s(e.order.products.length))]):e._e()]),e._v(" "),r("div",{staticClass:"cursor-pointer rounded-tl-lg rounded-tr-lg px-3 py-2 bg-white font-semibold text-gray-700",on:{click:function(t){return e.switchTo("grid")}}},[e._v("\n            Products\n        ")])]):e._e(),e._v(" "),r("div",{staticClass:"rounded shadow bg-white overflow-hidden flex-auto flex flex-col"},[r("div",{staticClass:"p-2 border-b border-gray-200",attrs:{id:"grid-header"}},[r("div",{staticClass:"border rounded flex border-gray-300 overflow-hidden"},[r("button",{staticClass:"w-10 h-10 bg-gray-200 border-r border-gray-300 outline-none",on:{click:function(t){return e.openSearchPopup()}}},[r("i",{staticClass:"las la-search"})]),e._v(" "),r("button",{staticClass:"outline-none w-10 h-10 border-r border-gray-300",class:e.autoFocus?"pos-button-clicked bg-gray-300":"bg-gray-200",on:{click:function(t){e.autoFocus=!e.autoFocus}}},[r("i",{staticClass:"las la-barcode"})]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.barcode,expression:"barcode"}],ref:"search",staticClass:"flex-auto outline-none px-2 bg-gray-100",attrs:{type:"text"},domProps:{value:e.barcode},on:{input:function(t){t.target.composing||(e.barcode=t.target.value)}}})])]),e._v(" "),r("div",{staticClass:"p-2 border-gray-200",attrs:{id:"grid-breadscrumb"}},[r("ul",{staticClass:"flex"},[r("li",[r("a",{staticClass:"px-3 text-gray-700",attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.loadCategories()}}},[e._v("Home ")]),e._v(" "),r("i",{staticClass:"las la-angle-right"})]),e._v(" "),r("li",e._l(e.breadcrumbs,(function(t){return r("a",{key:t.id,staticClass:"px-3 text-gray-700",attrs:{href:"javascript:void(0)"},on:{click:function(r){return e.loadCategories(t)}}},[e._v(e._s(t.name)+" "),r("i",{staticClass:"las la-angle-right"})])})),0)])]),e._v(" "),r("div",{staticClass:"overflow-hidden h-full flex-col flex",attrs:{id:"grid-items"}},[e.rebuildGridComplete?e._e():r("div",{staticClass:"h-full w-full flex-col flex items-center justify-center"},[r("ns-spinner"),e._v(" "),r("span",{staticClass:"text-gray-600 my-2"},[e._v("Rebuilding...")])],1),e._v(" "),e.rebuildGridComplete?[e.hasCategories?r("VirtualCollection",{attrs:{cellSizeAndPositionGetter:e.cellSizeAndPositionGetter,collection:e.categories,height:e.gridItemsHeight,width:e.gridItemsWidth},scopedSlots:e._u([{key:"cell",fn:function(t){var s=t.data;return r("div",{staticClass:"w-full h-full"},[r("div",{key:s.id,staticClass:"hover:bg-gray-200 w-full h-full cursor-pointer border border-gray-200 flex flex-col items-center justify-center overflow-hidden",on:{click:function(t){return e.loadCategories(s)}}},[r("div",{staticClass:"h-full w-full flex items-center justify-center"},[s.preview_url?r("img",{staticClass:"object-cover h-full",attrs:{src:s.preview_url,alt:s.name}}):e._e(),e._v(" "),s.preview_url?e._e():r("i",{staticClass:"las la-image text-gray-600 text-6xl"})]),e._v(" "),r("div",{staticClass:"h-0 w-full"},[r("div",{staticClass:"relative w-full flex items-center justify-center -top-10 h-20 py-2",staticStyle:{background:"rgb(255 255 255 / 73%)"}},[r("h3",{staticClass:"text-sm font-bold text-gray-700 py-2 text-center"},[e._v(e._s(s.name))])])])])])}}],null,!1,1415940505)}):e._e(),e._v(" "),e.hasCategories?e._e():r("VirtualCollection",{attrs:{cellSizeAndPositionGetter:e.cellSizeAndPositionGetter,collection:e.products,height:e.gridItemsHeight,width:e.gridItemsWidth},scopedSlots:e._u([{key:"cell",fn:function(t){var s=t.data;return r("div",{staticClass:"w-full h-full"},[r("div",{key:s.id,staticClass:"hover:bg-gray-200 w-full h-full cursor-pointer border border-gray-200 flex flex-col items-center justify-center overflow-hidden",on:{click:function(t){return e.addToTheCart(s)}}},[r("div",{staticClass:"h-full w-full flex items-center justify-center overflow-hidden"},[s.galleries&&s.galleries.filter((function(e){return 1===e.featured})).length>0?r("img",{staticClass:"object-cover h-full",attrs:{src:s.galleries.filter((function(e){return 1===e.featured}))[0].url,alt:s.name}}):e._e(),e._v(" "),s.galleries&&0!==s.galleries.filter((function(e){return 1===e.featured})).length?e._e():r("i",{staticClass:"las la-image text-gray-600 text-6xl"})]),e._v(" "),r("div",{staticClass:"h-0 w-full"},[r("div",{staticClass:"relative w-full flex flex-col items-start justify-center -top-10 h-20 p-2",staticStyle:{background:"rgb(255 255 255 / 73%)"}},[r("h3",{staticClass:"text-sm text-gray-700 text-center w-full"},[e._v(e._s(s.name))])])])])])}}],null,!1,2924703687)})]:e._e()],2)])])}),[],!1,null,null,null);t.default=l.exports},263:function(e,t,r){e.exports=r(264)},264:function(e,t,r){"use strict";r.r(t);var s=r(3),n=r.n(s),i=(r(223),r(31)),o=r(231),a=r.n(o);const c=r(280).default,l=r(206).default,u=r(207).default;window.nsComponents=Object.assign({},i),n.a.use(a.a),new n.a({el:"#pos-app",components:Object.assign({NsPos:c,NsPosCart:l,NsPosGrid:u},window.nsComponents)})},280:function(e,t,r){"use strict";r.r(t);var s=r(206),n=r(207),i={name:"ns-pos",computed:{buttons:function(){return POS.header.buttons}},mounted:function(){var e=this;this.visibleSectionSubscriber=POS.visibleSection.subscribe((function(t){e.visibleSection=t}))},destroyed:function(){this.visibleSectionSubscriber.unsubscribe()},data:function(){return{visibleSection:null,visibleSectionSubscriber:null}},components:{NsPosCart:s.default,NsPosGrid:n.default}},o=r(1),a=Object(o.a)(i,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"h-full flex-auto bg-gray-300 flex flex-col",attrs:{id:"pos-container"}},[r("div",{staticClass:"flex overflow-hidden flex-shrink-0 px-2 pt-2"},[r("div",{staticClass:"-mx-2 flex overflow-x-auto pb-1"},e._l(e.buttons,(function(e,t){return r("div",{key:t,staticClass:"flex px-2 flex-shrink-0"},[r(e,{tag:"component"})],1)})),0)]),e._v(" "),r("div",{staticClass:"flex-auto overflow-hidden flex p-2"},[r("div",{staticClass:"flex flex-auto overflow-hidden -m-2"},[["both","cart"].includes(e.visibleSection)?r("div",{staticClass:"flex overflow-hidden p-2",class:"both"===e.visibleSection?"w-1/2":"w-full"},[r("ns-pos-cart")],1):e._e(),e._v(" "),["both","grid"].includes(e.visibleSection)?r("div",{staticClass:"p-2 flex overflow-hidden",class:"both"===e.visibleSection?"w-1/2":"w-full"},[r("ns-pos-grid")],1):e._e()])])])}),[],!1,null,null,null);t.default=a.exports},67:function(e,t,r){"use strict";t.a=function(e){POS.changeVisibleSection(e)}}},[[263,0,1]]]);
//# sourceMappingURL=pos.js.map