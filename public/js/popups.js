(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{264:function(t,e,s){t.exports=s(266)},266:function(t,e,s){"use strict";s.r(e);var r=s(0),i=s(58),n=s(220),a=s(7),o=s(13);function l(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function c(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?l(Object(s),!0).forEach((function(e){u(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function u(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var d={mounted:function(){this.popuCloser(),this.loadFields(),this.product=this.$popupParams.product},data:function(){return{formValidation:new a.a,fields:[],product:null}},methods:{popuCloser:o.a,close:function(){this.$popupParams.reject(!1),this.$popup.close()},addProduct:function(){if(this.formValidation.validateFields(this.fields),this.formValidation.fieldsValid(this.fields)){var t=this.formValidation.extractFields(this.fields),e=c(c({},this.product),t);return this.$popupParams.resolve(e),console.log(t,e),this.close()}r.nsSnackBar.error("The form is not valid.").subscribe()},loadFields:function(){var t=this;r.nsHttpClient.get("/api/nexopos/v4/fields/ns.refund-product").subscribe((function(e){console.log(t.product),t.fields=t.formValidation.createFields(e),t.fields.forEach((function(e){e.value=t.product[e.name]||""}))}))}}},p=s(2),f=Object(p.a)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shadow-xl bg-white w-95vw md:w-3/5-screen lg:w-3/7-screen h-95vh md:h-3/5-screen lg:h-3/7-screen overflow-hidden flex flex-col"},[s("div",{staticClass:"p-2 flex justify-between border-b border-gray-200 items-center"},[s("h3",{staticClass:"text-semibold"},[t._v("Products")]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),s("div",{staticClass:"flex-auto overflow-y-auto relative"},[s("div",{staticClass:"p-2"},t._l(t.fields,(function(t,e){return s("ns-field",{key:e,attrs:{field:t}})})),1),t._v(" "),0===t.fields.length?s("div",{staticClass:"h-full w-full flex items-center justify-center"},[s("ns-spinner")],1):t._e()]),t._v(" "),s("div",{staticClass:"p-2 flex justify-between items-center border-t border-gray-200"},[s("div"),t._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.addProduct()}}},[t._v("Add Product")])],1)])])}),[],!1,null,null,null).exports,v=s(29),b=s(36),m={components:{nsNumpad:b.a},data:function(){return{product:null,seeValue:0,availableQuantity:0}},mounted:function(){this.product=this.$popupParams.product,this.availableQuantity=this.$popupParams.availableQuantity,this.seeValue=this.product.quantity},methods:{popupResolver:v.a,close:function(){this.$popupParams.reject(!1),this.$popup.close()},setChangedValue:function(t){this.seeValue=t},updateQuantity:function(t){if(t>this.availableQuantity)return r.nsSnackBar.error("Unable to proceed as the quantity provided is exceed the available quantity.").subscribe();this.product.quantity=parseFloat(t),this.$popupParams.resolve(this.product),this.$popup.close()}}},_=Object(p.a)(m,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shadow-xl bg-white overflow-hidden w-95vw md:w-4/6-screen lg:w-3/7-screen"},[s("div",{staticClass:"p-2 flex justify-between"},[s("h3",{staticClass:"font-semibold"},[t._v("Quantity")]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),t.product?s("div",{staticClass:"border-t border-b border-gray-200 py-2 flex items-center justify-center text-2xl font-semibold"},[s("span",[t._v(t._s(t.seeValue))]),t._v(" "),s("span",{staticClass:"text-gray-600 text-sm"},[t._v("("+t._s(t.availableQuantity)+" available)")])]):t._e(),t._v(" "),t.product?s("div",{staticClass:"flex-auto overflow-y-auto p-2"},[s("ns-numpad",{attrs:{value:t.product.quantity},on:{next:function(e){return t.updateQuantity(e)},changed:function(e){return t.setChangedValue(e)}}})],1):t._e()])}),[],!1,null,null,null).exports,h=(s(203),{data:function(){return{value:[],options:[],label:null,type:"select"}},computed:{},mounted:function(){this.popupCloser(),this.value=this.$popupParams.value||[],this.options=this.$popupParams.options,this.label=this.$popupParams.label,this.type=this.$popupParams.type||this.type,console.log(this.$popupParams)},methods:{popupCloser:o.a,toggle:function(t){var e=this.value.indexOf(t);-1===e?this.value.unshift(t):this.value.splice(e,1)},isSelected:function(t){return this.value.indexOf(t)>=0},close:function(){this.$popupParams.reject(!1),this.$popup.close()},select:function(t){void 0!==t&&(this.value=[t]),this.$popupParams.resolve(this.value),this.close()}}}),y=Object(p.a)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shadow-xl bg-white w-6/7-screen md:w-4/7-screen lg:w-3/7-screen overflow-hidden"},[s("div",{staticClass:"p-2 flex justify-between border-b border-gray-200"},[s("span",{staticClass:"text-semibold text-gray-700"},[t._v("\n            "+t._s(t.label)+"\n        ")]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),s("div",{staticClass:"flex-auto overflow-y-auto"},[s("ul",["select"===t.type?t._l(t.options,(function(e){return s("li",{key:e.value,staticClass:"p-2 border-b border-gray-200 text-gray-700 cursor-pointer hover:bg-gray-100",on:{click:function(s){return t.select(e)}}},[t._v(t._s(e.label))])})):t._e(),t._v(" "),"multiselect"===t.type?t._l(t.options,(function(e){return s("li",{key:e.value,staticClass:"p-2 border-b text-gray-700 cursor-pointer hover:bg-gray-100",class:t.isSelected(e)?"bg-blue-100 border-blue-200":"border-gray-200",on:{click:function(s){return t.toggle(e)}}},[t._v(t._s(e.label))])})):t._e()],2)]),t._v(" "),"multiselect"===t.type?s("div",{staticClass:"flex justify-between"},[s("div"),t._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.select()}}},[t._v("Select")])],1)]):t._e()])}),[],!1,null,null,null).exports,g=s(10);function x(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function w(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?x(Object(s),!0).forEach((function(e){C(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):x(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function C(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var P={components:{nsNumpad:b.a},props:["order"],computed:{screenValue:function(){var t=parseInt(1+new Array(parseInt(ns.currency.ns_currency_precision)).fill("").map((function(t){return 0})).join(""));return this.screen/t},total:function(){return this.refundables.length>0?this.refundables.map((function(t){return parseFloat(t.unit_price)*parseFloat(t.quantity)})).reduce((function(t,e){return t+e})):0}},data:function(){return{isSubmitting:!1,formValidation:new a.a,refundables:[],paymentOptions:[],paymentField:[],selectedPaymentGateway:!1,screen:0,selectFields:[{type:"select",options:this.order.products.map((function(t){return{label:"".concat(t.name," - ").concat(t.unit.name," (x").concat(t.quantity,")"),value:t.id}})),validation:"required",name:"product_id",label:"Product",description:"Select the product to perform a refund."}]}},methods:{updateScreen:function(t){this.screen=t},proceedPayment:function(){var t=this;if(!1===this.selectedPaymentGateway)return r.nsSnackBar.error("Please select a payment gateway before proceeding.").subscribe();if(0===this.refundables.length)return r.nsSnackBar.error("Please add at list a product for a refund.").subscribe();if(0===this.screenValue)return r.nsSnackBar.error("Please provide a valid payment amount.").subscribe();var e={products:this.refundables,total:this.screenValue,payment:this.selectedPaymentGateway};this.isSubmitting=!0,r.nsHttpClient.post("/api/nexopos/v4/orders/".concat(this.order.id,"/refund"),e).subscribe((function(e){t.isSubmitting=!1,r.nsSnackBar.success(error.message).subscribe()}),(function(t){r.nsSnackBar.error(t.message).subscribe()}))},addProduct:function(){var t=this;if(this.formValidation.validateFields(this.selectFields),!this.formValidation.fieldsValid(this.selectFields))return r.nsSnackBar.error("Please select a product before proceeding.").subscribe();var e=this.formValidation.extractFields(this.selectFields),s=this.order.products.filter((function(t){return t.id===e.product_id})),i=this.refundables.filter((function(t){return t.id===e.product_id}));if(i.length>0&&i.map((function(t){return parseInt(t.quantity)})).reduce((function(t,e){return t+e}))===s[0].quantity)return r.nsSnackBar.error("Not enough quantity to proceed.").subscribe();if(0===s[0].quantity)return r.nsSnackBar.error("Not enough quantity to proceed.").subscribe();var n=w(w({},s[0]),{condition:"",description:""});new Promise((function(t,e){Popup.show(f,{resolve:t,reject:e,product:n})})).then((function(e){e.quantity=t.getProductOriginalQuantity(e.id)-t.getProductUsedQuantity(e.id),t.refundables.push(e)}),(function(t){return t}))},getProductOriginalQuantity:function(t){var e=this.order.products.filter((function(e){return e.id===t}));return e.length>0?e.map((function(t){return parseFloat(t.quantity)})).reduce((function(t,e){return t+e})):0},getProductUsedQuantity:function(t){var e=this.refundables.filter((function(e){return e.id===t}));return e.length>0?e.map((function(t){return parseFloat(t.quantity)})).reduce((function(t,e){return t+e})):0},openSettings:function(t){var e=this;new Promise((function(e,s){Popup.show(f,{resolve:e,reject:s,product:t})})).then((function(s){var r=e.refundables.indexOf(t);e.$set(e.refundables,r,s)}),(function(t){return t}))},selectPaymentGateway:function(){var t=this;new Promise((function(e,s){Popup.show(y,w({resolve:e,reject:s,value:[t.selectedPaymentOption]},t.paymentField[0]))})).then((function(e){t.selectedPaymentGateway=e[0]}),(function(t){return t}))},changeQuantity:function(t){var e=this;new Promise((function(s,r){var i=e.getProductOriginalQuantity(t.id)-e.getProductUsedQuantity(t.id)+parseFloat(t.quantity);Popup.show(_,{resolve:s,reject:r,product:t,availableQuantity:i})})).then((function(s){if(s.quantity>e.getProductUsedQuantity(t.id)-t.quantity){var r=e.refundables.indexOf(t);e.$set(e.refundables,r,s)}}))},deleteProduct:function(t){var e=this;new Promise((function(s,r){Popup.show(g.default,{title:"Confirm Your Action",message:"Would you like to delete this product ?",onAction:function(s){if(s){var r=e.refundables.indexOf(t);e.refundables.splice(r,1)}}})}))}},mounted:function(){var t=this;this.selectFields=this.formValidation.createFields(this.selectFields),r.nsHttpClient.get("/api/nexopos/v4/orders/payments").subscribe((function(e){t.paymentField=e}))}},j=Object(p.a)(P,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"-m-4 flex-auto flex flex-wrap relative"},[t.isSubmitting?s("div",{staticClass:"bg-overlay h-full w-full flex items-center justify-center absolute z-30"},[s("ns-spinner")],1):t._e(),t._v(" "),s("div",{staticClass:"px-4 w-full lg:w-1/2"},[s("h3",{staticClass:"py-2 border-b-2 text-gray-700 border-blue-400"},[t._v("Refund With Products")]),t._v(" "),s("div",{staticClass:"my-2"},[s("ul",[s("li",{staticClass:"border-b border-blue-400 flex justify-between items-center mb-2"},[s("div",{staticClass:"flex-auto flex-col flex"},[s("div",{staticClass:"p-2 flex"},t._l(t.selectFields,(function(t,e){return s("ns-field",{key:e,attrs:{field:t}})})),1),t._v(" "),s("div",{staticClass:"flex justify-end p-2"},[s("button",{staticClass:"border-2 rounded-full border-gray-200 px-2 py-1 hover:bg-blue-400 hover:text-white text-gray-700",on:{click:function(e){return t.addProduct()}}},[t._v("Add Product")])])])]),t._v(" "),t._m(0),t._v(" "),t._l(t.refundables,(function(e){return s("li",{key:e.id,staticClass:"bg-gray-100 border-b border-blue-400 flex justify-between items-center mb-2"},[s("div",{staticClass:"px-2 text-gray-700 flex justify-between flex-auto"},[s("div",{staticClass:"flex flex-col"},[s("p",{staticClass:"py-2"},[s("span",[t._v(t._s(e.name))]),t._v(" "),"damaged"===e.condition?s("span",{staticClass:"rounded-full px-2 py-1 text-xs bg-red-400 mx-2 text-white"},[t._v("Damaged")]):t._e(),t._v(" "),"unspoiled"===e.condition?s("span",{staticClass:"rounded-full px-2 py-1 text-xs bg-green-400 mx-2 text-white"},[t._v("Unspoiled")]):t._e()]),t._v(" "),s("small",[t._v(t._s(e.unit.name))])]),t._v(" "),s("div",{staticClass:"flex items-center justify-center"},[s("span",{staticClass:"py-1 flex items-center cursor-pointer border-b border-dashed border-blue-400"},[t._v(t._s(t._f("currency")(e.unit_price*e.quantity)))])])]),t._v(" "),s("div",{staticClass:"flex"},[s("p",{staticClass:"p-2 border-l border-blue-400 cursor-pointer text-gray-600 hover:bg-blue-100 w-16 h-16 flex items-center justify-center",on:{click:function(s){return t.openSettings(e)}}},[s("i",{staticClass:"las la-cog text-xl"})]),t._v(" "),s("p",{staticClass:"p-2 border-l border-blue-400 cursor-pointer text-gray-600 hover:bg-blue-100 w-16 h-16 flex items-center justify-center",on:{click:function(s){return t.deleteProduct(e)}}},[s("i",{staticClass:"las la-trash"})]),t._v(" "),s("p",{staticClass:"p-2 border-l border-blue-400 cursor-pointer text-gray-600 hover:bg-blue-100 w-16 h-16 flex items-center justify-center",on:{click:function(s){return t.changeQuantity(e)}}},[t._v(t._s(e.quantity))])])])}))],2)])]),t._v(" "),s("div",{staticClass:"px-4 w-full lg:w-1/2"},[s("h3",{staticClass:"py-2 border-b-2 text-gray-700 border-blue-400"},[t._v("Summary")]),t._v(" "),s("div",{staticClass:"py-2"},[s("div",{staticClass:"bg-blue-400 text-white font-semibold flex mb-2 p-2 justify-between"},[s("span",[t._v("Total")]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.total)))])]),t._v(" "),s("div",{staticClass:"bg-teal-400 text-white font-semibold flex mb-2 p-2 justify-between"},[s("span",[t._v("Paid")]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.tendered)))])]),t._v(" "),s("div",{staticClass:"bg-indigo-400 text-white font-semibold flex mb-2 p-2 justify-between cursor-pointer",on:{click:function(e){return t.selectPaymentGateway()}}},[s("span",[t._v("Payment Gateway")]),t._v(" "),s("span",[t._v(t._s(t.selectedPaymentGateway?t.selectedPaymentGateway.label:"N/A"))])]),t._v(" "),s("div",{staticClass:"bg-gray-300 text-gray-900 font-semibold flex mb-2 p-2 justify-between"},[s("span",[t._v("Screen")]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.screenValue)))])]),t._v(" "),s("div",[s("ns-numpad",{attrs:{currency:!0,value:t.screen},on:{changed:function(e){return t.updateScreen(e)},next:function(e){return t.proceedPayment(e)}}})],1)])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("h4",{staticClass:"py-1 border-b-2 text-gray-700 border-blue-400"},[this._v("Products")])])}],!1,null,null,null).exports,O=s(32),$=function(){function t(){}return t.prototype.getTypeLabel=function(t){switch(t){case"delivery":return"Delivery";case"takeaway":return"Take Away";default:return"Unknown Type"}},t.prototype.getDeliveryStatus=function(t){switch(t){case"pending":return"Pending";case"ongoing":return"Ongoing";case"delivered":return"Delivered";case"failed":return"Delivery Failure";default:return"Unknown Status"}},t.prototype.getProcessingStatus=function(t){switch(t){case"pending":return"Pending";case"ongoing":return"Ongoing";case"done":return"Done";case"failed":return"Failure";default:return"Unknown Status"}},t.prototype.getPaymentStatus=function(t){switch(t){case"paid":return"Paid";case"hold":return"Hold";case"unpaid":return"Unpaid";case"partially_paid":return"Partially Paid";default:return"Unknown Status"}},t}();function k(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function S(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?k(Object(s),!0).forEach((function(e){F(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):k(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function F(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var V={props:["order"],data:function(){return{labels:new $,validation:new a.a,inputValue:0,fields:[]}},methods:{updateValue:function(t){this.inputValue=t},loadPaymentFields:function(){var t=this;r.nsHttpClient.get("/api/nexopos/v4/orders/payments").subscribe((function(e){t.fields=t.validation.createFields(e)}))},submitPayment:function(t){var e=this;if(this.validation.validateFields(this.fields),!this.validation.fieldsValid(this.fields))return r.nsSnackBar.error("Unable to proceed the form is not valid").subscribe();if(0==parseFloat(t))return r.nsSnackBar.error("Please provide a valid value").subscribe();t=parseFloat(t);var s=S(S({},this.validation.extractFields(this.fields)),{},{value:t});Popup.show(g.default,{title:"Confirm Your Action",message:"You make a payment for {amount}. A payment can't be canceled. Would you like to proceed ?".replace("{amount}",this.$options.filters.currency(t)),onAction:function(t){t&&r.nsHttpClient.post("/api/nexopos/v4/orders/".concat(e.order.id,"/payments"),s).subscribe((function(t){r.nsSnackBar.success(t.message).subscribe(),e.$emit("changed")}),(function(t){r.nsSnackBar.error(t.message).subscribe()}))}})}},components:{nsNumpad:b.a},mounted:function(){this.loadPaymentFields()}},E=Object(p.a)(V,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{},[s("div",{staticClass:"flex -mx-4 flex-wrap"},[s("div",{staticClass:"px-2 w-full md:w-1/2"},[s("div",{staticClass:"my-1 h-12 py-1 px-2 flex justify-between items-center bg-blue-400 text-white text-xl font-bold"},[s("span",[t._v("Total")]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.total)))])])]),t._v(" "),s("div",{staticClass:"px-2 w-full md:w-1/2"},[s("div",{staticClass:"my-1 h-12 py-1 px-2 flex justify-between items-center  bg-green-400 text-white text-xl font-bold"},[s("span",[t._v("Paid")]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.tendered)))])])]),t._v(" "),s("div",{staticClass:"px-2 w-full md:w-1/2"},[s("div",{staticClass:"my-1 h-12 py-1 px-2 flex justify-between items-center  bg-red-400 text-white text-xl font-bold"},[s("span",[t._v("Unpaid")]),t._v(" "),t.order.total-t.order.tendered>0?s("span",[t._v(t._s(t._f("currency")(t.order.total-t.order.tendered)))]):t._e(),t._v(" "),t.order.total-t.order.tendered<=0?s("span",[t._v(t._s(t._f("currency")(0)))]):t._e()])]),t._v(" "),s("div",{staticClass:"px-2 w-full md:w-1/2"},[s("div",{staticClass:"my-1 h-12 py-1 px-2 flex justify-between items-center  bg-teal-400 text-white text-xl font-bold"},[s("span",[t._v("Customer Account")]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(t.order.customer.account_amount)))])])])]),t._v(" "),s("div",{staticClass:"flex -mx-4 flex-wrap"},[s("div",{staticClass:"px-2 w-full mb-4 md:w-1/2"},["paid"!==t.order.payment_status?s("div",[s("h3",{staticClass:"font-semibold border-b-2 border-blue-400 py-2"},[t._v("\n                    Payment\n                ")]),t._v(" "),s("div",{staticClass:"py-2"},[t._l(t.fields,(function(t,e){return s("ns-field",{key:e,attrs:{field:t}})})),t._v(" "),s("div",{staticClass:"my-2 px-2 h-12 flex justify-end items-center bg-gray-200"},[t._v("\n                        "+t._s(t._f("currency")(t.inputValue))+"\n                    ")]),t._v(" "),s("ns-numpad",{attrs:{value:t.inputValue},on:{next:function(e){return t.submitPayment(e)},changed:function(e){return t.updateValue(e)}}})],2)]):t._e(),t._v(" "),"paid"===t.order.payment_status?s("div",{staticClass:"flex items-center justify-center h-full"},[s("h3",{staticClass:"text-gray-700 font-semibold"},[t._v("No payment possible for paid order.")])]):t._e()]),t._v(" "),s("div",{staticClass:"px-2 w-full mb-4 md:w-1/2"},[s("h3",{staticClass:"font-semibold border-b-2 border-blue-400 py-2 mb-2"},[t._v("\n                Payment History\n            ")]),t._v(" "),s("ul",t._l(t.order.payments,(function(e){return s("li",{key:e.id,staticClass:"p-2 flex items-center justify-between text-shite bg-gray-300 mb-2"},[s("span",[t._v(t._s(e.identifier))]),t._v(" "),s("span",[t._v(t._s(t._f("currency")(e.value)))])])})),0)])])])}),[],!1,null,null,null).exports,Q={props:["order"],data:function(){return{labels:new $}},methods:{}},D=Object(p.a)(Q,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"-mx-4 flex flex-wrap"},[s("div",{staticClass:"flex-auto"},[s("div",{staticClass:"w-full mb-2 flex-wrap flex"},[t._m(0),t._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"bg-gray-200 p-2 flex justify-between items-start"},[t._m(1),t._v(" "),s("div",{staticClass:"font-semibold text-gray-800"},[t._v(t._s(t._f("currency")(t.order.subtotal)))])])]),t._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start bg-red-400 text-white"},[s("div",[s("h4",{staticClass:"text-semibold"},[s("span",[t._v("Discount")]),t._v(" "),"percentage"===t.order.discount_type?s("span",{staticClass:"ml-1"},[t._v("("+t._s(t.order.discount_percentage)+"%)")]):t._e(),t._v(" "),"flat"===t.order.discount_type?s("span",{staticClass:"ml-1"},[t._v("(Flat)")]):t._e()])]),t._v(" "),s("div",{staticClass:"font-semibold"},[t._v(t._s(t._f("currency")(t.order.discount)))])])]),t._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start bg-gray-100"},[t._m(2),t._v(" "),s("div",{staticClass:"font-semibold text-gray-800"},[t._v(t._s(t._f("currency")(t.order.shipping)))])])]),t._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start bg-yellow-400 text-gray-700"},[t._m(3),t._v(" "),s("div",{staticClass:"font-semibold"},[t._v(t._s(t._f("currency")(t.order.tax_value)))])])]),t._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start bg-blue-400 text-white"},[t._m(4),t._v(" "),s("div",{staticClass:"font-semibold"},[t._v(t._s(t._f("currency")(t.order.total)))])])]),t._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start bg-teal-500 text-white"},[t._m(5),t._v(" "),s("div",{staticClass:"font-semibold"},[t._v(t._s(t._f("currency")(t.order.tendered)))])])]),t._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start text-gray-700 bg-gray-100"},[t._m(6),t._v(" "),s("div",{staticClass:"font-semibold"},[t._v(t._s(t._f("currency")(t.order.change)))])])])])]),t._v(" "),s("div",{staticClass:"px-4 w-full md:w-1/3 lg:w-1/4 mb-2"},[t._m(7),t._v(" "),s("div",{staticClass:"mb-2 p-2 flex justify-between items-start bg-gray-200"},[t._m(8),t._v(" "),s("div",{staticClass:"font-semibold text-gray-800"},[t._v(t._s(t.order.nexopos_customers_name))])]),t._v(" "),s("div",{staticClass:"mb-2 p-2 flex justify-between items-start bg-gray-200"},[t._m(9),t._v(" "),s("div",{staticClass:"font-semibold text-gray-800"},[t._v(t._s(t.labels.getTypeLabel(t.order.type)))])]),t._v(" "),s("div",{staticClass:"mb-2 p-2 flex justify-between items-start bg-gray-200"},[t._m(10),t._v(" "),s("div",{staticClass:"font-semibold text-gray-800"},[t._v(t._s(t.labels.getDeliveryStatus(t.order.delivery_status)))])]),t._v(" "),s("div",{staticClass:"mb-2 p-2 flex justify-between items-start bg-gray-200"},[t._m(11),t._v(" "),s("div",{staticClass:"font-semibold text-gray-800"},[t._v(t._s(t.labels.getProcessingStatus(t.order.delivery_status)))])]),t._v(" "),s("div",{staticClass:"mb-2 p-2 flex justify-between items-start bg-gray-200"},[t._m(12),t._v(" "),s("div",{staticClass:"font-semibold text-gray-800"},[t._v(t._s(t.labels.getPaymentStatus(t.order.payment_status)))])])]),t._v(" "),s("div",{staticClass:"px-4 w-full md:2/3 lg:w-3/4 mb-2"},[t._m(13),t._v(" "),t._l(t.order.products,(function(e){return s("div",{key:e.id,staticClass:"p-2 flex justify-between items-start bg-gray-200"},[s("div",[s("h4",{staticClass:"text-semibold text-gray-700"},[t._v(t._s(e.name)+" (x"+t._s(e.quantity)+")")]),t._v(" "),s("p",{staticClass:"text-gray-600 text-sm"},[t._v(t._s(e.unit.name||"N/A"))])]),t._v(" "),s("div",{staticClass:"font-semibold text-gray-800"},[t._v(t._s(t._f("currency")(e.unit_price)))])])}))],2)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"w-full mb-2 px-4"},[e("h3",{staticClass:"font-semibold text-gray-800 pb-2 border-b border-blue-400"},[this._v("Payment Summary")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h4",{staticClass:"text-semibold text-gray-700"},[this._v("Sub Total")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h4",{staticClass:"text-semibold text-gray-700"},[this._v("Shipping")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h4",{staticClass:"text-semibold "},[this._v("Taxes")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h4",{staticClass:"text-semibold"},[this._v("Total")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h4",{staticClass:"text-semibold"},[this._v("Paid")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h4",{staticClass:"text-semibold"},[this._v("Change")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"mb-2"},[e("h3",{staticClass:"font-semibold text-gray-800 pb-2 border-b border-blue-400"},[this._v("Order Status")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h4",{staticClass:"text-semibold text-gray-700"},[e("span",[this._v("Customer")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h4",{staticClass:"text-semibold text-gray-700"},[e("span",[this._v("Type")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h4",{staticClass:"text-semibold text-gray-700"},[e("span",[this._v("Delivery Status")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h4",{staticClass:"text-semibold text-gray-700"},[e("span",[this._v("Proceessing Status")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h4",{staticClass:"text-semibold text-gray-700"},[e("span",[this._v("Payment Status")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"mb-2"},[e("h3",{staticClass:"font-semibold text-gray-800 pb-2 border-b border-blue-400"},[this._v("Products")])])}],!1,null,null,null).exports,q={filters:{nsCurrency:i.a},name:"ns-preview-popup",data:function(){return{active:"details",order:new Object,products:[],payments:[]}},components:{nsOrderRefund:j,nsOrderPayment:E,nsOrderDetails:D},computed:{isVoidable:function(){return["paid","partially_paid","unpaid"].includes(this.order.payment_status)},isDeleteAble:function(){return["hold"].includes(this.order.payment_status)}},methods:{closePopup:function(){this.$popup.close()},setActive:function(t){this.active=t},refresh:function(){this.$popupParams.component.$emit("updated"),this.loadOrderDetails(this.$popupParams.order.id)},printOrder:function(){var t=this.$popupParams.order;r.nsHttpClient.get("/api/nexopos/v4/orders/".concat(t.id,"/print/receipt")).subscribe((function(t){r.nsSnackBar.success(t.message).subscribe()}))},loadOrderDetails:function(t){var e=this;Object(n.a)([r.nsHttpClient.get("/api/nexopos/v4/orders/".concat(t)),r.nsHttpClient.get("/api/nexopos/v4/orders/".concat(t,"/products")),r.nsHttpClient.get("/api/nexopos/v4/orders/".concat(t,"/payments"))]).subscribe((function(t){e.order=t[0],e.products=t[1],e.payments=t[2],console.log(t)}))},deleteOrder:function(){var t=this;Popup.show(g.default,{title:"Confirm Your Action",message:"Would you like to delete this order",onAction:function(e){e&&r.nsHttpClient.delete("/api/nexopos/v4/orders/".concat(t.$popupParams.order.id)).subscribe((function(e){r.nsSnackBar.success(e.message).subscribe(),t.refreshCrudTable(),t.closePopup()}),(function(t){r.nsSnackBar.error(t.message).subscribe()}))}})},voidOrder:function(){var t=this;Popup.show(O.default,{title:"Confirm Your Action",message:"The current order will be void. This action will be recorded. Consider providing a reason for this operation",onAction:function(e){!1!==e&&r.nsHttpClient.post("/api/nexopos/v4/orders/".concat(t.$popupParams.order.id,"/void"),{reason:e}).subscribe((function(e){r.nsSnackBar.success(e.message).subscribe(),t.refreshCrudTable(),t.closePopup()}),(function(t){r.nsSnackBar.error(t.message).subscribe()}))}})},refreshCrudTable:function(){this.$popupParams.component.$emit("updated",!0)}},watch:{active:function(){"details"===this.active&&this.loadOrderDetails(this.$popupParams.order.id)}},mounted:function(){var t=this;this.loadOrderDetails(this.$popupParams.order.id),this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&t.$popup.close()}))}};window.nsOrderPreviewPopup=q;var A=q,U=Object(p.a)(A,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"h-6/7-screen w-6/7-screen shadow-xl bg-white flex flex-col"},[s("div",{staticClass:"border-b border-gray-300 p-3 flex items-center justify-between"},[t._m(0),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.closePopup()}}})],1)]),t._v(" "),s("div",{staticClass:"p-2 overflow-hidden bg-gray-100 flex flex-auto"},[t.order.id?s("ns-tabs",{attrs:{active:t.active},on:{active:function(e){return t.setActive(e)}}},[s("ns-tabs-item",{staticClass:"overflow-y-auto",attrs:{label:"Details",identifier:"details"}},[s("ns-order-details",{attrs:{order:t.order}})],1),t._v(" "),["order_void","hold","refunded","partially_refunded"].includes(t.order.payment_status)?t._e():s("ns-tabs-item",{staticClass:"overflow-y-auto",attrs:{label:"Payments",identifier:"payments"}},[s("ns-order-payment",{attrs:{order:t.order},on:{changed:function(e){return t.refresh()}}})],1),t._v(" "),["order_void","hold","refunded"].includes(t.order.payment_status)?t._e():s("ns-tabs-item",{staticClass:"flex overflow-y-auto",attrs:{label:"Refund & Return",identifier:"refund"}},[s("ns-order-refund",{attrs:{order:t.order}})],1)],1):t._e(),t._v(" "),t.order.id?t._e():s("div",{staticClass:"h-full w-full flex items-center justify-center"},[s("ns-spinner")],1)],1),t._v(" "),s("div",{staticClass:"p-2 flex justify-between border-t border-gray-200"},[s("div",[t.isVoidable?s("ns-button",{attrs:{type:"danger"},on:{click:function(e){return t.voidOrder()}}},[s("i",{staticClass:"las la-ban"}),t._v("\n                Void\n            ")]):t._e(),t._v(" "),t.isDeleteAble?s("ns-button",{attrs:{type:"danger"},on:{click:function(e){return t.deleteOrder()}}},[s("i",{staticClass:"las la-trash"}),t._v("\n                Delete\n            ")]):t._e()],1),t._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.printOrder()}}},[s("i",{staticClass:"las la-print"}),t._v("\n                Print\n            ")])],1)])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h3",[this._v("Order Options")])])}],!1,null,null,null).exports,B={name:"ns-products-preview",computed:{product:function(){return this.$popupParams.product}},methods:{changeActiveTab:function(t){this.active=t,"units-quantities"===this.active&&this.loadProductQuantities()},loadProductQuantities:function(){var t=this;this.hasLoadedUnitQuantities=!1,r.nsHttpClient.get("/api/nexopos/v4/products/".concat(this.product.id,"/units/quantities")).subscribe((function(e){t.unitQuantities=e,t.hasLoadedUnitQuantities=!0}))}},data:function(){return{active:"units-quantities",unitQuantities:[],hasLoadedUnitQuantities:!1}},mounted:function(){var t=this;this.loadProductQuantities(),this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&t.$popup.close()}))}},T=Object(p.a)(B,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shadow-lg w-6/7-screen lg:w-3/5-screen h-6/7-screen lg:h-4/5-screen bg-white overflow-hidden flex flex-col"},[s("div",{staticClass:"p-2 border-b border-gray-200 text-gray-700 text-center font-medium flex justify-between items-center"},[s("div",[t._v("\n            Previewing : "+t._s(t.product.name)+"\n        ")]),t._v(" "),s("div",[s("ns-close-button",{on:{click:function(e){return t.$popup.close()}}})],1)]),t._v(" "),s("div",{staticClass:"flex-auto overflow-y-auto bg-gray-100"},[s("div",{staticClass:"p-2"},[s("ns-tabs",{attrs:{active:t.active},on:{active:function(e){return t.changeActiveTab(e)}}},[s("ns-tabs-item",{attrs:{label:"Units & Quantities",identifier:"units-quantities"}},[t.hasLoadedUnitQuantities?s("table",{staticClass:"table w-full"},[s("thead",[s("tr",[s("th",{staticClass:"p-1 bg-blue-100 border-blue-400 text-blue-700 border"},[t._v("Unit")]),t._v(" "),s("th",{staticClass:"text-right p-1 bg-blue-100 border-blue-400 text-blue-700 border",attrs:{width:"150"}},[t._v("Sale Price")]),t._v(" "),s("th",{staticClass:"text-right p-1 bg-blue-100 border-blue-400 text-blue-700 border",attrs:{width:"150"}},[t._v("Wholesale Price")]),t._v(" "),s("th",{staticClass:"text-right p-1 bg-blue-100 border-blue-400 text-blue-700 border",attrs:{width:"150"}},[t._v("Quantity")])])]),t._v(" "),s("tbody",t._l(t.unitQuantities,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"p-1 border border-gray-400 text-gray-600 text-left"},[t._v(t._s(e.unit.name))]),t._v(" "),s("td",{staticClass:"p-1 border border-gray-400 text-gray-600 text-right"},[t._v(t._s(t._f("currency")(e.sale_price)))]),t._v(" "),s("td",{staticClass:"p-1 border border-gray-400 text-gray-600 text-right"},[t._v(t._s(t._f("currency")(e.wholesale_price)))]),t._v(" "),s("td",{staticClass:"p-1 border border-gray-400 text-gray-600 text-right"},[t._v(t._s(e.quantity))])])})),0)]):t._e(),t._v(" "),t.hasLoadedUnitQuantities?t._e():s("ns-spinner",{attrs:{size:"16",border:"4"}})],1)],1)],1)])])}),[],!1,null,null,null).exports,H=s(53),G=s(45),N={nsOrderPreview:U,nsProductPreview:T,nsAlertPopup:H.default,nsConfirmPopup:g.default,nsPromptPopup:O.default,nsMediaPopup:G.a};for(var L in N)window[L]=N[L]}},[[264,0,1]]]);
//# sourceMappingURL=popups.js.map