(self.webpackChunkNexoPOS_4x=self.webpackChunkNexoPOS_4x||[]).push([[1443],{9671:(e,t,n)=>{"use strict";n.d(t,{l:()=>N,kq:()=>B,ih:()=>W,kX:()=>X});var r=n(6486),i=n(9669),s=n(2728),a=n(8345),o=n(9624),u=n(9248),c=n(230);function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._subject=new u.x}var t,n,r;return t=e,n=[{key:"defineClient",value:function(e){this._client=e}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._request("post",e,t,n)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._request("get",e,void 0,t)}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._request("delete",e,void 0,t)}},{key:"put",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._request("put",e,t,n)}},{key:"response",get:function(){return this._lastRequestData}},{key:"_request",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return t=B.applyFilters("http-client-url",t.replace(/\/$/,"")),this._subject.next({identifier:"async.start",url:t,data:r}),new c.y((function(s){n._client[e](t,r,Object.assign(Object.assign({},n._client.defaults[e]),i)).then((function(e){n._lastRequestData=e,s.next(e.data),s.complete(),n._subject.next({identifier:"async.stop"})})).catch((function(e){var t;s.error((null===(t=e.response)||void 0===t?void 0:t.data)||e.response||e),n._subject.next({identifier:"async.stop"})}))}))}},{key:"subject",value:function(){return this._subject}},{key:"emit",value:function(e){var t=e.identifier,n=e.value;this._subject.next({identifier:t,value:n})}}],n&&l(t.prototype,n),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),p=n(3);function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._subject=new p.t}var t,n,r;return t=e,(n=[{key:"subject",value:function(){return this._subject}},{key:"emit",value:function(e){var t=e.identifier,n=e.value;this._subject.next({identifier:t,value:n})}}])&&f(t.prototype,n),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),v=n(6515);function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state={},this.behaviorState=new v.X({}),this.behaviorState.subscribe((function(e){n.state=e})),this.setState(t)}var t,n,r;return t=e,(n=[{key:"setState",value:function(e){this.behaviorState.next(Object.assign(Object.assign({},this.state),{object:e}))}}])&&b(t.prototype,n),r&&b(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),_=n(2401),m=n(9614),g=n(381),w=n(2242),x=n(538),k=n(7266);function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var P=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=ns.base_url}var t,n,r;return t=e,(n=[{key:"get",value:function(e){return this.url+e}}])&&j(t.prototype,n),r&&j(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),C=x.default.filter("abbreviate",(function(e){var t=e;if(e>=1e3){for(var n,r=Math.floor((""+e).length/3),i=2;i>=1;i--){if(((n=parseFloat((0!=r?e/Math.pow(1e3,r):e).toPrecision(i)))+"").replace(/[^a-zA-Z 0-9]+/g,"").length<=2)break}n%1!=0&&(n=n.toFixed(1)),t=n+["","k","m","b","t"][r]}return t})),O=n(1356),S=n(9698);function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var q=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instances=new Object}var t,n,r;return t=e,(n=[{key:"getInstance",value:function(e){return this.instances[e]}},{key:"defineInstance",value:function(e,t){this.instances[e]=t}}])&&$(t.prototype,n),r&&$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),T=n(2319),V=n(7389),E=n(6386),A=n(8603),F=n(4554);function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var z=n(6606);window._=r,window.ChartJS=s,window.Pusher=z,window.Vue=x.default,window.moment=g,window.Axios=i,window.__=V.__,window.__m=V.c,window.VueRouter=a.Z,window.SnackBar=o.S,window.nsHooks=(0,T.Hu)(),window.popupResolver=E.Z,window.popupCloser=A.Z,window.Axios.defaults.headers.common["x-requested-with"]="XMLHttpRequest",window.Axios.defaults.withCredentials=!0,ns.websocket.enabled&&(window.Echo=new F.Z({broadcaster:"pusher",key:ns.websocket.key,wsHost:ns.websocket.host,wsPort:ns.websocket.port,wssPort:ns.websocket.port,namespace:"",forceTLS:ns.websocket.secured,disableStats:!0,encrypted:ns.websocket.secured,enabledTransports:ns.websocket.secured?["ws","wss"]:["ws"],disabledTransports:ns.websocket.secured?["sockjs","xhr_polling","xhr_streaming"]:[]}));var N=new h,W=new d,X=new o.S,L=new P,U=new q,B=window.nsHooks,R=new(function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.breakpoint="",this.detectScreenSizes(),(0,_.R)(window,"resize").subscribe((function(e){return t.detectScreenSizes()}))}var t,n,r;return t=e,(n=[{key:"detectScreenSizes",value:function(){switch(!0){case window.outerWidth>0&&window.outerWidth<=480:this.breakpoint="xs";break;case window.outerWidth>480&&window.outerWidth<=640:this.breakpoint="sm";break;case window.outerWidth>640&&window.outerWidth<=1024:this.breakpoint="md";break;case window.outerWidth>1024&&window.outerWidth<=1280:this.breakpoint="lg";break;case window.outerWidth>1280:this.breakpoint="xl"}}}])&&Q(t.prototype,n),r&&Q(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()),I=new y({sidebar:["xs","sm","md"].includes(R.breakpoint)?"hidden":"visible"});W.defineClient(i),window.nsEvent=N,window.nsHttpClient=W,window.nsSnackBar=X,window.nsCurrency=O.W,window.nsTruncate=S.b,window.nsRawCurrency=O.f,window.nsAbbreviate=C,window.nsState=I,window.nsUrl=L,window.nsScreen=R,window.ChartJS=s,window.EventEmitter=h,window.Popup=w.G,window.RxJS=m,window.FormValidation=k.Z,window.nsCrudHandler=U},1356:(e,t,n)=>{"use strict";n.d(t,{W:()=>c,f:()=>l});var r=n(538),i=n(2077),s=n.n(i),a=n(6740),o=n.n(a),u=new Array(parseInt(ns.currency.ns_currency_precision)).fill("").map((function(e){return 0})).join(""),c=r.default.filter("currency",(function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"full";switch(ns.currency.ns_currency_prefered){case"iso":t=ns.currency.ns_currency_iso;break;case"symbol":t=ns.currency.ns_currency_symbol}if("full"===r){var i={decimal:ns.currency.ns_currency_decimal_separator,separator:ns.currency.ns_currency_thousand_separator,precision:parseInt(ns.currency.ns_currency_precision),symbol:""};n=o()(e,i).format()}else n=s()(e).format("0.0a");return"".concat("before"===ns.currency.ns_currency_position?t:"").concat(n).concat("after"===ns.currency.ns_currency_position?t:"")})),l=function(e){var t="0.".concat(u);return parseFloat(s()(e).format(t))}},9698:(e,t,n)=>{"use strict";n.d(t,{b:()=>r});var r=n(538).default.filter("truncate",(function(e,t){return e?(e=e.toString()).length>t?e.substring(0,t)+"...":e:""}))},7266:(e,t,n)=>{"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,{Z:()=>i});var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,n=[{key:"validateFields",value:function(e){var t=this;return 0===e.map((function(e){return t.checkField(e),e.errors?0===e.errors.length:0})).filter((function(e){return!1===e})).length}},{key:"validateFieldsErrors",value:function(e){var t=this;return e.map((function(e){return t.checkField(e),e.errors})).flat()}},{key:"validateForm",value:function(e){e.main&&this.validateField(e.main);var t=[];for(var n in e.tabs){var r=[],i=this.validateFieldsErrors(e.tabs[n].fields);i.length>0&&r.push(i),e.tabs[n].errors=r.flat(),t.push(r.flat())}return t.flat().filter((function(e){return void 0!==e}))}},{key:"initializeTabs",value:function(e){var t=0;for(var n in e)0===t&&(e[n].active=!0),e[n].active=void 0!==e[n].active&&e[n].active,e[n].fields=this.createFields(e[n].fields),t++;return e}},{key:"validateField",value:function(e){return this.checkField(e)}},{key:"fieldsValid",value:function(e){return!(e.map((function(e){return e.errors&&e.errors.length>0})).filter((function(e){return e})).length>0)}},{key:"createFields",value:function(e){return e.map((function(e){return e.type=e.type||"text",e.errors=e.errors||[],e.disabled=e.disabled||!1,"custom"===e.type&&(e.component=nsExtraComponents[e.name]),e}))}},{key:"createForm",value:function(e){if(e.main&&(e.main=this.createFields([e.main])[0]),e.tabs)for(var t in e.tabs)e.tabs[t].fields=this.createFields(e.tabs[t].fields),e.tabs[t].errors=[];return e}},{key:"enableFields",value:function(e){return e.map((function(e){return e.disabled=!1}))}},{key:"disableFields",value:function(e){return e.map((function(e){return e.disabled=!0}))}},{key:"disableForm",value:function(e){for(var t in e.main&&(e.main.disabled=!0),e.tabs)e.tabs[t].fields.forEach((function(e){return e.disabled=!0}))}},{key:"enableForm",value:function(e){for(var t in e.main&&(e.main.disabled=!1),e.tabs)e.tabs[t].fields.forEach((function(e){return e.disabled=!1}))}},{key:"getValue",value:function(e){var t={};return e.forEach((function(e){t[e.name]=e.value})),t}},{key:"checkField",value:function(e){var t=this;return void 0!==e.validation&&(e.errors=[],this.detectValidationRules(e.validation).forEach((function(n){t.fieldPassCheck(e,n)}))),e}},{key:"extractForm",value:function(e){var t={};if(e.main&&(t[e.main.name]=e.main.value),e.tabs)for(var n in e.tabs)void 0===t[n]&&(t[n]={}),t[n]=this.extractFields(e.tabs[n].fields);return t}},{key:"extractFields",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.forEach((function(e){t[e.name]=e.value})),t}},{key:"detectValidationRules",value:function(e){var t=function(e){var t;return["email","required"].includes(e)?{identifier:e}:(t=/(min)\:([0-9])+/g.exec(e))||(t=/(max)\:([0-9])+/g.exec(e))?{identifier:t[1],value:t[2]}:e};return Array.isArray(e)?e.filter((function(e){return"string"==typeof e})).map(t):e.split("|").map(t)}},{key:"triggerError",value:function(e,t){if(t.errors){var n=function(n){var r=n.split(".").filter((function(e){return!/^\d+$/.test(e)}));2===r.length&&e.tabs[r[0]].fields.forEach((function(e){e.name===r[1]&&t.errors[n].forEach((function(t){var n={identifier:"invalid",invalid:!0,message:t,name:e.name};e.errors.push(n)}))})),n===e.main.name&&t.errors[n].forEach((function(t){e.main.errors.push({identifier:"invalid",invalid:!0,message:t,name:e.main.name})}))};for(var r in t.errors)n(r)}}},{key:"triggerFieldsErrors",value:function(e,t){if(t&&t.errors){var n=function(n){e.forEach((function(e){e.name===n&&t.errors[n].forEach((function(t){var n={identifier:"invalid",invalid:!0,message:t,name:e.name};e.errors.push(n)}))}))};for(var r in t.errors)n(r)}}},{key:"fieldPassCheck",value:function(e,t){if("required"===t.identifier){if(void 0===e.value||null===e.value||0===e.value.length)return e.errors.push({identifier:t.identifier,invalid:!0,name:e.name});e.errors.forEach((function(n,r){n.identifier===t.identifier&&!0===n.invalid&&e.errors.splice(r,1)}))}if("email"===t.identifier&&e.value.length>0){if(!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,4})+$/.test(e.value))return e.errors.push({identifier:t.identifier,invalid:!0,name:e.name});e.errors.forEach((function(n,r){!0===n[t.identifier]&&e.errors.splice(r,1)}))}return e}}],n&&r(t.prototype,n),i&&r(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}()},7389:(e,t,n)=>{"use strict";n.d(t,{__:()=>r,c:()=>i});var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"NexoPOS";return nsLanguage.getEntries(t)&&nsLanguage.getEntries(t)[e]||e},i=function(e,t){return nsLanguage.getEntries(t)&&nsLanguage.getEntries(t)[e]||e}},8603:(e,t,n)=>{"use strict";function r(){var e=this;Object.keys(this).includes("$popup")&&this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&(e.$popupParams&&void 0!==e.$popupParams.reject&&e.$popupParams.reject(!1),e.$popup.close()),"press-esc"===t.event&&(e.$popupParams&&void 0!==e.$popupParams.reject&&e.$popupParams.reject(!1),e.$popup.close())}))}n.d(t,{Z:()=>r})},6386:(e,t,n)=>{"use strict";function r(e){void 0!==this.$popupParams.resolve&&this.$popupParams.reject&&(!1!==e?this.$popupParams.resolve(e):this.$popupParams.reject(e)),this.$popup.close()}n.d(t,{Z:()=>r})},2242:(e,t,n)=>{"use strict";n.d(t,{G:()=>c});var r=n(7757),i=n.n(r),s=n(9248);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{u(r.next(e))}catch(e){s(e)}}function o(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}u((r=r.apply(e,t||[])).next())}))},c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(a(this,e),this.config={primarySelector:void 0,popupClass:"shadow-lg h-half w-1/2 bg-white"},this.container=document.createElement("div"),this.popupBody=document.createElement("div"),this.config=Object.assign(this.config,t),void 0===this.config.primarySelector&&document.querySelectorAll(".is-popup").length>0){var n=document.querySelectorAll(".is-popup").length;this.parentWrapper=document.querySelectorAll(".is-popup")[n-1]}else this.parentWrapper=document.querySelector("body").querySelectorAll("div")[0];this.event=new s.x}var t,n,r;return t=e,n=[{key:"open",value:function(e){var t,n,r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u(this,void 0,void 0,i().mark((function a(){var o,u,c=this;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if("function"!=typeof e){i.next=4;break}return i.next=3,e();case 3:e=i.sent.default;case 4:o=document.querySelector("body").querySelectorAll("div")[0],this.parentWrapper.style.filter="blur(4px)",o.style.filter="blur(6px)",this.container.setAttribute("class","absolute top-0 left-0 w-full h-full flex items-center justify-center is-popup"),this.container.addEventListener("click",(function(e){c.event.next({event:"click-overlay",value:!0}),e.stopPropagation()})),this.popupBody.addEventListener("click",(function(e){e.stopImmediatePropagation()})),this.container.style.background="rgb(51 51 51 / 20%)",this.container.id="popup-container-"+document.querySelectorAll(".is-popup").length,this.popupBody.setAttribute("class"," zoom-out-entrance"),this.popupBody.innerHTML='<div class="popup-body"></div>',this.container.appendChild(this.popupBody),document.body.appendChild(this.container),u=Vue.extend(e),this.instance=new u({propsData:{popup:this}}),this.instance.template=(null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.template)||void 0,this.instance.render=e.render||void 0,this.instance.methods=(null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.methods)||(null==e?void 0:e.methods),this.instance.data=(null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.data)||(null==e?void 0:e.data),this.instance.$popup=this,this.instance.$popupParams=s,this.instance.$mount("#".concat(this.container.id," .popup-body"));case 25:case"end":return i.stop()}}),a,this)})))}},{key:"close",value:function(){var e=this;this.instance.$destroy(),this.event.unsubscribe(),this.parentWrapper.style.filter="blur(0px)";var t=document.querySelector("body").querySelectorAll("div")[0];document.querySelectorAll(".is-popup").length<=1&&(t.style.filter="blur(0px)"),this.popupBody.classList.remove("zoom-out-entrance"),this.popupBody.classList.add("zoom-in-exit"),this.container.classList.remove("is-popup"),setTimeout((function(){e.container.remove()}),300)}}],r=[{key:"show",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=new e(r);return i.open(t,n),i}}],n&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},9624:(e,t,n)=>{"use strict";n.d(t,{S:()=>s});var r=n(3260);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),void 0===window.snackbarQueue&&(window.snackbarQueue=[],this.queue=window.snackbarQueue)}var t,n,s;return t=e,n=[{key:"show",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{duration:3e3,type:"info"};return r.Observable.create((function(r){var s=n.__createSnack({message:e,label:t,type:i.type}),a=s.buttonNode,o=(s.textNode,s.snackWrapper,s.sampleSnack);a.addEventListener("click",(function(e){r.onNext(a),r.onCompleted(),o.remove()})),n.__startTimer(i.duration,o)}))}},{key:"error",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{duration:3e3,type:"error"};return this.show(e,t,Object.assign(Object.assign({},n),{type:"error"}))}},{key:"success",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{duration:3e3,type:"success"};return this.show(e,t,Object.assign(Object.assign({},n),{type:"success"}))}},{key:"info",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{duration:3e3,type:"info"};return this.show(e,t,Object.assign(Object.assign({},n),{type:"info"}))}},{key:"__startTimer",value:function(e,t){var n,r=function(){e>0&&!1!==e&&(n=setTimeout((function(){t.remove()}),e))};t.addEventListener("mouseenter",(function(){clearTimeout(n)})),t.addEventListener("mouseleave",(function(){r()})),r()}},{key:"__createSnack",value:function(e){var t=e.message,n=e.label,r=e.type,i=void 0===r?"info":r,s=document.getElementById("snack-wrapper")||document.createElement("div"),a=document.createElement("div"),o=document.createElement("p"),u=document.createElement("div"),c=document.createElement("button"),l="",d="";switch(i){case"info":l="text-white hover:bg-blue-400 bg-blue-500",d="bg-gray-900 text-white";break;case"error":l="text-red-700 hover:bg-white bg-white",d="bg-red-500 text-white";break;case"success":l="text-green-700 hover:bg-white bg-white",d="bg-green-500 text-white"}return o.textContent=t,n&&(c.textContent=n,c.setAttribute("class","px-3 py-2 shadow rounded uppercase ".concat(l)),u.appendChild(c)),a.appendChild(o),a.appendChild(u),a.setAttribute("class","md:rounded py-2 px-3 md:w-2/5 w-full z-10 md:my-2 shadow-lg flex justify-between items-center zoom-in-entrance anim-duration-300 ".concat(d)),s.appendChild(a),null===document.getElementById("snack-wrapper")&&(s.setAttribute("id","snack-wrapper"),s.setAttribute("class","absolute bottom-0 w-full flex justify-between items-center flex-col"),document.body.appendChild(s)),{snackWrapper:s,sampleSnack:a,buttonsWrapper:u,buttonNode:c,textNode:o}}}],n&&i(t.prototype,n),s&&i(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}()},279:(e,t,n)=>{"use strict";n.d(t,{$:()=>u});var r=n(9671),i=n(7389),s=n(2242),a=n(2245);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.product=t}var t,n,u;return t=e,(n=[{key:"run",value:function(e){var t=this;return new Promise((function(n,o){var u=new s.G({popupClass:"shadow-lg h-1/2-screen w-3/4 md:w-1/2 lg:w-2/5 xl:w-1/4 bg-white"}),c=t.product;if(!1===POS.options.getValue().ns_pos_show_quantity&&POS.processingAddQueue){if("enabled"===c.$original().stock_management){var l=POS.getStockUsage(c.$original().id,e.unit_quantity_id)-(c.quantity||0);if(1>parseFloat(e.$quantities().quantity)-l)return r.kX.error((0,i.__)("Unable to add the product, there is not enough stock. Remaining %s").replace("%s",(e.$quantities().quantity-l).toString())).subscribe()}n({quantity:1})}else u.open(a.default,{resolve:n,reject:o,product:c,data:e})}))}}])&&o(t.prototype,n),u&&o(t,u),Object.defineProperty(t,"prototype",{writable:!1}),e}()},9188:(e,t,n)=>{"use strict";var r=n(7757),i=n.n(r),s=n(279),a=n(2242),o=n(9671),u=n(7389);const c={data:function(){return{unitsQuantities:[],loadsUnits:!1,options:null,optionsSubscriber:null}},beforeDestroy:function(){this.optionsSubscriber.unsubscribe()},mounted:function(){var e=this;this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&(e.$popupParams.reject(!1),e.$popup.close())})),this.optionsSubscriber=POS.options.subscribe((function(t){e.options=t})),void 0!==this.$popupParams.product.$original().selectedUnitQuantity?this.selectUnit(this.$popupParams.product.$original().selectedUnitQuantity):void 0!==this.$popupParams.product.$original().unit_quantities&&1===this.$popupParams.product.$original().unit_quantities.length?this.selectUnit(this.$popupParams.product.$original().unit_quantities[0]):(this.loadsUnits=!0,this.loadUnits())},methods:{__:u.__,displayRightPrice:function(e){return POS.getSalePrice(e,this.$popupParams.product.$original())},loadUnits:function(){var e=this;o.ih.get("/api/nexopos/v4/products/".concat(this.$popupParams.product.$original().id,"/units/quantities")).subscribe((function(t){if(0===t.length)return e.$popup.close(),o.kX.error((0,u.__)("This product doesn't have any unit defined for selling.")).subscribe();e.unitsQuantities=t,1===e.unitsQuantities.length&&e.selectUnit(e.unitsQuantities[0])}))},selectUnit:function(e){this.$popupParams.resolve({unit_quantity_id:e.id,unit_name:e.unit.name,$quantities:function(){return e}}),this.$popup.close()}}};const l=(0,n(1900).Z)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"h-full w-full flex items-center justify-center"},[e.unitsQuantities.length>0?n("div",{staticClass:"bg-white w-2/3-screen lg:w-1/3-screen overflow-hidden flex flex-col"},[n("div",{staticClass:"h-16 flex justify-center items-center flex-shrink-0",attrs:{id:"header"}},[n("h3",{staticClass:"font-bold text-gray-700"},[e._v(e._s(e.__("Choose Selling Unit")))])]),e._v(" "),e.unitsQuantities.length>0?n("div",{staticClass:"grid grid-flow-row grid-cols-2 overflow-y-auto"},e._l(e.unitsQuantities,(function(t){return n("div",{key:t.id,staticClass:"hover:bg-gray-200 cursor-pointer border flex-shrink-0 border-gray-200 flex flex-col items-center justify-center",on:{click:function(n){return e.selectUnit(t)}}},[n("div",{staticClass:"h-40 w-full flex items-center justify-center overflow-hidden"},[t.preview_url?n("img",{staticClass:"object-cover h-full",attrs:{src:t.preview_url,alt:t.unit.name}}):e._e(),e._v(" "),t.preview_url?e._e():n("div",{staticClass:"h-40 flex items-center justify-center"},[n("i",{staticClass:"las la-image text-gray-600 text-6xl"})])]),e._v(" "),n("div",{staticClass:"h-0 w-full"},[n("div",{staticClass:"relative w-full flex items-center justify-center -top-10 h-20 py-2 flex-col",staticStyle:{background:"rgb(255 255 255 / 73%)"}},[n("h3",{staticClass:"font-bold text-gray-700 py-2 text-center"},[e._v(e._s(t.unit.name)+" ("+e._s(t.quantity)+")")]),e._v(" "),n("p",{staticClass:"text-sm font-medium text-gray-600"},[e._v(e._s(e._f("currency")(e.displayRightPrice(t))))])])])])})),0):e._e()]):e._e(),e._v(" "),0===e.unitsQuantities.length?n("div",{staticClass:"h-56 flex items-center justify-center"},[n("ns-spinner")],1):e._e()])}),[],!1,null,null,null).exports;function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.product=t}var t,n,r;return t=e,(n=[{key:"run",value:function(){var e=this;return new Promise((function(t,n){var r=new a.G({popupClass:"shadow-lg h-1/2-screen w-3/4 xl:w-1/4 bg-white"}),i=e.product;r.open(l,{resolve:t,reject:n,product:i})}))}}])&&d(t.prototype,n),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),f=n(6515),h=n(538);function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var b=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.detect()}var t,n,r;return t=e,(n=[{key:"detect",value:function(){window.innerWidth<544?this.screenIs="xs":window.innerWidth>=544&&window.innerWidth<768?this.screenIs="sm":window.innerWidth>=768&&window.innerWidth<992?this.screenIs="md":window.innerWidth>=992&&window.innerWidth<1200?this.screenIs="lg":window.innerWidth>=1200&&(this.screenIs="xl")}},{key:"is",value:function(e){return void 0===e?this.screenIs:this.screenIs===e}}])&&v(t.prototype,n),r&&v(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),y=n(381),_=n.n(y);function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var g=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{u(r.next(e))}catch(e){s(e)}}function o(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}u((r=r.apply(e,t||[])).next())}))},w=window.NsPosDashboardButton=function(){return n.e(904).then(n.bind(n,904))},x=window.NsPosPendingOrderButton=function(){return n.e(1134).then(n.bind(n,1134))},k=window.NsPosOrderTypeButton=function(){return n.e(9271).then(n.bind(n,9271))},j=window.NsPosCustomersButton=function(){return n.e(7073).then(n.bind(n,7073))},P=window.NsPosResetButton=function(){return n.e(1749).then(n.bind(n,1749))},C=window.NsPosCashRegister=function(){return n.e(8319).then(n.bind(n,8319))},O=window.NsAlertPopup=function(){return n.e(6189).then(n.bind(n,6189))},S=window.NsConfirmPopup=function(){return n.e(8774).then(n.bind(n,8774))},$=(window.NsPOSLoadingPopup=function(){return n.e(2004).then(n.bind(n,2004))},window.NsPromptPopup=function(){return n.e(3793).then(n.bind(n,3793))}),q=window.NsLayawayPopup=function(){return n.e(4202).then(n.bind(n,4202))},T=window.NsLayawayPopup=function(){return n.e(7585).then(n.bind(n,7585))},V=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._orderTypeProcessQueue=[],this._holdPopupEnabled=!0,this._initialQueue=[],this._responsive=new b,this._isSubmitting=!1,this._processingAddQueue=!1,this.defaultOrder=function(){return{discount_type:null,title:"",discount:0,register_id:t.get("register")?t.get("register").id:void 0,discount_percentage:0,subtotal:0,total:0,coupons:[],total_coupons:0,tendered:0,note:"",note_visibility:"hidden",tax_group_id:void 0,tax_type:void 0,taxes:[],tax_groups:[],payment_status:void 0,customer_id:void 0,change:0,total_products:0,shipping:0,tax_value:0,product_taxes:0,shipping_rate:0,shipping_type:void 0,customer:void 0,type:void 0,products:[],instalments:[],payments:[],addresses:{shipping:void 0,billing:void 0}}},this.addToCartQueue=[p,s.$],this.initialize()}var t,n,r;return t=e,n=[{key:"screen",get:function(){return this._screen}},{key:"visibleSection",get:function(){return this._visibleSection}},{key:"paymentsType",get:function(){return this._paymentsType}},{key:"selectedPaymentType",get:function(){return this._selectedPaymentType}},{key:"order",get:function(){return this._order}},{key:"types",get:function(){return this._types}},{key:"products",get:function(){return this._products}},{key:"customers",get:function(){return this._customers}},{key:"options",get:function(){return this._options}},{key:"orderTypeQueue",get:function(){return this._orderTypeProcessQueue}},{key:"settings",get:function(){return this._settings}},{key:"breadcrumbs",get:function(){return this._breadcrumbs}},{key:"initialQueue",get:function(){return this._initialQueue}},{key:"responsive",get:function(){return this._responsive}},{key:"processingAddQueue",get:function(){return this._processingAddQueue}},{key:"reset",value:function(){this._isSubmitting=!1,this.order.next(this.defaultOrder()),this._products.next([]),this._customers.next([]),this._breadcrumbs.next([]),this.defineCurrentScreen(),this.setHoldPopupEnabled(!0),this.processInitialQueue(),this.refreshCart()}},{key:"initialize",value:function(){var e=this;this._products=new f.X([]),this._customers=new f.X([]),this._types=new f.X([]),this._breadcrumbs=new f.X([]),this._screen=new f.X(""),this._paymentsType=new f.X([]),this._visibleSection=new f.X("both"),this._options=new f.X({}),this._settings=new f.X({}),this._order=new f.X(this.defaultOrder()),this._selectedPaymentType=new f.X(null),this._orderTypeProcessQueue=[{identifier:"handle.delivery-order",promise:function(e){return new Promise((function(t,n){return e&&"delivery"===e.identifier?a.G.show(T,{resolve:t,reject:n}):t({status:"success",message:"Proceed"})}))}}],this.initialQueue.push((function(){return new Promise((function(t,n){var r=e.options.getValue(),i=e.order.getValue();return!1!==r.ns_pos_tax_group&&(i.tax_group_id=r.ns_pos_tax_group,i.tax_type=r.ns_pos_tax_type,e.order.next(i)),t({status:"success",message:"tax group assignated"})}))})),this.initialQueue.push((function(){return new Promise((function(t,n){var r=e.options.getValue();return e.order.getValue(),!1!==r.ns_customers_default&&o.ih.get("/api/nexopos/v4/customers/".concat(r.ns_customers_default)).subscribe({next:function(n){e.selectCustomer(n),t({status:"success",message:(0,u.__)("The customer has been loaded")})},error:function(e){o.kX.error((0,u.__)("Unable to select the default customer. Looks like the customer no longer exists. Consider changing the default customer on the settings."),(0,u.__)("OKAY"),{duration:0}).subscribe(),n(e)}}),t({status:"success",message:"tax group assignated"})}))})),this.products.subscribe((function(t){e.refreshCart()})),this.types.subscribe((function(t){var n=Object.values(t).filter((function(e){return e.selected}));if(n.length>0){var r=e.order.getValue();r.type=n[0],e.order.next(r)}})),window.addEventListener("resize",(function(){e._responsive.detect(),e.defineCurrentScreen()})),window.onbeforeunload=function(){if(e.products.getValue().length>0)return(0,u.__)("Some products has been added to the cart. Would youl ike to discard this order ?")},this.defineCurrentScreen()}},{key:"getSalePrice",value:function(e,t){return"inclusive"===t.tax_type?e.incl_tax_sale_price:e.excl_tax_sale_price}},{key:"getCustomPrice",value:function(e,t){return"inclusive"===t.tax_type?e.incl_tax_custom_price:e.excl_tax_custom_price}},{key:"getWholesalePrice",value:function(e,t){return"inclusive"===t.tax_type?e.incl_tax_wholesale_price:e.excl_tax_wholesale_price}},{key:"setHoldPopupEnabled",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._holdPopupEnabled=e}},{key:"getHoldPopupEnabled",value:function(){return this._holdPopupEnabled}},{key:"processInitialQueue",value:function(){return g(this,void 0,void 0,i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=i().keys(this._initialQueue);case 1:if((e.t1=e.t0()).done){e.next=14;break}return t=e.t1.value,e.prev=3,e.next=6,this._initialQueue[t]();case 6:e.sent,e.next=12;break;case 9:e.prev=9,e.t2=e.catch(3),o.kX.error(e.t2.message).subscribe();case 12:e.next=1;break;case 14:case"end":return e.stop()}}),e,this,[[3,9]])})))}},{key:"removeCoupon",value:function(e){var t=this.order.getValue(),n=t.coupons,r=n.indexOf(e);n.splice(r,1),t.coupons=n,this.order.next(t)}},{key:"pushCoupon",value:function(e){var t=this.order.getValue();t.coupons.forEach((function(t){if(t.code===e.code){var n=(0,u.__)("This coupon is already added to the cart");throw o.kX.error(n).subscribe(),n}})),t.coupons.push(e),this.order.next(t),this.refreshCart()}},{key:"header",get:function(){var e={buttons:{NsPosDashboardButton:w,NsPosPendingOrderButton:x,NsPosOrderTypeButton:k,NsPosCustomersButton:j,NsPosResetButton:P}};return"yes"===this.options.getValue().ns_pos_registers_enabled&&(e.buttons.NsPosCashRegister=C),o.kq.doAction("ns-pos-header",e),e}},{key:"defineOptions",value:function(e){this._options.next(e)}},{key:"defineCurrentScreen",value:function(){this._visibleSection.next(["xs","sm"].includes(this._responsive.is())?"grid":"both"),this._screen.next(this._responsive.is())}},{key:"changeVisibleSection",value:function(e){["both","cart","grid"].includes(e)&&(["cart","both"].includes(e)&&this.refreshCart(),this._visibleSection.next(e))}},{key:"addPayment",value:function(e){if(e.value>0){var t=this._order.getValue();return t.payments.push(e),this._order.next(t),this.computePaid()}return o.kX.error("Invalid amount.").subscribe()}},{key:"removePayment",value:function(e){if(void 0!==e.id)return o.kX.error("Unable to delete a payment attached to the order").subscribe();var t=this._order.getValue(),n=t.payments.indexOf(e);t.payments.splice(n,1),this._order.next(t),o.l.emit({identifier:"ns.pos.remove-payment",value:e}),this.updateCustomerAccount(e),this.computePaid()}},{key:"updateCustomerAccount",value:function(e){if("account-payment"===e.identifier){var t=this.order.getValue().customer;t.account_amount+=e.value,this.selectCustomer(t)}}},{key:"getNetPrice",value:function(e,t,n){return"inclusive"===n?e/(t+100)*100:"exclusive"===n?e/100*(t+100):void 0}},{key:"getVatValue",value:function(e,t,n){return"inclusive"===n?e-this.getNetPrice(e,t,n):"exclusive"===n?this.getNetPrice(e,t,n)-e:void 0}},{key:"computeTaxes",value:function(){var e=this;return new Promise((function(t,n){var r=e.order.getValue();if(void 0===(r=e.computeProductsTaxes(r)).tax_group_id||null===r.tax_group_id)return n(!1);var i=r.tax_groups;return i&&void 0!==i[r.tax_group_id]?(r.taxes=r.taxes.map((function(t){return t.tax_value=e.getVatValue(r.subtotal,t.rate,r.tax_type),t})),r=e.computeOrderTaxes(r),t({status:"success",data:{tax:i[r.tax_group_id],order:r}})):null!==r.tax_group_id&&r.tax_group_id.toString().length>0?void o.ih.get("/api/nexopos/v4/taxes/groups/".concat(r.tax_group_id)).subscribe({next:function(n){return r.tax_groups=r.tax_groups||[],r.taxes=n.taxes.map((function(t){return{tax_id:t.id,tax_name:t.name,rate:parseFloat(t.rate),tax_value:e.getVatValue(r.subtotal,t.rate,r.tax_type)}})),r.tax_groups[n.id]=n,r=e.computeOrderTaxes(r),t({status:"success",data:{tax:n,order:r}})},error:function(e){return n(e)}}):n({status:"failed",message:(0,u.__)("No tax group assigned to the order")})}))}},{key:"computeOrderTaxes",value:function(e){var t=this.options.getValue().ns_pos_vat;return["flat_vat","variable_vat","products_variable_vat"].includes(t)&&e.taxes&&e.taxes.length>0&&(e.tax_value+=e.taxes.map((function(e){return e.tax_value})).reduce((function(e,t){return e+t}))),e.tax_value+=e.product_taxes,e}},{key:"computeProductsTaxes",value:function(e){var t=this.products.getValue(),n=t.map((function(e){return e.tax_value}));e.product_taxes=0;var r=this.options.getValue().ns_pos_vat;return["products_vat","products_flat_vat","products_variable_vat"].includes(r)&&n.length>0&&(e.product_taxes+=n.reduce((function(e,t){return e+t}))),e.products=t,e.total_products=t.length,e}},{key:"canProceedAsLaidAway",value:function(e){var t=this;return new Promise((function(n,r){return g(t,void 0,void 0,i().mark((function t(){var s,o,c,l,d,p,f,v=this;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=e.customer.group.minimal_credit_payment,o=(e.total*s/100).toFixed(ns.currency.ns_currency_precision),o=parseFloat(o),t.prev=3,t.next=6,new Promise((function(t,n){a.G.show(q,{order:e,reject:n,resolve:t})}));case 6:if(!(0===(c=t.sent).instalments.length&&c.tendered<o)){t.next=13;break}return l=(0,u.__)("Before saving the order as laid away, a minimum payment of {amount} is required").replace("{amount}",h.default.filter("currency")(o)),a.G.show(O,{title:(0,u.__)("Unable to proceed"),message:l}),t.abrupt("return",r({status:"failed",message:l}));case 13:if(d=this.selectedPaymentType.getValue(),0!==(p=c.instalments.filter((function(e){return e.amount>=o&&_()(e.date).isSame(ns.date.moment.startOf("day"),"day")}))).length){t.next=17;break}return t.abrupt("return",n({status:"success",message:(0,u.__)("Layaway defined"),data:{order:c}}));case 17:f=p[0].amount,a.G.show(S,{title:(0,u.__)("Confirm Payment"),message:(0,u.__)('An instalment has been detected. Would you like to add as first payment {amount} for the selected payment type "{paymentType}"?').replace("{amount}",h.default.filter("currency")(f)).replace("{paymentType}",d.label),onAction:function(e){if(e){var t={identifier:d.identifier,label:d.label,value:f,readonly:!1,selected:!0};v.addPayment(t),p[0].paid=!0,n({status:"success",message:(0,u.__)("Layaway defined"),data:{order:c}})}else r({status:"failed",message:(0,u.__)("The request was canceled")})}});case 19:t.next=24;break;case 21:return t.prev=21,t.t0=t.catch(3),t.abrupt("return",r(t.t0));case 24:case"end":return t.stop()}}),t,this,[[3,21]])})))}))}},{key:"submitOrder",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(n,r){return g(e,void 0,void 0,i().mark((function e(){var s,a,c,l,d,p=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=Object.assign(Object.assign({},this.order.getValue()),t),a=s.customer.group.minimal_credit_payment,"hold"===s.payment_status){e.next=20;break}if(!(0===s.payments.length||s.total>s.tendered)){e.next=20;break}if("no"!==this.options.getValue().ns_orders_allow_partial){e.next=9;break}return c=(0,u.__)("Partially paid orders are disabled."),e.abrupt("return",r({status:"failed",message:c}));case 9:if(!(a>=0)){e.next=20;break}return e.prev=10,e.next=13,this.canProceedAsLaidAway(s);case 13:l=e.sent,s=l.data.order,e.next=20;break;case 17:return e.prev=17,e.t0=e.catch(10),e.abrupt("return",r(e.t0));case 20:if(this._isSubmitting){e.next=24;break}return d=void 0!==s.id?"put":"post",this._isSubmitting=!0,e.abrupt("return",o.ih[d]("/api/nexopos/v4/orders".concat(void 0!==s.id?"/"+s.id:""),s).subscribe({next:function(e){n(e),p.reset(),o.kq.doAction("ns-order-submit-successful",e),p._isSubmitting=!1;var t=p.options.getValue().ns_pos_complete_sale_audio;t.length>0&&new Audio(t).play()},error:function(e){p._isSubmitting=!1,r(e),o.kq.doAction("ns-order-submit-failed",e)}}));case 24:return e.abrupt("return",r({status:"failed",message:(0,u.__)("An order is currently being processed.")}));case 25:case"end":return e.stop()}}),e,this,[[10,17]])})))}))}},{key:"loadOrder",value:function(e){var t=this;return new Promise((function(n,r){o.ih.get("/api/nexopos/v4/orders/".concat(e,"/pos")).subscribe({next:function(e){return g(t,void 0,void 0,i().mark((function t(){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Object.assign(Object.assign({},this.defaultOrder()),e),r=e.products.map((function(e){return e.$original=function(){return e.product},e.$quantities=function(){return e.product.unit_quantities.filter((function(t){return+t.id==+e.unit_quantity_id}))[0]},e})),e.type=Object.values(this.types.getValue()).filter((function(t){return t.identifier===e.type}))[0],e.addresses={shipping:e.shipping_address,billing:e.billing_address},delete e.shipping_address,delete e.billing_address,this.buildOrder(e),this.buildProducts(r),t.next=10,this.selectCustomer(e.customer);case 10:n(e);case 11:case"end":return t.stop()}}),t,this)})))},error:function(e){return r(e)}})}))}},{key:"buildOrder",value:function(e){this.order.next(e)}},{key:"buildProducts",value:function(e){this.refreshProducts(e),this.products.next(e)}},{key:"printOrderReceipt",value:function(e){var t=this.options.getValue();if("disabled"===t.ns_pos_printing_enabled_for)return!1;if("all_orders"===t.ns_pos_printing_enabled_for)this.printOrder(e.id);else if("partially_paid_orders"===t.ns_pos_printing_enabled_for&&["paid","partially_paid"].includes(e.payment_status))this.printOrder(e.id);else{if("only_paid_ordes"!==t.ns_pos_printing_enabled_for||!["paid"].includes(e.payment_status))return!1;this.printOrder(e.id)}}},{key:"printOrder",value:function(e){var t=this.options.getValue();if("disabled"===t.ns_pos_printing_enabled_for)return!1;"default"===t.ns_pos_printing_gateway?this.processRegularPrinting(e):this.processCustomPrinting(e,t.ns_pos_printing_gateway)}},{key:"processCustomPrinting",value:function(e,t){o.kq.applyFilters("ns-order-custom-print",{printed:!1,order_id:e,gateway:t}).printed||o.kX.error((0,u.__)("Unsupported print gateway.")).subscribe()}},{key:"processRegularPrinting",value:function(e){var t=document.querySelector("printing-section");t&&t.remove();var n=document.createElement("iframe");n.id="printing-section",n.className="hidden",n.src=this.settings.getValue().urls.sale_printing_url.replace("{id}",e),document.body.appendChild(n)}},{key:"computePaid",value:function(){var e=this._order.getValue();e.tendered=0,e.payments.length>0&&(e.tendered=e.payments.map((function(e){return e.value})).reduce((function(e,t){return t+e}))),e.tendered>=e.total?e.payment_status="paid":e.tendered>0&&e.tendered<e.total&&(e.payment_status="partially_paid"),e.change=e.tendered-e.total,this._order.next(e)}},{key:"setPaymentActive",value:function(e){var t=this._paymentsType.getValue(),n=t.indexOf(e);t.forEach((function(e){return e.selected=!1})),t[n].selected=!0,this._paymentsType.next(t)}},{key:"definedPaymentsType",value:function(e){this._paymentsType.next(e)}},{key:"selectCustomer",value:function(e){var t=this;return new Promise((function(n,r){var i=t.order.getValue();if(i.customer=e,i.customer_id=e.id,t.order.next(i),void 0!==e.group&&null!==e.group)return n(i);o.ih.get("/api/nexopos/v4/customers/".concat(e.id,"/group")).subscribe({next:function(e){i.customer.group=e,t.order.next(i),n(i)},error:function(e){r(e)}})}))}},{key:"updateCart",value:function(e,t){for(var n in t)void 0!==t[n]&&h.default.set(e,n,t[n]);this.order.next(e),this.refreshCart()}},{key:"checkCart",value:function(){var e=this,t=this.order.getValue(),n=[];t.coupons.forEach((function(e){e.products.length>0&&(t.products.filter((function(t){return e.products.map((function(e){return e.product_id})).includes(t.product_id)})).length>0||-1!==n.indexOf(e)||n.push(e)),e.categories.length>0&&(t.products.filter((function(t){return e.categories.map((function(e){return e.category_id})).includes(t.$original().category_id)})).length>0||-1!==n.indexOf(e)||n.push(e))})),n.forEach((function(t){o.kX.error((0,u.__)('The coupons "%s" has been removed from the cart, as it\'s required conditions are no more meet.').replace("%s",t.name),(0,u.__)("Okay"),{duration:6e3}).subscribe(),e.removeCoupon(t)}))}},{key:"refreshCart",value:function(){return g(this,void 0,void 0,i().mark((function e(){var t,n,r,s,a,c,l,d,p;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkCart(),t=this.products.getValue(),n=this.order.getValue(),(r=t.map((function(e){return e.total_price}))).length>0?n.subtotal=r.reduce((function(e,t){return e+t})):n.subtotal=0,s=n.coupons.map((function(e){return"percentage_discount"===e.type?(e.value=n.subtotal*e.discount_value/100,e.value):(e.value=e.discount_value,e.value)})),n.total_coupons=0,s.length>0&&(n.total_coupons=s.reduce((function(e,t){return e+t}))),"percentage"===n.discount_type&&(n.discount=n.discount_percentage*n.subtotal/100),n.discount>n.subtotal&&0===n.total_coupons&&(n.discount=n.subtotal,o.kX.info("The discount has been set to the cart subtotal").subscribe()),n.tax_value=0,this.order.next(n),e.prev=12,e.next=15,this.computeTaxes();case 15:a=e.sent,n=a.data.order,e.next=22;break;case 19:e.prev=19,e.t0=e.catch(12),!1!==e.t0&&void 0!==e.t0.message&&o.kX.error(e.t0.message||(0,u.__)("An unexpected error has occured while fecthing taxes."),(0,u.__)("OKAY"),{duration:0}).subscribe();case 22:(c=t.map((function(e){return"inclusive"===e.tax_type?e.tax_value:0}))).length>0&&c.reduce((function(e,t){return e+t})),l=n.tax_type,d=this.options.getValue().ns_pos_vat,p=0,(["flat_vat","variable_vat"].includes(d)||["products_vat","products_flat_vat","products_variable_vat"].includes(d))&&(p=n.tax_value),n.total="exclusive"===l?+(n.subtotal+(n.shipping||0)+p-n.discount-n.total_coupons).toFixed(ns.currency.ns_currency_precision):+(n.subtotal+(n.shipping||0)-n.discount-n.total_coupons).toFixed(ns.currency.ns_currency_precision),this.order.next(n),o.kq.doAction("ns-cart-after-refreshed",n);case 32:case"end":return e.stop()}}),e,this,[[12,19]])})))}},{key:"getStockUsage",value:function(e,t){var n=this._products.getValue().filter((function(n){return n.product_id===e&&n.unit_quantity_id===t})).map((function(e){return e.quantity}));return n.length>0?n.reduce((function(e,t){return e+t})):0}},{key:"addToCart",value:function(e){return g(this,void 0,void 0,i().mark((function t(){var n,r,s,a,o,u,c;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=new Object,r={product_id:e.id||0,name:e.name,discount_type:"percentage",discount:0,discount_percentage:0,quantity:e.quantity||0,tax_group_id:e.tax_group_id,tax_type:e.tax_type||void 0,tax_value:0,unit_id:e.unit_id||0,unit_price:e.unit_price||0,unit_name:e.unit_name||"",total_price:0,mode:"normal",$original:e.$original||function(){return e},$quantities:e.$quantities||void 0},this._processingAddQueue=!0,0===r.product_id){t.next=22;break}t.t0=i().keys(this.addToCartQueue);case 5:if((t.t1=t.t0()).done){t.next=22;break}return s=t.t1.value,t.prev=7,a=new this.addToCartQueue[s](r),t.next=11,a.run(n);case 11:o=t.sent,n=Object.assign(Object.assign({},n),o),t.next=20;break;case 15:if(t.prev=15,t.t2=t.catch(7),!1!==t.t2){t.next=20;break}return this._processingAddQueue=!1,t.abrupt("return",!1);case 20:t.next=5;break;case 22:this._processingAddQueue=!1,r=Object.assign(Object.assign({},r),n),(u=this._products.getValue()).unshift(r),this.refreshProducts(u),this._products.next(u),(c=this.options.getValue().ns_pos_new_item_audio).length>0&&new Audio(c).play();case 30:case"end":return t.stop()}}),t,this,[[7,15]])})))}},{key:"defineTypes",value:function(e){this._types.next(e)}},{key:"removeProduct",value:function(e){var t=this._products.getValue(),n=t.indexOf(e);t.splice(n,1),this._products.next(t)}},{key:"updateProduct",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this._products.getValue();n=null===n?r.indexOf(e):n,h.default.set(r,n,Object.assign(Object.assign({},e),t)),this.refreshProducts(r),this._products.next(r)}},{key:"refreshProducts",value:function(e){var t=this;e.forEach((function(e){t.computeProduct(e)}))}},{key:"computeProductTax",value:function(e){switch(console.log(e.mode),e.mode){case"custom":return this.computeCustomProductTax(e);case"normal":return this.computeNormalProductTax(e);case"wholesale":return this.computeWholesaleProductTax(e);default:return e}}},{key:"proceedProductTaxComputation",value:function(e,t){var n=this,r=e.$original(),i=r.tax_group,s=0,a=0,o=0;if(void 0!==i.taxes){var u=0;i.taxes.length>0&&(u=i.taxes.map((function(e){return e.rate})).reduce((function(e,t){return e+t})));var c=this.getNetPrice(t,u,r.tax_type);switch(r.tax_type){case"inclusive":s=c,o=t;break;case"exclusive":s=t,o=c}var l=i.taxes.map((function(e){return n.getVatValue(t,e.rate,r.tax_type)}));l.length>0&&(a=l.reduce((function(e,t){return e+t})))}return{price_without_tax:s,tax_value:a,price_with_tax:o}}},{key:"computeCustomProductTax",value:function(e){e.$original();var t=e.$quantities(),n=this.proceedProductTaxComputation(e,t.custom_price_edit);return t.excl_tax_custom_price=n.price_without_tax,t.incl_tax_custom_price=n.price_with_tax,t.custom_price_tax=n.tax_value,e.$quantities=function(){return t},e}},{key:"computeNormalProductTax",value:function(e){e.$original();var t=e.$quantities(),n=this.proceedProductTaxComputation(e,t.sale_price_edit);return t.excl_tax_sale_price=n.price_without_tax,t.incl_tax_sale_price=n.price_with_tax,t.sale_price_tax=n.tax_value,e.$quantities=function(){return t},e}},{key:"computeWholesaleProductTax",value:function(e){e.$original();var t=e.$quantities(),n=this.proceedProductTaxComputation(e,t.wholesale_price_edit);return t.excl_tax_wholesale_price=n.price_without_tax,t.incl_tax_wholesale_price=n.price_with_tax,t.wholesale_price_tax=n.tax_value,e.$quantities=function(){return t},e}},{key:"computeProduct",value:function(e){"normal"===e.mode?(e.unit_price=this.getSalePrice(e.$quantities(),e.$original()),e.tax_value=e.$quantities().sale_price_tax*e.quantity):"wholesale"===e.mode&&(e.unit_price=this.getWholesalePrice(e.$quantities(),e.$original()),e.tax_value=e.$quantities().wholesale_price_tax*e.quantity),"custom"===e.mode&&(e.unit_price=this.getCustomPrice(e.$quantities(),e.$original()),e.tax_value=e.$quantities().custom_price_tax*e.quantity),["flat","percentage"].includes(e.discount_type)&&"percentage"===e.discount_type&&(e.discount=e.unit_price*e.discount_percentage/100*e.quantity),e.total_price=e.unit_price*e.quantity-e.discount,o.kq.doAction("ns-after-product-computed",e)}},{key:"loadCustomer",value:function(e){return o.ih.get("/api/nexopos/v4/customers/".concat(e))}},{key:"defineSettings",value:function(e){this._settings.next(e)}},{key:"voidOrder",value:function(e){var t=this;void 0!==e.id?["hold"].includes(e.payment_status)?a.G.show(S,{title:"Order Deletion",message:"The current order will be deleted as no payment has been made so far.",onAction:function(n){n&&o.ih.delete("/api/nexopos/v4/orders/".concat(e.id)).subscribe((function(e){o.kX.success(e.message).subscribe(),t.reset()}),(function(e){return o.kX.error(e.message).subscribe()}))}}):a.G.show($,{title:"Void The Order",message:"The current order will be void. This will cancel the transaction, but the order won't be deleted. Further details about the operation will be tracked on the report. Consider providing the reason of this operation.",onAction:function(n){!1!==n&&o.ih.post("/api/nexopos/v4/orders/".concat(e.id,"/void"),{reason:n}).subscribe({next:function(e){o.kX.success(e.message).subscribe(),t.reset()},error:function(e){return o.kX.error(e.message).subscribe()}})}}):o.kX.error("Unable to void an unpaid order.").subscribe()}},{key:"triggerOrderTypeSelection",value:function(e){return g(this,void 0,void 0,i().mark((function t(){var n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0;case 1:if(!(n<this.orderTypeQueue.length)){t.next=8;break}return t.next=4,this.orderTypeQueue[n].promise(e);case 4:t.sent;case 5:n++,t.next=1;break;case 8:case"end":return t.stop()}}),t,this)})))}},{key:"set",value:function(e,t){var n=this.settings.getValue();n[e]=t,this.settings.next(n)}},{key:"unset",value:function(e){var t=this.settings.getValue();delete t[e],this.settings.next(t)}},{key:"get",value:function(e){return this.settings.getValue()[e]}},{key:"destroy",value:function(){this._products.unsubscribe(),this._customers.unsubscribe(),this._types.unsubscribe(),this._breadcrumbs.unsubscribe(),this._paymentsType.unsubscribe(),this._screen.unsubscribe(),this._order.unsubscribe(),this._settings.unsubscribe()}}],n&&m(t.prototype,n),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();window.POS=new V,window.POSClass=V;window.POS},6700:(e,t,n)=>{var r={"./af":2786,"./af.js":2786,"./ar":867,"./ar-dz":4130,"./ar-dz.js":4130,"./ar-kw":6135,"./ar-kw.js":6135,"./ar-ly":6440,"./ar-ly.js":6440,"./ar-ma":7702,"./ar-ma.js":7702,"./ar-sa":6040,"./ar-sa.js":6040,"./ar-tn":7100,"./ar-tn.js":7100,"./ar.js":867,"./az":1083,"./az.js":1083,"./be":9808,"./be.js":9808,"./bg":8338,"./bg.js":8338,"./bm":7438,"./bm.js":7438,"./bn":8905,"./bn-bd":6225,"./bn-bd.js":6225,"./bn.js":8905,"./bo":1560,"./bo.js":1560,"./br":1278,"./br.js":1278,"./bs":622,"./bs.js":622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":877,"./cv.js":877,"./cy":7373,"./cy.js":7373,"./da":4780,"./da.js":4780,"./de":9740,"./de-at":217,"./de-at.js":217,"./de-ch":894,"./de-ch.js":894,"./de.js":9740,"./dv":5300,"./dv.js":5300,"./el":837,"./el.js":837,"./en-au":8348,"./en-au.js":8348,"./en-ca":7925,"./en-ca.js":7925,"./en-gb":2243,"./en-gb.js":2243,"./en-ie":6436,"./en-ie.js":6436,"./en-il":7207,"./en-il.js":7207,"./en-in":4175,"./en-in.js":4175,"./en-nz":6319,"./en-nz.js":6319,"./en-sg":1662,"./en-sg.js":1662,"./eo":2915,"./eo.js":2915,"./es":7093,"./es-do":5251,"./es-do.js":5251,"./es-mx":6112,"./es-mx.js":6112,"./es-us":1146,"./es-us.js":1146,"./es.js":7093,"./et":5603,"./et.js":5603,"./eu":7763,"./eu.js":7763,"./fa":6959,"./fa.js":6959,"./fi":1897,"./fi.js":1897,"./fil":2549,"./fil.js":2549,"./fo":4694,"./fo.js":4694,"./fr":4470,"./fr-ca":3049,"./fr-ca.js":3049,"./fr-ch":2330,"./fr-ch.js":2330,"./fr.js":4470,"./fy":4415,"./fy.js":4415,"./ga":9295,"./ga.js":9295,"./gd":2101,"./gd.js":2101,"./gl":8794,"./gl.js":8794,"./gom-deva":7884,"./gom-deva.js":7884,"./gom-latn":3168,"./gom-latn.js":3168,"./gu":5349,"./gu.js":5349,"./he":4206,"./he.js":4206,"./hi":94,"./hi.js":94,"./hr":316,"./hr.js":316,"./hu":2138,"./hu.js":2138,"./hy-am":1423,"./hy-am.js":1423,"./id":9218,"./id.js":9218,"./is":135,"./is.js":135,"./it":626,"./it-ch":150,"./it-ch.js":150,"./it.js":626,"./ja":9183,"./ja.js":9183,"./jv":4286,"./jv.js":4286,"./ka":2105,"./ka.js":2105,"./kk":7772,"./kk.js":7772,"./km":8758,"./km.js":8758,"./kn":9282,"./kn.js":9282,"./ko":3730,"./ko.js":3730,"./ku":1408,"./ku.js":1408,"./ky":3291,"./ky.js":3291,"./lb":6841,"./lb.js":6841,"./lo":5466,"./lo.js":5466,"./lt":7010,"./lt.js":7010,"./lv":7595,"./lv.js":7595,"./me":9861,"./me.js":9861,"./mi":5493,"./mi.js":5493,"./mk":5966,"./mk.js":5966,"./ml":7341,"./ml.js":7341,"./mn":5115,"./mn.js":5115,"./mr":370,"./mr.js":370,"./ms":9847,"./ms-my":1237,"./ms-my.js":1237,"./ms.js":9847,"./mt":2126,"./mt.js":2126,"./my":6165,"./my.js":6165,"./nb":4924,"./nb.js":4924,"./ne":6744,"./ne.js":6744,"./nl":3901,"./nl-be":9814,"./nl-be.js":9814,"./nl.js":3901,"./nn":3877,"./nn.js":3877,"./oc-lnc":2135,"./oc-lnc.js":2135,"./pa-in":5858,"./pa-in.js":5858,"./pl":4495,"./pl.js":4495,"./pt":9520,"./pt-br":7971,"./pt-br.js":7971,"./pt.js":9520,"./ro":6459,"./ro.js":6459,"./ru":238,"./ru.js":238,"./sd":950,"./sd.js":950,"./se":490,"./se.js":490,"./si":124,"./si.js":124,"./sk":4249,"./sk.js":4249,"./sl":4985,"./sl.js":4985,"./sq":1104,"./sq.js":1104,"./sr":9131,"./sr-cyrl":9915,"./sr-cyrl.js":9915,"./sr.js":9131,"./ss":5893,"./ss.js":5893,"./sv":8760,"./sv.js":8760,"./sw":1172,"./sw.js":1172,"./ta":7333,"./ta.js":7333,"./te":3110,"./te.js":3110,"./tet":2095,"./tet.js":2095,"./tg":7321,"./tg.js":7321,"./th":9041,"./th.js":9041,"./tk":9005,"./tk.js":9005,"./tl-ph":5768,"./tl-ph.js":5768,"./tlh":9444,"./tlh.js":9444,"./tr":2397,"./tr.js":2397,"./tzl":8254,"./tzl.js":8254,"./tzm":1106,"./tzm-latn":699,"./tzm-latn.js":699,"./tzm.js":1106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":7691,"./uk.js":7691,"./ur":3795,"./ur.js":3795,"./uz":6791,"./uz-latn":588,"./uz-latn.js":588,"./uz.js":6791,"./vi":5666,"./vi.js":5666,"./x-pseudo":4378,"./x-pseudo.js":4378,"./yo":5805,"./yo.js":5805,"./zh-cn":3839,"./zh-cn.js":3839,"./zh-hk":5726,"./zh-hk.js":5726,"./zh-mo":9807,"./zh-mo.js":9807,"./zh-tw":4152,"./zh-tw.js":4152};function i(e){var t=s(e);return n(t)}function s(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}i.keys=function(){return Object.keys(r)},i.resolve=s,e.exports=i,i.id=6700},2245:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>u});var r=n(9671),i=n(7389);function s(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const o={data:function(){return{finalValue:1,virtualStock:null,allSelected:!0,isLoading:!1,keys:[].concat(s([1,2,3].map((function(e){return{identifier:e,value:e}}))),s([4,5,6].map((function(e){return{identifier:e,value:e}}))),s([7,8,9].map((function(e){return{identifier:e,value:e}}))),[{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}])}},mounted:function(){var e=this;this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&(e.$popupParams.reject(!1),e.$popup.close())})),this.$popupParams.product.quantity&&(this.finalValue=this.$popupParams.product.quantity),document.addEventListener("keyup",this.handleKeyPress)},destroyed:function(){document.removeEventListener("keypress",this.handleKeyPress)},methods:{__:i.__,handleKeyPress:function(e){13===e.keyCode&&this.inputValue({identifier:"next"})},inputValue:function(e){if("next"===e.identifier){var t=this.$popupParams,n=t.product,s=t.data,a=parseFloat(this.finalValue);if(0===a)return r.kX.error((0,i.__)("Please provide a quantity")).subscribe();if("enabled"===n.$original().stock_management){var o=POS.getStockUsage(n.$original().id,s.unit_quantity_id)-(n.quantity||0);if(a>parseFloat(s.$quantities().quantity)-o)return r.kX.error((0,i.__)("Unable to add the product, there is not enough stock. Remaining %s").replace("%s",s.$quantities().quantity-o)).subscribe()}this.resolve({quantity:a})}else"backspace"===e.identifier?this.allSelected?(this.finalValue=0,this.allSelected=!1):(this.finalValue=this.finalValue.toString(),this.finalValue=this.finalValue.substr(0,this.finalValue.length-1)||0):this.allSelected?(this.finalValue=e.value,this.finalValue=parseFloat(this.finalValue),this.allSelected=!1):(this.finalValue+=""+e.value,this.finalValue=parseFloat(this.finalValue))},resolve:function(e){this.$popupParams.resolve(e),this.$popup.close()}}};const u=(0,n(1900).Z)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"bg-white shadow min-h-2/5-screen w-3/4-screen md:w-3/5-screen lg:w-2/5-screen xl:w-2/5-screen relative"},[e.isLoading?n("div",{staticClass:"flex w-full h-full absolute top-O left-0 items-center justify-center",staticStyle:{background:"rgb(202 202 202 / 49%)"},attrs:{id:"loading-overlay"}},[n("ns-spinner")],1):e._e(),e._v(" "),n("div",{staticClass:"flex-shrink-0 py-2 border-b border-gray-200"},[n("h1",{staticClass:"text-xl font-bold text-gray-700 text-center"},[e._v(e._s(e.__("Define Quantity")))])]),e._v(" "),n("div",{staticClass:"h-16 border-b bg-gray-800 text-white border-gray-200 flex items-center justify-center",attrs:{id:"screen"}},[n("h1",{staticClass:"font-bold text-3xl"},[e._v(e._s(e.finalValue))])]),e._v(" "),n("div",{staticClass:"grid grid-flow-row grid-cols-3 grid-rows-3",attrs:{id:"numpad"}},e._l(e.keys,(function(t,r){return n("div",{key:r,staticClass:"hover:bg-blue-400 hover:text-white hover:border-blue-600 text-xl font-bold border border-gray-200 h-24 flex items-center justify-center cursor-pointer",on:{click:function(n){return e.inputValue(t)}}},[void 0!==t.value?n("span",[e._v(e._s(t.value))]):e._e(),e._v(" "),t.icon?n("i",{staticClass:"las",class:t.icon}):e._e()])})),0)])}),[],!1,null,null,null).exports}},e=>{e.O(0,[8898],(()=>{return t=9188,e(e.s=t);var t}));e.O()}]);