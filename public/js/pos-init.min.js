(self.webpackChunkNexoPOS_4x=self.webpackChunkNexoPOS_4x||[]).push([[443,198,89,110,4],{9671:(e,t,s)=>{"use strict";s.d(t,{l:()=>X,kq:()=>Q,ih:()=>D,kX:()=>I});var n=s(6486),r=s(9669),i=s(2728),o=s(8345),a=s(9624),c=s(9248),u=s(230);function l(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._subject=new c.x}var t,s,n;return t=e,s=[{key:"defineClient",value:function(e){this._client=e}},{key:"post",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._request("post",e,t,s)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._request("get",e,void 0,t)}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._request("delete",e,void 0,t)}},{key:"put",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._request("put",e,t,s)}},{key:"response",get:function(){return this._lastRequestData}},{key:"_request",value:function(e,t){var s=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return t=Q.applyFilters("http-client-url",t.replace(/\/$/,"")),this._subject.next({identifier:"async.start",url:t,data:n}),new u.y((function(i){s._client[e](t,n,Object.assign(Object.assign({},s._client.defaults[e]),r)).then((function(e){s._lastRequestData=e,i.next(e.data),i.complete(),s._subject.next({identifier:"async.stop"})})).catch((function(e){var t;i.error((null===(t=e.response)||void 0===t?void 0:t.data)||e.response||e),s._subject.next({identifier:"async.stop"})}))}))}},{key:"subject",value:function(){return this._subject}},{key:"emit",value:function(e){var t=e.identifier,s=e.value;this._subject.next({identifier:t,value:s})}}],s&&l(t.prototype,s),n&&l(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),p=s(3);function f(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var _=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._subject=new p.t}var t,s,n;return t=e,(s=[{key:"subject",value:function(){return this._subject}},{key:"emit",value:function(e){var t=e.identifier,s=e.value;this._subject.next({identifier:t,value:s})}}])&&f(t.prototype,s),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),v=s(6515);function h(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var m=function(){function e(t){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state={},this.behaviorState=new v.X({}),this.behaviorState.subscribe((function(e){s.state=e})),this.setState(t)}var t,s,n;return t=e,(s=[{key:"setState",value:function(e){this.behaviorState.next(Object.assign(Object.assign({},this.state),{object:e}))}}])&&h(t.prototype,s),n&&h(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),b=s(2401),y=s(9614),x=s(381),g=s(2242),w=s(538),C=s(7266);function k(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var P=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=ns.base_url}var t,s,n;return t=e,(s=[{key:"get",value:function(e){return this.url+e}}])&&k(t.prototype,s),n&&k(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),j=w.default.filter("abbreviate",(function(e){var t=e;if(e>=1e3){for(var s,n=Math.floor((""+e).length/3),r=2;r>=1;r--){if(((s=parseFloat((0!=n?e/Math.pow(1e3,n):e).toPrecision(r)))+"").replace(/[^a-zA-Z 0-9]+/g,"").length<=2)break}s%1!=0&&(s=s.toFixed(1)),t=s+["","k","m","b","t"][n]}return t})),O=s(1356),S=s(9698);function $(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var T=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instances=new Object}var t,s,n;return t=e,(s=[{key:"getInstance",value:function(e){return this.instances[e]}},{key:"defineInstance",value:function(e,t){this.instances[e]=t}}])&&$(t.prototype,s),n&&$(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),V=s(2319),A=s(7389),E=s(6386),F=s(8603),q=s(4554);function Z(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var R=s(6606);window._=n,window.ChartJS=i,window.Pusher=R,window.Vue=w.default,window.moment=x,window.Axios=r,window.__=A.__,window.__m=A.c,window.VueRouter=o.Z,window.SnackBar=a.S,window.nsHooks=(0,V.Hu)(),window.popupResolver=E.Z,window.popupCloser=F.Z,window.Axios.defaults.headers.common["x-requested-with"]="XMLHttpRequest",window.Axios.defaults.withCredentials=!0,ns.websocket.enabled&&(window.Echo=new q.Z({broadcaster:"pusher",key:ns.websocket.key,wsHost:ns.websocket.host,wsPort:ns.websocket.port,wssPort:ns.websocket.port,namespace:"",forceTLS:ns.websocket.secured,disableStats:!0,encrypted:ns.websocket.secured,enabledTransports:ns.websocket.secured?["ws","wss"]:["ws"],disabledTransports:ns.websocket.secured?["sockjs","xhr_polling","xhr_streaming"]:[]}));var X=new _,D=new d,I=new a.S,N=new P,L=new T,Q=window.nsHooks,U=new(function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.breakpoint="",this.detectScreenSizes(),(0,b.R)(window,"resize").subscribe((function(e){return t.detectScreenSizes()}))}var t,s,n;return t=e,(s=[{key:"detectScreenSizes",value:function(){switch(!0){case window.outerWidth>0&&window.outerWidth<=480:this.breakpoint="xs";break;case window.outerWidth>480&&window.outerWidth<=640:this.breakpoint="sm";break;case window.outerWidth>640&&window.outerWidth<=1024:this.breakpoint="md";break;case window.outerWidth>1024&&window.outerWidth<=1280:this.breakpoint="lg";break;case window.outerWidth>1280:this.breakpoint="xl"}}}])&&Z(t.prototype,s),n&&Z(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()),z=new m({sidebar:["xs","sm","md"].includes(U.breakpoint)?"hidden":"visible"});D.defineClient(r),window.nsEvent=X,window.nsHttpClient=D,window.nsSnackBar=I,window.nsCurrency=O.W,window.nsTruncate=S.b,window.nsRawCurrency=O.f,window.nsAbbreviate=j,window.nsState=z,window.nsUrl=N,window.nsScreen=U,window.ChartJS=i,window.EventEmitter=_,window.Popup=g.G,window.RxJS=y,window.FormValidation=C.Z,window.nsCrudHandler=L},1356:(e,t,s)=>{"use strict";s.d(t,{W:()=>u,f:()=>l});var n=s(538),r=s(2077),i=s.n(r),o=s(6740),a=s.n(o),c=new Array(parseInt(ns.currency.ns_currency_precision)).fill("").map((function(e){return 0})).join(""),u=n.default.filter("currency",(function(e){var t,s,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"full";switch(ns.currency.ns_currency_prefered){case"iso":t=ns.currency.ns_currency_iso;break;case"symbol":t=ns.currency.ns_currency_symbol}if("full"===n){var r={decimal:ns.currency.ns_currency_decimal_separator,separator:ns.currency.ns_currency_thousand_separator,precision:parseInt(ns.currency.ns_currency_precision),symbol:""};s=a()(e,r).format()}else s=i()(e).format("0.0a");return"".concat("before"===ns.currency.ns_currency_position?t:"").concat(s).concat("after"===ns.currency.ns_currency_position?t:"")})),l=function(e){var t="0.".concat(c);return parseFloat(i()(e).format(t))}},9698:(e,t,s)=>{"use strict";s.d(t,{b:()=>n});var n=s(538).default.filter("truncate",(function(e,t){return e?(e=e.toString()).length>t?e.substring(0,t)+"...":e:""}))},7266:(e,t,s)=>{"use strict";function n(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}s.d(t,{Z:()=>r});var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,s,r;return t=e,s=[{key:"validateFields",value:function(e){var t=this;return 0===e.map((function(e){return t.checkField(e),e.errors?0===e.errors.length:0})).filter((function(e){return!1===e})).length}},{key:"validateFieldsErrors",value:function(e){var t=this;return e.map((function(e){return t.checkField(e),e.errors})).flat()}},{key:"validateForm",value:function(e){e.main&&this.validateField(e.main);var t=[];for(var s in e.tabs)if(e.tabs[s].fields){var n=[],r=this.validateFieldsErrors(e.tabs[s].fields);r.length>0&&n.push(r),e.tabs[s].errors=n.flat(),t.push(n.flat())}return t.flat().filter((function(e){return void 0!==e}))}},{key:"initializeTabs",value:function(e){var t=0;for(var s in e)0===t&&(e[s].active=!0),e[s].active=void 0!==e[s].active&&e[s].active,e[s].fields=this.createFields(e[s].fields),t++;return e}},{key:"validateField",value:function(e){return this.checkField(e)}},{key:"fieldsValid",value:function(e){return!(e.map((function(e){return e.errors&&e.errors.length>0})).filter((function(e){return e})).length>0)}},{key:"createFields",value:function(e){return e.map((function(t){if(t.type=t.type||"text",t.errors=t.errors||[],t.disabled=t.disabled||!1,"custom"===t.type&&"string"==typeof t.component){var s=t.component;if(t.component=nsExtraComponents[t.component],!t.component)throw'Failed to load a custom component. "'.concat(s,'" is not provided as an extra component. More details here: https://my.nexopos.com/en/documentation/developpers-guides/how-to-register-a-custom-vue-component');t.component.$field=t,t.component.$fields=e}return t}))}},{key:"createForm",value:function(e){if(e.main&&(e.main=this.createFields([e.main])[0]),e.tabs)for(var t in e.tabs)e.tabs[t].errors=[],void 0!==e.tabs[t].fields?e.tabs[t].fields=this.createFields(e.tabs[t].fields):console.info('Warning: The tab "'.concat(e.tabs[t].label,'" is missing fields. Fallback on checking dynamic component instead.'));return e}},{key:"enableFields",value:function(e){return e.map((function(e){return e.disabled=!1}))}},{key:"disableFields",value:function(e){return e.map((function(e){return e.disabled=!0}))}},{key:"disableForm",value:function(e){for(var t in e.main&&(e.main.disabled=!0),e.tabs)e.tabs[t].fields.forEach((function(e){return e.disabled=!0}))}},{key:"enableForm",value:function(e){for(var t in e.main&&(e.main.disabled=!1),e.tabs)e.tabs[t].fields.forEach((function(e){return e.disabled=!1}))}},{key:"getValue",value:function(e){var t={};return e.forEach((function(e){t[e.name]=e.value})),t}},{key:"checkField",value:function(e){var t=this;return void 0!==e.validation&&(e.errors=[],this.detectValidationRules(e.validation).forEach((function(s){t.fieldPassCheck(e,s)}))),e}},{key:"extractForm",value:function(e){var t={};if(e.main&&(t[e.main.name]=e.main.value),e.tabs)for(var s in e.tabs)void 0===t[s]&&(t[s]={}),t[s]=this.extractFields(e.tabs[s].fields);return t}},{key:"extractFields",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.forEach((function(e){t[e.name]=e.value})),t}},{key:"detectValidationRules",value:function(e){var t=function(e){var t;return["email","required"].includes(e)?{identifier:e}:(t=/(min)\:([0-9])+/g.exec(e))||(t=/(max)\:([0-9])+/g.exec(e))?{identifier:t[1],value:t[2]}:e};return Array.isArray(e)?e.filter((function(e){return"string"==typeof e})).map(t):e.split("|").map(t)}},{key:"triggerError",value:function(e,t){if(t.errors){var s=function(s){var n=s.split(".").filter((function(e){return!/^\d+$/.test(e)}));2===n.length&&e.tabs[n[0]].fields.forEach((function(e){e.name===n[1]&&t.errors[s].forEach((function(t){var s={identifier:"invalid",invalid:!0,message:t,name:e.name};e.errors.push(s)}))})),s===e.main.name&&t.errors[s].forEach((function(t){e.main.errors.push({identifier:"invalid",invalid:!0,message:t,name:e.main.name})}))};for(var n in t.errors)s(n)}}},{key:"triggerFieldsErrors",value:function(e,t){if(t&&t.errors){var s=function(s){e.forEach((function(e){e.name===s&&t.errors[s].forEach((function(t){var s={identifier:"invalid",invalid:!0,message:t,name:e.name};e.errors.push(s)}))}))};for(var n in t.errors)s(n)}}},{key:"fieldPassCheck",value:function(e,t){if("required"===t.identifier){if(void 0===e.value||null===e.value||0===e.value.length)return e.errors.push({identifier:t.identifier,invalid:!0,name:e.name});e.errors.forEach((function(s,n){s.identifier===t.identifier&&!0===s.invalid&&e.errors.splice(n,1)}))}if("email"===t.identifier&&e.value.length>0){if(!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,4})+$/.test(e.value))return e.errors.push({identifier:t.identifier,invalid:!0,name:e.name});e.errors.forEach((function(s,n){!0===s[t.identifier]&&e.errors.splice(n,1)}))}return e}}],s&&n(t.prototype,s),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},7389:(e,t,s)=>{"use strict";s.d(t,{__:()=>n,c:()=>r});var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"NexoPOS";return nsLanguage.getEntries(t)&&nsLanguage.getEntries(t)[e]||e},r=function(e,t){return nsLanguage.getEntries(t)&&nsLanguage.getEntries(t)[e]||e}},8603:(e,t,s)=>{"use strict";function n(){var e=this;Object.keys(this).includes("$popup")&&this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&(e.$popupParams&&void 0!==e.$popupParams.reject&&e.$popupParams.reject(!1),e.$popup.close()),"press-esc"===t.event&&(e.$popupParams&&void 0!==e.$popupParams.reject&&e.$popupParams.reject(!1),e.$popup.close())}))}s.d(t,{Z:()=>n})},6386:(e,t,s)=>{"use strict";function n(e){void 0!==this.$popupParams.resolve&&this.$popupParams.reject&&(!1!==e?this.$popupParams.resolve(e):this.$popupParams.reject(e)),this.$popup.close()}s.d(t,{Z:()=>n})},2242:(e,t,s)=>{"use strict";s.d(t,{G:()=>u});var n=s(7757),r=s.n(n),i=s(9248);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(e,t,s,n){return new(s||(s=Promise))((function(r,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(o(this,e),this.config={primarySelector:void 0,popupClass:"shadow-lg h-half w-1/2 bg-white"},this.container=document.createElement("div"),this.popupBody=document.createElement("div"),this.config=Object.assign(this.config,t),void 0===this.config.primarySelector&&document.querySelectorAll(".is-popup").length>0){var s=document.querySelectorAll(".is-popup").length;this.parentWrapper=document.querySelectorAll(".is-popup")[s-1]}else this.parentWrapper=document.querySelector("body").querySelectorAll("div")[0];this.event=new i.x}var t,s,n;return t=e,s=[{key:"open",value:function(e){var t,s,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c(this,void 0,void 0,r().mark((function o(){var a,c,u=this;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("function"!=typeof e){r.next=9;break}return r.prev=1,r.next=4,e();case 4:e=r.sent.default,r.next=9;break;case 7:r.prev=7,r.t0=r.catch(1);case 9:a=document.querySelector("body").querySelectorAll("div")[0],this.parentWrapper.style.filter="blur(4px)",a.style.filter="blur(6px)",this.container.setAttribute("class","absolute top-0 left-0 w-full h-full flex items-center justify-center is-popup"),this.container.addEventListener("click",(function(e){u.event.next({event:"click-overlay",value:!0}),e.stopPropagation()})),this.popupBody.addEventListener("click",(function(e){e.stopImmediatePropagation()})),this.container.id="popup-container-"+document.querySelectorAll(".is-popup").length,this.popupBody.setAttribute("class"," zoom-out-entrance"),this.popupBody.innerHTML='<div class="popup-body"></div>',this.container.appendChild(this.popupBody),document.body.appendChild(this.container),c=Vue.extend(e),this.instance=new c({propsData:{popup:this}}),this.instance.template=(null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.template)||void 0,this.instance.render=e.render||void 0,this.instance.methods=(null===(s=null==e?void 0:e.options)||void 0===s?void 0:s.methods)||(null==e?void 0:e.methods),this.instance.data=(null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.data)||(null==e?void 0:e.data),this.instance.$popup=this,this.instance.$popupParams=i,this.instance.$mount("#".concat(this.container.id," .popup-body"));case 29:case"end":return r.stop()}}),o,this,[[1,7]])})))}},{key:"close",value:function(){var e=this;this.instance.$destroy(),this.event.unsubscribe(),this.parentWrapper.style.filter="blur(0px)";var t=document.querySelector("body").querySelectorAll("div")[0];document.querySelectorAll(".is-popup").length<=1&&(t.style.filter="blur(0px)"),this.popupBody.classList.remove("zoom-out-entrance"),this.popupBody.classList.add("zoom-in-exit"),this.container.classList.remove("is-popup"),setTimeout((function(){e.container.remove()}),300)}}],n=[{key:"show",value:function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new e(n);return r.open(t,s),r}}],s&&a(t.prototype,s),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},1703:(e,t,s)=>{"use strict";function n(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}s.d(t,{Z:()=>r});var r=function(){function e(t){var s=t.settings,n=t.options,r=t.type;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.printingURL={refund:"refund_printing_url",sale:"sale_printing_url",payment:"payment_printing_url"},this.settings=s,this.options=n,this.type=r||"refund"}var t,s,r;return t=e,(s=[{key:"processRegularPrinting",value:function(e){var t=document.querySelector("printing-section");t&&t.remove();var s=this.settings[this.printingURL[this.type]].replace("{reference_id}",e),n=document.createElement("iframe");n.id="printing-section",n.className="hidden",n.src=s,document.body.appendChild(n),setTimeout((function(){document.querySelector("#printing-section").remove()}),5e3)}},{key:"printOrder",value:function(e){"default"===this.options.ns_pos_printing_gateway?this.processRegularPrinting(e):this.processCustomPrinting(e,this.options.ns_pos_printing_gateway)}},{key:"processCustomPrinting",value:function(e,t){nsHooks.applyFilters("ns-order-custom-refund-print",{printed:!1,reference_id:e,gateway:t}).printed||nsSnackBar.error(__("Unsupported print gateway.")).subscribe()}}])&&n(t.prototype,s),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},9624:(e,t,s)=>{"use strict";s.d(t,{S:()=>i});var n=s(3260);function r(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),void 0===window.snackbarQueue&&(window.snackbarQueue=[],this.queue=window.snackbarQueue)}var t,s,i;return t=e,s=[{key:"show",value:function(e,t){var s=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{duration:3e3,type:"info"};return n.Observable.create((function(n){var i=s.__createSnack({message:e,label:t,type:r.type}),o=i.buttonNode,a=(i.textNode,i.snackWrapper,i.sampleSnack);o.addEventListener("click",(function(e){n.onNext(o),n.onCompleted(),a.remove()})),s.__startTimer(r.duration,a)}))}},{key:"error",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{duration:3e3,type:"error"};return this.show(e,t,Object.assign(Object.assign({},s),{type:"error"}))}},{key:"success",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{duration:3e3,type:"success"};return this.show(e,t,Object.assign(Object.assign({},s),{type:"success"}))}},{key:"info",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{duration:3e3,type:"info"};return this.show(e,t,Object.assign(Object.assign({},s),{type:"info"}))}},{key:"__startTimer",value:function(e,t){var s,n=function(){e>0&&!1!==e&&(s=setTimeout((function(){t.remove()}),e))};t.addEventListener("mouseenter",(function(){clearTimeout(s)})),t.addEventListener("mouseleave",(function(){n()})),n()}},{key:"__createSnack",value:function(e){var t=e.message,s=e.label,n=e.type,r=void 0===n?"info":n,i=document.getElementById("snack-wrapper")||document.createElement("div"),o=document.createElement("div"),a=document.createElement("p"),c=document.createElement("div"),u=document.createElement("button"),l="",d="";switch(r){case"info":l="",d="info";break;case"error":l="",d="error";break;case"success":l="",d="success"}return a.textContent=t,s&&(c.setAttribute("class","ns-button default"),u.textContent=s,u.setAttribute("class","px-3 py-2 shadow rounded uppercase ".concat(l)),c.appendChild(u)),o.appendChild(a),o.appendChild(c),o.setAttribute("class","md:rounded py-2 px-3 md:w-2/5 w-full z-10 md:my-2 shadow-lg flex justify-between items-center zoom-in-entrance anim-duration-300 ns-notice ".concat(d)),i.appendChild(o),null===document.getElementById("snack-wrapper")&&(i.setAttribute("id","snack-wrapper"),i.setAttribute("class","absolute bottom-0 w-full flex justify-between items-center flex-col"),document.body.appendChild(i)),{snackWrapper:i,sampleSnack:o,buttonsWrapper:c,buttonNode:u,textNode:a}}}],s&&r(t.prototype,s),i&&r(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}()},279:(e,t,s)=>{"use strict";s.d(t,{$:()=>c});var n=s(9671),r=s(7389),i=s(2242),o=s(567);function a(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.product=t}var t,s,c;return t=e,(s=[{key:"run",value:function(e){var t=this;return new Promise((function(s,a){var c=new i.G({popupClass:"shadow-lg h-1/2-screen w-3/4 md:w-1/2 lg:w-2/5 xl:w-1/4 bg-white"}),u=t.product;if(!1===POS.options.getValue().ns_pos_show_quantity&&POS.processingAddQueue){if("enabled"===u.$original().stock_management){var l=POS.getStockUsage(u.$original().id,e.unit_quantity_id)-(u.quantity||0);if(1>parseFloat(e.$quantities().quantity)-l)return n.kX.error((0,r.__)("Unable to add the product, there is not enough stock. Remaining %s").replace("%s",(e.$quantities().quantity-l).toString())).subscribe()}s({quantity:1})}else c.open(o.Z,{resolve:s,reject:a,product:u,data:e})}))}}])&&a(t.prototype,s),c&&a(t,c),Object.defineProperty(t,"prototype",{writable:!1}),e}()},6985:(e,t,s)=>{"use strict";var n=s(7757),r=s.n(n),i=s(279),o=s(2242),a=s(9671),c=s(7389);const u={data:function(){return{unitsQuantities:[],loadsUnits:!1,options:null,optionsSubscriber:null}},beforeDestroy:function(){this.optionsSubscriber.unsubscribe()},mounted:function(){var e=this;this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&(e.$popupParams.reject(!1),e.$popup.close())})),this.optionsSubscriber=POS.options.subscribe((function(t){e.options=t})),void 0!==this.$popupParams.product.$original().selectedUnitQuantity?this.selectUnit(this.$popupParams.product.$original().selectedUnitQuantity):void 0!==this.$popupParams.product.$original().unit_quantities&&1===this.$popupParams.product.$original().unit_quantities.length?this.selectUnit(this.$popupParams.product.$original().unit_quantities[0]):(this.loadsUnits=!0,this.loadUnits())},methods:{__:c.__,displayRightPrice:function(e){return POS.getSalePrice(e,this.$popupParams.product.$original())},loadUnits:function(){var e=this;a.ih.get("/api/nexopos/v4/products/".concat(this.$popupParams.product.$original().id,"/units/quantities")).subscribe((function(t){if(0===t.length)return e.$popup.close(),a.kX.error((0,c.__)("This product doesn't have any unit defined for selling.")).subscribe();e.unitsQuantities=t,1===e.unitsQuantities.length&&e.selectUnit(e.unitsQuantities[0])}))},selectUnit:function(e){this.$popupParams.resolve({unit_quantity_id:e.id,unit_name:e.unit.name,$quantities:function(){return e}}),this.$popup.close()}}};const l=(0,s(1900).Z)(u,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"h-full w-full flex items-center justify-center",attrs:{id:"ns-units-selector"}},[e.unitsQuantities.length>0?s("div",{staticClass:"ns-box w-2/3-screen lg:w-1/3-screen overflow-hidden flex flex-col"},[s("div",{staticClass:"h-16 flex justify-center items-center flex-shrink-0",attrs:{id:"header"}},[s("h3",{staticClass:"font-bold text-primary"},[e._v(e._s(e.__("Choose Selling Unit")))])]),e._v(" "),e.unitsQuantities.length>0?s("div",{staticClass:"grid grid-flow-row grid-cols-2 overflow-y-auto"},e._l(e.unitsQuantities,(function(t){return s("div",{key:t.id,staticClass:"ns-numpad-key info cursor-pointer border flex-shrink-0 flex flex-col items-center justify-center",on:{click:function(s){return e.selectUnit(t)}}},[s("div",{staticClass:"h-40 w-full flex items-center justify-center overflow-hidden"},[t.preview_url?s("img",{staticClass:"object-cover h-full",attrs:{src:t.preview_url,alt:t.unit.name}}):e._e(),e._v(" "),t.preview_url?e._e():s("div",{staticClass:"h-40 flex items-center justify-center"},[s("i",{staticClass:"las la-image text-primary text-6xl"})])]),e._v(" "),s("div",{staticClass:"h-0 w-full"},[s("div",{staticClass:"relative w-full flex items-center justify-center -top-10 h-20 py-2 flex-col overlay"},[s("h3",{staticClass:"font-bold text-primary py-2 text-center"},[e._v(e._s(t.unit.name)+" ("+e._s(t.quantity)+")")]),e._v(" "),s("p",{staticClass:"text-sm font-medium text-primary"},[e._v(e._s(e._f("currency")(e.displayRightPrice(t))))])])])])})),0):e._e()]):e._e(),e._v(" "),0===e.unitsQuantities.length?s("div",{staticClass:"h-56 flex items-center justify-center"},[s("ns-spinner")],1):e._e()])}),[],!1,null,null,null).exports;function d(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.product=t}var t,s,n;return t=e,(s=[{key:"run",value:function(){var e=this;return new Promise((function(t,s){var n=new o.G({popupClass:"shadow-lg h-1/2-screen w-3/4 xl:w-1/4 bg-white"}),r=e.product;n.open(l,{resolve:t,reject:s,product:r})}))}}])&&d(t.prototype,s),n&&d(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),f=s(6515),_=s(538);function v(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.detect()}var t,s,n;return t=e,(s=[{key:"detect",value:function(){window.innerWidth<544?this.screenIs="xs":window.innerWidth>=544&&window.innerWidth<768?this.screenIs="sm":window.innerWidth>=768&&window.innerWidth<992?this.screenIs="md":window.innerWidth>=992&&window.innerWidth<1200?this.screenIs="lg":window.innerWidth>=1200&&(this.screenIs="xl")}},{key:"is",value:function(e){return void 0===e?this.screenIs:this.screenIs===e}}])&&v(t.prototype,s),n&&v(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),m=s(381),b=s.n(m);function y(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var x=function(e,t,s,n){return new(s||(s=Promise))((function(r,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},g=window.NsPosDashboardButton=s(227).Z,w=window.NsPosPendingOrderButton=s(6845).Z,C=window.NsPosOrderTypeButton=s(9597).Z,k=window.NsPosCustomersButton=s(6194).Z,P=window.NsPosResetButton=s(8149).Z,j=window.NsPosCashRegister=s(8507).Z,O=window.NsAlertPopup=s(9110).default,S=window.NsConfirmPopup=s(2833).default,$=(window.NsPOSLoadingPopup=s(2004).default,window.NsPromptPopup=s(9089).default),T=window.NsLayawayPopup=s(6689).Z,V=window.NsLayawayPopup=s(9702).Z,A=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._orderTypeProcessQueue=[],this._holdPopupEnabled=!0,this._initialQueue=[],this._responsive=new h,this._isSubmitting=!1,this._processingAddQueue=!1,this.defaultOrder=function(){return{discount_type:null,title:"",discount:0,register_id:t.get("register")?t.get("register").id:void 0,discount_percentage:0,subtotal:0,total:0,coupons:[],total_coupons:0,tendered:0,note:"",note_visibility:"hidden",tax_group_id:void 0,tax_type:void 0,taxes:[],tax_groups:[],payment_status:void 0,customer_id:void 0,change:0,total_products:0,shipping:0,tax_value:0,product_taxes:0,shipping_rate:0,shipping_type:void 0,customer:void 0,type:void 0,products:[],instalments:[],payments:[],addresses:{shipping:void 0,billing:void 0}}},this.addToCartQueue=[p,i.$],this.initialize()}var t,s,n;return t=e,s=[{key:"screen",get:function(){return this._screen}},{key:"visibleSection",get:function(){return this._visibleSection}},{key:"paymentsType",get:function(){return this._paymentsType}},{key:"selectedPaymentType",get:function(){return this._selectedPaymentType}},{key:"order",get:function(){return this._order}},{key:"types",get:function(){return this._types}},{key:"products",get:function(){return this._products}},{key:"customers",get:function(){return this._customers}},{key:"options",get:function(){return this._options}},{key:"orderTypeQueue",get:function(){return this._orderTypeProcessQueue}},{key:"settings",get:function(){return this._settings}},{key:"breadcrumbs",get:function(){return this._breadcrumbs}},{key:"initialQueue",get:function(){return this._initialQueue}},{key:"responsive",get:function(){return this._responsive}},{key:"processingAddQueue",get:function(){return this._processingAddQueue}},{key:"reset",value:function(){this._isSubmitting=!1,this.order.next(this.defaultOrder()),this._products.next([]),this._customers.next([]),this._breadcrumbs.next([]),this.defineCurrentScreen(),this.setHoldPopupEnabled(!0),this.processInitialQueue(),this.refreshCart()}},{key:"initialize",value:function(){var e=this;this._products=new f.X([]),this._customers=new f.X([]),this._types=new f.X([]),this._breadcrumbs=new f.X([]),this._screen=new f.X(""),this._paymentsType=new f.X([]),this._visibleSection=new f.X("both"),this._options=new f.X({}),this._settings=new f.X({}),this._order=new f.X(this.defaultOrder()),this._selectedPaymentType=new f.X(null),this._orderTypeProcessQueue=[{identifier:"handle.delivery-order",promise:function(e){return new Promise((function(t,s){return e&&"delivery"===e.identifier?o.G.show(V,{resolve:t,reject:s}):t({status:"success",message:"Proceed"})}))}}],this.initialQueue.push((function(){return new Promise((function(t,s){var n=e.options.getValue(),r=e.order.getValue();return!1!==n.ns_pos_tax_group&&(r.tax_group_id=n.ns_pos_tax_group,r.tax_type=n.ns_pos_tax_type,e.order.next(r)),t({status:"success",message:"tax group assignated"})}))})),this.initialQueue.push((function(){return new Promise((function(t,s){var n=e.options.getValue();return e.order.getValue(),!1!==n.ns_customers_default&&a.ih.get("/api/nexopos/v4/customers/".concat(n.ns_customers_default)).subscribe({next:function(s){e.selectCustomer(s),t({status:"success",message:(0,c.__)("The customer has been loaded")})},error:function(e){a.kX.error((0,c.__)("Unable to select the default customer. Looks like the customer no longer exists. Consider changing the default customer on the settings."),(0,c.__)("OKAY"),{duration:0}).subscribe(),s(e)}}),t({status:"success",message:"tax group assignated"})}))})),this.products.subscribe((function(t){e.refreshCart()})),this.types.subscribe((function(t){var s=Object.values(t).filter((function(e){return e.selected}));if(s.length>0){var n=e.order.getValue();n.type=s[0],e.order.next(n)}})),window.addEventListener("resize",(function(){e._responsive.detect(),e.defineCurrentScreen()})),window.onbeforeunload=function(){if(e.products.getValue().length>0)return(0,c.__)("Some products has been added to the cart. Would youl ike to discard this order ?")},this.defineCurrentScreen()}},{key:"getSalePrice",value:function(e,t){return"inclusive"===t.tax_type?e.incl_tax_sale_price:e.excl_tax_sale_price}},{key:"getCustomPrice",value:function(e,t){return"inclusive"===t.tax_type?e.incl_tax_custom_price:e.excl_tax_custom_price}},{key:"getWholesalePrice",value:function(e,t){return"inclusive"===t.tax_type?e.incl_tax_wholesale_price:e.excl_tax_wholesale_price}},{key:"setHoldPopupEnabled",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._holdPopupEnabled=e}},{key:"getHoldPopupEnabled",value:function(){return this._holdPopupEnabled}},{key:"processInitialQueue",value:function(){return x(this,void 0,void 0,r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r().keys(this._initialQueue);case 1:if((e.t1=e.t0()).done){e.next=14;break}return t=e.t1.value,e.prev=3,e.next=6,this._initialQueue[t]();case 6:e.sent,e.next=12;break;case 9:e.prev=9,e.t2=e.catch(3),a.kX.error(e.t2.message).subscribe();case 12:e.next=1;break;case 14:case"end":return e.stop()}}),e,this,[[3,9]])})))}},{key:"removeCoupon",value:function(e){var t=this.order.getValue(),s=t.coupons,n=s.indexOf(e);s.splice(n,1),t.coupons=s,this.order.next(t)}},{key:"pushCoupon",value:function(e){var t=this.order.getValue();t.coupons.forEach((function(t){if(t.code===e.code){var s=(0,c.__)("This coupon is already added to the cart");throw a.kX.error(s).subscribe(),s}})),t.coupons.push(e),this.order.next(t),this.refreshCart()}},{key:"header",get:function(){var e={buttons:{NsPosDashboardButton:g,NsPosPendingOrderButton:w,NsPosOrderTypeButton:C,NsPosCustomersButton:k,NsPosResetButton:P}};return"yes"===this.options.getValue().ns_pos_registers_enabled&&(e.buttons.NsPosCashRegister=j),a.kq.doAction("ns-pos-header",e),e}},{key:"defineOptions",value:function(e){this._options.next(e)}},{key:"defineCurrentScreen",value:function(){this._visibleSection.next(["xs","sm"].includes(this._responsive.is())?"grid":"both"),this._screen.next(this._responsive.is())}},{key:"changeVisibleSection",value:function(e){["both","cart","grid"].includes(e)&&(["cart","both"].includes(e)&&this.refreshCart(),this._visibleSection.next(e))}},{key:"addPayment",value:function(e){if(e.value>0){var t=this._order.getValue();return t.payments.push(e),this._order.next(t),this.computePaid()}return a.kX.error("Invalid amount.").subscribe()}},{key:"removePayment",value:function(e){if(void 0!==e.id)return a.kX.error((0,c.__)("Unable to delete a payment attached to the order.")).subscribe();var t=this._order.getValue(),s=t.payments.indexOf(e);t.payments.splice(s,1),this._order.next(t),a.l.emit({identifier:"ns.pos.remove-payment",value:e}),this.updateCustomerAccount(e),this.computePaid()}},{key:"updateCustomerAccount",value:function(e){if("account-payment"===e.identifier){var t=this.order.getValue().customer;t.account_amount+=e.value,this.selectCustomer(t)}}},{key:"getNetPrice",value:function(e,t,s){return"inclusive"===s?e/(t+100)*100:"exclusive"===s?e/100*(t+100):void 0}},{key:"getVatValue",value:function(e,t,s){return"inclusive"===s?e-this.getNetPrice(e,t,s):"exclusive"===s?this.getNetPrice(e,t,s)-e:void 0}},{key:"computeTaxes",value:function(){var e=this;return new Promise((function(t,s){var n=e.order.getValue();if(void 0===(n=e.computeProductsTaxes(n)).tax_group_id||null===n.tax_group_id)return s(!1);var r=n.tax_groups;return r&&void 0!==r[n.tax_group_id]?(n.taxes=r[n.tax_group_id].taxes.map((function(t){return t.tax_value=e.getVatValue(n.subtotal,t.rate,n.tax_type),t})),n=e.computeOrderTaxes(n),t({status:"success",data:{tax:r[n.tax_group_id],order:n}})):null!==n.tax_group_id&&n.tax_group_id.toString().length>0?void a.ih.get("/api/nexopos/v4/taxes/groups/".concat(n.tax_group_id)).subscribe({next:function(s){return s.taxes=s.taxes.map((function(t){return{tax_id:t.id,tax_name:t.name,rate:parseFloat(t.rate),tax_value:e.getVatValue(n.subtotal,t.rate,n.tax_type)}})),n.tax_groups=n.tax_groups||[],n.taxes=s.taxes,n.tax_groups[s.id]=s,n=e.computeOrderTaxes(n),t({status:"success",data:{tax:s,order:n}})},error:function(e){return s(e)}}):s({status:"failed",message:(0,c.__)("No tax group assigned to the order")})}))}},{key:"computeOrderTaxes",value:function(e){var t=this.options.getValue().ns_pos_vat;return["flat_vat","variable_vat","products_variable_vat"].includes(t)&&e.taxes&&e.taxes.length>0&&(e.tax_value+=e.taxes.map((function(e){return e.tax_value})).reduce((function(e,t){return e+t}))),e.tax_value+=e.product_taxes,e}},{key:"computeProductsTaxes",value:function(e){var t=this.products.getValue(),s=t.map((function(e){return e.tax_value}));e.product_taxes=0;var n=this.options.getValue().ns_pos_vat;return["products_vat","products_flat_vat","products_variable_vat"].includes(n)&&s.length>0&&(e.product_taxes+=s.reduce((function(e,t){return e+t}))),e.products=t,e.total_products=t.length,e}},{key:"canProceedAsLaidAway",value:function(e){var t=this;return new Promise((function(s,n){return x(t,void 0,void 0,r().mark((function t(){var i,a,u,l,d,p,f,v=this;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.customer.group.minimal_credit_payment,a=(e.total*i/100).toFixed(ns.currency.ns_currency_precision),a=parseFloat(a),t.prev=3,t.next=6,new Promise((function(t,s){o.G.show(T,{order:e,reject:s,resolve:t})}));case 6:if(!(0===(u=t.sent).instalments.length&&u.tendered<a)){t.next=13;break}return l=(0,c.__)("Before saving the order as laid away, a minimum payment of {amount} is required").replace("{amount}",_.default.filter("currency")(a)),o.G.show(O,{title:(0,c.__)("Unable to proceed"),message:l}),t.abrupt("return",n({status:"failed",message:l}));case 13:if(d=this.selectedPaymentType.getValue(),0!==(p=u.instalments.filter((function(e){return e.amount>=a&&b()(e.date).isSame(ns.date.moment.startOf("day"),"day")}))).length){t.next=17;break}return t.abrupt("return",s({status:"success",message:(0,c.__)("Layaway defined"),data:{order:u}}));case 17:f=p[0].amount,o.G.show(S,{title:(0,c.__)("Confirm Payment"),message:(0,c.__)('An instalment has been detected. Would you like to add as first payment {amount} for the selected payment type "{paymentType}"?').replace("{amount}",_.default.filter("currency")(f)).replace("{paymentType}",d.label),onAction:function(e){if(e){var t={identifier:d.identifier,label:d.label,value:f,readonly:!1,selected:!0};v.addPayment(t),p[0].paid=!0,s({status:"success",message:(0,c.__)("Layaway defined"),data:{order:u}})}else n({status:"failed",message:(0,c.__)("The request was canceled")})}});case 19:t.next=24;break;case 21:return t.prev=21,t.t0=t.catch(3),t.abrupt("return",n(t.t0));case 24:case"end":return t.stop()}}),t,this,[[3,21]])})))}))}},{key:"submitOrder",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(s,n){return x(e,void 0,void 0,r().mark((function e(){var i,o,u,l,d,p=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Object.assign(Object.assign({},this.order.getValue()),t),o=i.customer.group.minimal_credit_payment,"hold"===i.payment_status){e.next=20;break}if(!(0===i.payments.length&&i.total>0&&i.total>i.tendered)){e.next=20;break}if("no"!==this.options.getValue().ns_orders_allow_partial){e.next=9;break}return u=(0,c.__)("Partially paid orders are disabled."),e.abrupt("return",n({status:"failed",message:u}));case 9:if(!(o>=0)){e.next=20;break}return e.prev=10,e.next=13,this.canProceedAsLaidAway(i);case 13:l=e.sent,i=l.data.order,e.next=20;break;case 17:return e.prev=17,e.t0=e.catch(10),e.abrupt("return",n(e.t0));case 20:if(this._isSubmitting){e.next=24;break}return d=void 0!==i.id?"put":"post",this._isSubmitting=!0,e.abrupt("return",a.ih[d]("/api/nexopos/v4/orders".concat(void 0!==i.id?"/"+i.id:""),i).subscribe({next:function(e){s(e),p.reset(),a.kq.doAction("ns-order-submit-successful",e),p._isSubmitting=!1;var t=p.options.getValue().ns_pos_complete_sale_audio;t.length>0&&new Audio(t).play()},error:function(e){p._isSubmitting=!1,n(e),a.kq.doAction("ns-order-submit-failed",e)}}));case 24:return e.abrupt("return",n({status:"failed",message:(0,c.__)("An order is currently being processed.")}));case 25:case"end":return e.stop()}}),e,this,[[10,17]])})))}))}},{key:"defineQuantities",value:function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return new Promise((function(n,r){var i={unit:s.filter((function(t){return t.id===e.unit_id}))[0]||{},incl_tax_sale_price:parseFloat(e.unit_price),excl_tax_sale_price:parseFloat(e.unit_price),sale_price:parseFloat(e.unit_price),sale_price_tax:0,sale_price_edit:0,wholesale_price_tax:0,incl_tax_wholesale_price:0,excl_tax_wholesale_price:0,wholesale_price:0,wholesale_price_edit:0,custom_price_tax:0,custom_price:0,custom_price_edit:0,incl_tax_custom_price:0,excl_tax_custom_price:0};if(["inclusive","exclusive"].includes(e.tax_type))try{if(!e.tax_group_id)return i.sale_price_tax=0,i.wholesale_price_tax=0,i.excl_tax_sale_price=e.unit_price,n(i);a.ih.get("/api/nexopos/v4/taxes/groups/".concat(e.tax_group_id)).subscribe({next:function(s){return i.sale_price_tax=s.taxes.map((function(s){return t.getVatValue(i.sale_price,s.rate,e.tax_type)})).reduce((function(e,t){return e+t})),i.wholesale_price_tax=s.taxes.map((function(s){return t.getVatValue(i.wholesale_price,s.rate,e.tax_type)})).reduce((function(e,t){return e+t})),i.excl_tax_sale_price=i.sale_price+i.sale_price_tax,i.incl_tax_sale_price=i.sale_price-i.sale_price_tax,n(i)},error:function(e){r(!1)}})}catch(e){return a.kX.error((0,c.__)("An error has occured while computing the product.")).subscribe()}return n(i)}))}},{key:"loadOrder",value:function(e){var t=this;return new Promise((function(s,n){a.ih.get("/api/nexopos/v4/orders/".concat(e,"/pos")).subscribe({next:function(e){return x(t,void 0,void 0,r().mark((function t(){var n,i,o,a=this;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=Object.assign(Object.assign({},this.defaultOrder()),e),n=[],i=r().mark((function t(s){var i;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==(i=e.products[s]).product){t.next=9;break}return t.t0=i.name,t.t1=i.unit_id,t.next=6,a.defineQuantities(i);case 6:t.t2=t.sent,t.t3=[t.t2],i.product={mode:"custom",name:t.t0,unit_id:t.t1,unit_quantities:t.t3};case 9:i.$original=function(){return i.product},i.$quantities=function(){return i.product.unit_quantities.filter((function(e){return+e.id==+i.unit_quantity_id||void 0===e.id}))[0]},n.push(i);case 12:case"end":return t.stop()}}),t)})),o=0;case 4:if(!(o<e.products.length)){t.next=9;break}return t.delegateYield(i(o),"t0",6);case 6:o++,t.next=4;break;case 9:return e.type=Object.values(this.types.getValue()).filter((function(t){return t.identifier===e.type}))[0],e.addresses={shipping:e.shipping_address,billing:e.billing_address},delete e.shipping_address,delete e.billing_address,this.buildOrder(e),this.buildProducts(n),t.next=17,this.selectCustomer(e.customer);case 17:s(e);case 18:case"end":return t.stop()}}),t,this)})))},error:function(e){return n(e)}})}))}},{key:"buildOrder",value:function(e){this.order.next(e)}},{key:"buildProducts",value:function(e){this.refreshProducts(e),this.products.next(e)}},{key:"printOrderReceipt",value:function(e){var t=this.options.getValue();if("disabled"===t.ns_pos_printing_enabled_for)return!1;if("all_orders"===t.ns_pos_printing_enabled_for)this.printOrder(e.id);else if("partially_paid_orders"===t.ns_pos_printing_enabled_for&&["paid","partially_paid"].includes(e.payment_status))this.printOrder(e.id);else{if("only_paid_ordes"!==t.ns_pos_printing_enabled_for||!["paid"].includes(e.payment_status))return!1;this.printOrder(e.id)}}},{key:"printOrder",value:function(e){var t=this.options.getValue();if("disabled"===t.ns_pos_printing_enabled_for)return!1;"default"===t.ns_pos_printing_gateway?this.processRegularPrinting(e):this.processCustomPrinting(e,t.ns_pos_printing_gateway)}},{key:"processCustomPrinting",value:function(e,t){a.kq.applyFilters("ns-order-custom-print",{printed:!1,order_id:e,gateway:t}).printed||a.kX.error((0,c.__)("Unsupported print gateway.")).subscribe()}},{key:"processRegularPrinting",value:function(e){var t=document.querySelector("printing-section");t&&t.remove();var s=document.createElement("iframe");s.id="printing-section",s.className="hidden",s.src=this.settings.getValue().urls.sale_printing_url.replace("{id}",e),document.body.appendChild(s)}},{key:"computePaid",value:function(){var e=this._order.getValue();e.tendered=0,e.payments.length>0&&(e.tendered=e.payments.map((function(e){return e.value})).reduce((function(e,t){return t+e}))),e.tendered>=e.total?e.payment_status="paid":e.tendered>0&&e.tendered<e.total&&(e.payment_status="partially_paid"),e.change=e.tendered-e.total,this._order.next(e)}},{key:"setPaymentActive",value:function(e){var t=this._paymentsType.getValue(),s=t.indexOf(e);t.forEach((function(e){return e.selected=!1})),t[s].selected=!0,this._paymentsType.next(t)}},{key:"definedPaymentsType",value:function(e){this._paymentsType.next(e)}},{key:"selectCustomer",value:function(e){var t=this;return new Promise((function(s,n){var r=t.order.getValue();if(r.customer=e,r.customer_id=e.id,t.order.next(r),void 0!==e.group&&null!==e.group)return s(r);a.ih.get("/api/nexopos/v4/customers/".concat(e.id,"/group")).subscribe({next:function(e){r.customer.group=e,t.order.next(r),s(r)},error:function(e){n(e)}})}))}},{key:"updateCart",value:function(e,t){for(var s in t)void 0!==t[s]&&_.default.set(e,s,t[s]);this.order.next(e),this.refreshCart()}},{key:"checkCart",value:function(){var e=this,t=this.order.getValue(),s=[];t.coupons.forEach((function(e){e.products.length>0&&(t.products.filter((function(t){return e.products.map((function(e){return e.product_id})).includes(t.product_id)})).length>0||-1!==s.indexOf(e)||s.push(e)),e.categories.length>0&&(t.products.filter((function(t){return e.categories.map((function(e){return e.category_id})).includes(t.$original().category_id)})).length>0||-1!==s.indexOf(e)||s.push(e))})),s.forEach((function(t){a.kX.error((0,c.__)('The coupons "%s" has been removed from the cart, as it\'s required conditions are no more meet.').replace("%s",t.name),(0,c.__)("Okay"),{duration:6e3}).subscribe(),e.removeCoupon(t)}))}},{key:"refreshCart",value:function(){return x(this,void 0,void 0,r().mark((function e(){var t,s,n,i,o,u,l,d,p;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkCart(),t=this.products.getValue(),s=this.order.getValue(),(n=t.map((function(e){return e.total_price}))).length>0?s.subtotal=n.reduce((function(e,t){return e+t})):s.subtotal=0,i=s.coupons.map((function(e){return"percentage_discount"===e.type?(e.value=s.subtotal*e.discount_value/100,e.value):(e.value=e.discount_value,e.value)})),s.total_coupons=0,i.length>0&&(s.total_coupons=i.reduce((function(e,t){return e+t}))),"percentage"===s.discount_type&&(s.discount=s.discount_percentage*s.subtotal/100),s.discount>s.subtotal&&0===s.total_coupons&&(s.discount=s.subtotal,a.kX.info((0,c.__)("The discount has been set to the cart subtotal.")).subscribe()),s.tax_value=0,this.order.next(s),e.prev=12,e.next=15,this.computeTaxes();case 15:o=e.sent,s=o.data.order,e.next=22;break;case 19:e.prev=19,e.t0=e.catch(12),!1!==e.t0&&void 0!==e.t0.message&&a.kX.error(e.t0.message||(0,c.__)("An unexpected error has occured while fecthing taxes."),(0,c.__)("OKAY"),{duration:0}).subscribe();case 22:(u=t.map((function(e){return"inclusive"===e.tax_type?e.tax_value:0}))).length>0&&u.reduce((function(e,t){return e+t})),l=s.tax_type,d=this.options.getValue().ns_pos_vat,p=0,(["flat_vat","variable_vat"].includes(d)||["products_vat","products_flat_vat","products_variable_vat"].includes(d))&&(p=s.tax_value),s.total="exclusive"===l?+(s.subtotal+(s.shipping||0)+p-s.discount-s.total_coupons).toFixed(ns.currency.ns_currency_precision):+(s.subtotal+(s.shipping||0)-s.discount-s.total_coupons).toFixed(ns.currency.ns_currency_precision),this.order.next(s),a.kq.doAction("ns-cart-after-refreshed",s);case 32:case"end":return e.stop()}}),e,this,[[12,19]])})))}},{key:"getStockUsage",value:function(e,t){var s=this._products.getValue().filter((function(s){return s.product_id===e&&s.unit_quantity_id===t})).map((function(e){return e.quantity}));return s.length>0?s.reduce((function(e,t){return e+t})):0}},{key:"addToCart",value:function(e){return x(this,void 0,void 0,r().mark((function t(){var s,n,i,o,a,c,u,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=new Object,n={product_id:e.id||0,name:e.name,discount_type:"percentage",discount:0,discount_percentage:0,quantity:e.quantity||0,tax_group_id:e.tax_group_id,tax_type:e.tax_type||void 0,tax_value:0,unit_id:e.unit_id||0,unit_price:e.unit_price||0,unit_name:e.unit_name||"",total_price:0,mode:"normal",$original:e.$original||function(){return e},$quantities:e.$quantities||void 0},this._processingAddQueue=!0,0===n.product_id){t.next=22;break}t.t0=r().keys(this.addToCartQueue);case 5:if((t.t1=t.t0()).done){t.next=22;break}return i=t.t1.value,t.prev=7,o=new this.addToCartQueue[i](n),t.next=11,o.run(s);case 11:a=t.sent,s=Object.assign(Object.assign({},s),a),t.next=20;break;case 15:if(t.prev=15,t.t2=t.catch(7),!1!==t.t2){t.next=20;break}return this._processingAddQueue=!1,t.abrupt("return",!1);case 20:t.next=5;break;case 22:this._processingAddQueue=!1,n=Object.assign(Object.assign({},n),s),c=this._products.getValue(),this.settings.getValue().pos_items_merge?(u=c.filter((function(e){return e.product_id===n.product_id&&e.tax_group_id===n.tax_group_id&&e.unit_id===n.unit_id&&e.unit_quantity_id===n.unit_quantity_id})),u.length>0?u[0].quantity+=n.quantity:c.unshift(n)):c.unshift(n),this.refreshProducts(c),this._products.next(c),(l=this.options.getValue().ns_pos_new_item_audio).length>0&&new Audio(l).play();case 30:case"end":return t.stop()}}),t,this,[[7,15]])})))}},{key:"defineTypes",value:function(e){this._types.next(e)}},{key:"removeProduct",value:function(e){var t=this._products.getValue(),s=t.indexOf(e);t.splice(s,1),this._products.next(t)}},{key:"updateProduct",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=this._products.getValue();s=null===s?n.indexOf(e):s,_.default.set(n,s,Object.assign(Object.assign({},e),t)),this.refreshProducts(n),this._products.next(n)}},{key:"refreshProducts",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t.forEach((function(t){e.computeProduct(t)}))}},{key:"getProductUnitPrice",value:function(e,t){switch(e){case"custom":return t.custom_price_edit;case"normal":return t.sale_price_edit;case"wholesale":return t.wholesale_price_edit}}},{key:"computeProductTax",value:function(e){switch(e.mode){case"custom":return this.computeCustomProductTax(e);case"normal":return this.computeNormalProductTax(e);case"wholesale":return this.computeWholesaleProductTax(e);default:return e}}},{key:"proceedProductTaxComputation",value:function(e,t){var s=this,n=e.$original(),r=n.tax_group,i=this.getProductUnitPrice(e.mode,e.$quantities()),o=0,a=this.getProductUnitPrice(e.mode,e.$quantities());if(void 0!==r&&void 0!==r.taxes){var c=0;r.taxes.length>0&&(c=r.taxes.map((function(e){return e.rate})).reduce((function(e,t){return e+t})));var u=this.getNetPrice(t,c,n.tax_type);switch(n.tax_type){case"inclusive":i=u,a=t;break;case"exclusive":i=t,a=u}var l=r.taxes.map((function(e){return s.getVatValue(t,e.rate,n.tax_type)}));l.length>0&&(o=l.reduce((function(e,t){return e+t})))}return{price_without_tax:i,tax_value:o,price_with_tax:a}}},{key:"computeCustomProductTax",value:function(e){e.$original();var t=e.$quantities(),s=this.proceedProductTaxComputation(e,t.custom_price_edit);return t.excl_tax_custom_price=s.price_without_tax,t.incl_tax_custom_price=s.price_with_tax,t.custom_price_tax=s.tax_value,e.$quantities=function(){return t},e}},{key:"computeNormalProductTax",value:function(e){e.$original();var t=e.$quantities(),s=this.proceedProductTaxComputation(e,t.sale_price_edit);return t.excl_tax_sale_price=s.price_without_tax,t.incl_tax_sale_price=s.price_with_tax,t.sale_price_tax=s.tax_value,e.$quantities=function(){return t},e}},{key:"computeWholesaleProductTax",value:function(e){e.$original();var t=e.$quantities(),s=this.proceedProductTaxComputation(e,t.wholesale_price_edit);return t.excl_tax_wholesale_price=s.price_without_tax,t.incl_tax_wholesale_price=s.price_with_tax,t.wholesale_price_tax=s.tax_value,e.$quantities=function(){return t},e}},{key:"computeProduct",value:function(e){"normal"===e.mode?(e.unit_price=this.getSalePrice(e.$quantities(),e.$original()),e.tax_value=e.$quantities().sale_price_tax*e.quantity):"wholesale"===e.mode&&(e.unit_price=this.getWholesalePrice(e.$quantities(),e.$original()),e.tax_value=e.$quantities().wholesale_price_tax*e.quantity),"custom"===e.mode&&(e.unit_price=this.getCustomPrice(e.$quantities(),e.$original()),e.tax_value=e.$quantities().custom_price_tax*e.quantity),["flat","percentage"].includes(e.discount_type)&&"percentage"===e.discount_type&&(e.discount=e.unit_price*e.discount_percentage/100*e.quantity),e.total_price=e.unit_price*e.quantity-e.discount,a.kq.doAction("ns-after-product-computed",e)}},{key:"loadCustomer",value:function(e){return a.ih.get("/api/nexopos/v4/customers/".concat(e))}},{key:"defineSettings",value:function(e){this._settings.next(e)}},{key:"voidOrder",value:function(e){var t=this;void 0!==e.id?["hold"].includes(e.payment_status)?o.G.show(S,{title:(0,c.__)("Order Deletion"),message:(0,c.__)("The current order will be deleted as no payment has been made so far."),onAction:function(s){s&&a.ih.delete("/api/nexopos/v4/orders/".concat(e.id)).subscribe((function(e){a.kX.success(e.message).subscribe(),t.reset()}),(function(e){return a.kX.error(e.message).subscribe()}))}}):o.G.show($,{title:(0,c.__)("Void The Order"),message:(0,c.__)("The current order will be void. This will cancel the transaction, but the order won't be deleted. Further details about the operation will be tracked on the report. Consider providing the reason of this operation."),onAction:function(s){!1!==s&&a.ih.post("/api/nexopos/v4/orders/".concat(e.id,"/void"),{reason:s}).subscribe({next:function(e){a.kX.success(e.message).subscribe(),t.reset()},error:function(e){return a.kX.error(e.message).subscribe()}})}}):a.kX.error((0,c.__)("Unable to void an unpaid order.")).subscribe()}},{key:"triggerOrderTypeSelection",value:function(e){return x(this,void 0,void 0,r().mark((function t(){var s;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=0;case 1:if(!(s<this.orderTypeQueue.length)){t.next=8;break}return t.next=4,this.orderTypeQueue[s].promise(e);case 4:t.sent;case 5:s++,t.next=1;break;case 8:case"end":return t.stop()}}),t,this)})))}},{key:"set",value:function(e,t){var s=this.settings.getValue();s[e]=t,this.settings.next(s)}},{key:"unset",value:function(e){var t=this.settings.getValue();delete t[e],this.settings.next(t)}},{key:"get",value:function(e){return this.settings.getValue()[e]}},{key:"destroy",value:function(){this._products.unsubscribe(),this._customers.unsubscribe(),this._types.unsubscribe(),this._breadcrumbs.unsubscribe(),this._paymentsType.unsubscribe(),this._screen.unsubscribe(),this._order.unsubscribe(),this._settings.unsubscribe()}}],s&&y(t.prototype,s),n&&y(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();window.POS=new A,window.POSClass=A;window.POS},6700:(e,t,s)=>{var n={"./af":2786,"./af.js":2786,"./ar":867,"./ar-dz":4130,"./ar-dz.js":4130,"./ar-kw":6135,"./ar-kw.js":6135,"./ar-ly":6440,"./ar-ly.js":6440,"./ar-ma":7702,"./ar-ma.js":7702,"./ar-sa":6040,"./ar-sa.js":6040,"./ar-tn":7100,"./ar-tn.js":7100,"./ar.js":867,"./az":1083,"./az.js":1083,"./be":9808,"./be.js":9808,"./bg":8338,"./bg.js":8338,"./bm":7438,"./bm.js":7438,"./bn":8905,"./bn-bd":6225,"./bn-bd.js":6225,"./bn.js":8905,"./bo":1560,"./bo.js":1560,"./br":1278,"./br.js":1278,"./bs":622,"./bs.js":622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":877,"./cv.js":877,"./cy":7373,"./cy.js":7373,"./da":4780,"./da.js":4780,"./de":9740,"./de-at":217,"./de-at.js":217,"./de-ch":894,"./de-ch.js":894,"./de.js":9740,"./dv":5300,"./dv.js":5300,"./el":837,"./el.js":837,"./en-au":8348,"./en-au.js":8348,"./en-ca":7925,"./en-ca.js":7925,"./en-gb":2243,"./en-gb.js":2243,"./en-ie":6436,"./en-ie.js":6436,"./en-il":7207,"./en-il.js":7207,"./en-in":4175,"./en-in.js":4175,"./en-nz":6319,"./en-nz.js":6319,"./en-sg":1662,"./en-sg.js":1662,"./eo":2915,"./eo.js":2915,"./es":7093,"./es-do":5251,"./es-do.js":5251,"./es-mx":6112,"./es-mx.js":6112,"./es-us":1146,"./es-us.js":1146,"./es.js":7093,"./et":5603,"./et.js":5603,"./eu":7763,"./eu.js":7763,"./fa":6959,"./fa.js":6959,"./fi":1897,"./fi.js":1897,"./fil":2549,"./fil.js":2549,"./fo":4694,"./fo.js":4694,"./fr":4470,"./fr-ca":3049,"./fr-ca.js":3049,"./fr-ch":2330,"./fr-ch.js":2330,"./fr.js":4470,"./fy":4415,"./fy.js":4415,"./ga":9295,"./ga.js":9295,"./gd":2101,"./gd.js":2101,"./gl":8794,"./gl.js":8794,"./gom-deva":7884,"./gom-deva.js":7884,"./gom-latn":3168,"./gom-latn.js":3168,"./gu":5349,"./gu.js":5349,"./he":4206,"./he.js":4206,"./hi":94,"./hi.js":94,"./hr":316,"./hr.js":316,"./hu":2138,"./hu.js":2138,"./hy-am":1423,"./hy-am.js":1423,"./id":9218,"./id.js":9218,"./is":135,"./is.js":135,"./it":626,"./it-ch":150,"./it-ch.js":150,"./it.js":626,"./ja":9183,"./ja.js":9183,"./jv":4286,"./jv.js":4286,"./ka":2105,"./ka.js":2105,"./kk":7772,"./kk.js":7772,"./km":8758,"./km.js":8758,"./kn":9282,"./kn.js":9282,"./ko":3730,"./ko.js":3730,"./ku":1408,"./ku.js":1408,"./ky":3291,"./ky.js":3291,"./lb":6841,"./lb.js":6841,"./lo":5466,"./lo.js":5466,"./lt":7010,"./lt.js":7010,"./lv":7595,"./lv.js":7595,"./me":9861,"./me.js":9861,"./mi":5493,"./mi.js":5493,"./mk":5966,"./mk.js":5966,"./ml":7341,"./ml.js":7341,"./mn":5115,"./mn.js":5115,"./mr":370,"./mr.js":370,"./ms":9847,"./ms-my":1237,"./ms-my.js":1237,"./ms.js":9847,"./mt":2126,"./mt.js":2126,"./my":6165,"./my.js":6165,"./nb":4924,"./nb.js":4924,"./ne":6744,"./ne.js":6744,"./nl":3901,"./nl-be":9814,"./nl-be.js":9814,"./nl.js":3901,"./nn":3877,"./nn.js":3877,"./oc-lnc":2135,"./oc-lnc.js":2135,"./pa-in":5858,"./pa-in.js":5858,"./pl":4495,"./pl.js":4495,"./pt":9520,"./pt-br":7971,"./pt-br.js":7971,"./pt.js":9520,"./ro":6459,"./ro.js":6459,"./ru":238,"./ru.js":238,"./sd":950,"./sd.js":950,"./se":490,"./se.js":490,"./si":124,"./si.js":124,"./sk":4249,"./sk.js":4249,"./sl":4985,"./sl.js":4985,"./sq":1104,"./sq.js":1104,"./sr":9131,"./sr-cyrl":9915,"./sr-cyrl.js":9915,"./sr.js":9131,"./ss":5893,"./ss.js":5893,"./sv":8760,"./sv.js":8760,"./sw":1172,"./sw.js":1172,"./ta":7333,"./ta.js":7333,"./te":3110,"./te.js":3110,"./tet":2095,"./tet.js":2095,"./tg":7321,"./tg.js":7321,"./th":9041,"./th.js":9041,"./tk":9005,"./tk.js":9005,"./tl-ph":5768,"./tl-ph.js":5768,"./tlh":9444,"./tlh.js":9444,"./tr":2397,"./tr.js":2397,"./tzl":8254,"./tzl.js":8254,"./tzm":1106,"./tzm-latn":699,"./tzm-latn.js":699,"./tzm.js":1106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":7691,"./uk.js":7691,"./ur":3795,"./ur.js":3795,"./uz":6791,"./uz-latn":588,"./uz-latn.js":588,"./uz.js":6791,"./vi":5666,"./vi.js":5666,"./x-pseudo":4378,"./x-pseudo.js":4378,"./yo":5805,"./yo.js":5805,"./zh-cn":3839,"./zh-cn.js":3839,"./zh-hk":5726,"./zh-hk.js":5726,"./zh-mo":9807,"./zh-mo.js":9807,"./zh-tw":4152,"./zh-tw.js":4152};function r(e){var t=i(e);return s(t)}function i(e){if(!s.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=i,e.exports=r,r.id=6700},8058:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});const n={name:"ns-notice",props:["color"],computed:{actualColor:function(){return this.color||"blue"}}};const r=(0,s(1900).Z)(n,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"p-4 border-l-4 text-primary ns-notice",class:"ns-notice "+e.actualColor,attrs:{role:"alert"}},[s("h2",{staticClass:"font-bold"},[e._t("title")],2),e._v(" "),s("p",[e._t("description")],2)])}),[],!1,null,null,null).exports},4211:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});function n(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return r(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,n=new Array(t);s<t;s++)n[s]=e[s];return n}const i={name:"ns-numpad",props:["value","currency","floating","limit"],data:function(){return{number:parseInt(1+new Array(parseInt(ns.currency.ns_currency_precision)).fill("").map((function(e){return 0})).join("")),screenValue:0,order:null,cursor:parseInt(ns.currency.ns_currency_precision),orderSubscription:null,allSelected:!0,keys:[].concat(n([7,8,9].map((function(e){return{identifier:e,value:e}}))),n([4,5,6].map((function(e){return{identifier:e,value:e}}))),n([1,2,3].map((function(e){return{identifier:e,value:e}}))),[{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}])}},mounted:function(){this.floating&&this.value>0?this.screenValue=parseFloat(this.value/this.number):this.screenValue=0},watch:{value:function(){this.value.toString().length>0&&(this.floating?this.screenValue=Math.round(this.value*this.number).toString():this.screenValue=this.value)}},methods:{increaseBy:function(e){var t=parseInt(1+new Array(this.cursor).fill("").map((function(e){return 0})).join(""));this.screenValue=(parseFloat(e.value)*t+(parseFloat(this.screenValue)||0)).toString(),this.allSelected=!1},inputValue:function(e){var t=parseInt(1+new Array(this.cursor).fill("").map((function(e){return 0})).join(""));if("next"!==e.identifier){if("backspace"===e.identifier)this.allSelected?(this.screenValue="0",this.allSelected=!1):this.screenValue=this.screenValue.toString().substr(0,this.screenValue.length-1);else if(e.value.toString().match(/^\d+$/)){if(this.limit>0&&this.screenValue.length>=this.limit)return;this.allSelected?(this.screenValue=e.value.toString(),this.allSelected=!1):(this.screenValue+=""+e.value.toString(),"percentage"===this.mode&&(this.screenValue=this.screenValue>100?100:this.screenValue))}var s=this.floating&&this.screenValue.length>0&&"0"!==this.screenValue?parseFloat(this.screenValue/this.number):this.screenValue;this.$emit("changed",s)}else this.$emit("next",this.floating&&this.screenValue.length>0?parseFloat(this.screenValue/t):this.screenValue)}}};const o=(0,s(1900).Z)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"grid grid-flow-row grid-cols-3 gap-2 grid-rows-3",staticStyle:{padding:"1px"},attrs:{id:"numpad"}},[e._l(e.keys,(function(t,n){return s("div",{key:n,staticClass:"select-none ns-numpad-key border h-16 flex items-center justify-center cursor-pointer",staticStyle:{margin:"-1px"},on:{click:function(s){return e.inputValue(t)}}},[void 0!==t.value?s("span",[e._v(e._s(t.value))]):e._e(),e._v(" "),t.icon?s("i",{staticClass:"las",class:t.icon}):e._e()])})),e._v(" "),e._t("numpad-footer")],2)}),[],!1,null,null,null).exports},5834:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});const n={name:"ns-paginate",props:["pagination"],data:function(){return{page:1,path:""}},mounted:function(){this.path=this.pagination.path},computed:{getPagination:function(){return this.pagination?this.pageNumbers(this.pagination.last_page,this.pagination.current_page):[]}},methods:{gotoPage:function(e){this.page=e,this.$emit("load","".concat(this.path,"?page=").concat(this.page))},pageNumbers:function(e,t){var s=[];t-3>1&&s.push(1,"...");for(var n=1;n<=e;n++)t+3>n&&t-3<n&&s.push(n);return t+3<e&&s.push("...",e),console.log(s),s.filter((function(e){return e>0||"string"==typeof e}))}}};const r=(0,s(1900).Z)(n,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex -mx-1",attrs:{id:"pagination"}},[e.pagination.current_page?[s("a",{staticClass:"mx-1 flex items-center justify-center h-8 w-8 rounded-full bg-gray-200 text-gray-700 hover:bg-blue-400 hover:text-white shadow",attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.gotoPage(e.pagination.first_page)}}},[s("i",{staticClass:"las la-angle-double-left"})]),e._v(" "),e._l(e.getPagination,(function(t,n){return["..."!==e.page?s("a",{key:n,staticClass:"mx-1 flex items-center justify-center h-8 w-8 rounded-full hover:bg-blue-400 hover:text-white",class:e.page==t?"bg-blue-400 text-white":"bg-gray-200 text-gray-700",attrs:{href:"javascript:void(0)"},on:{click:function(s){return e.gotoPage(t)}}},[e._v(e._s(t))]):e._e(),e._v(" "),"..."===e.page?s("a",{key:n,staticClass:"mx-1 flex items-center justify-center h-8 w-8 rounded-full bg-gray-200 text-gray-700",attrs:{href:"javascript:void(0)"}},[e._v("...")]):e._e()]})),e._v(" "),s("a",{staticClass:"mx-1 flex items-center justify-center h-8 w-8 rounded-full bg-gray-200 text-gray-700 hover:bg-blue-400 hover:text-white shadow",attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.gotoPage(e.pagination.last_page)}}},[s("i",{staticClass:"las la-angle-double-right"})])]:e._e()],2)}),[],!1,null,null,null).exports},6194:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var n=s(2242),r=s(306);const i={name:"ns-pos-customers-button",methods:{__:s(7389).__,openPendingOrdersPopup:function(){(new n.G).open(r.Z)}}};const o=(0,s(1900).Z)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-button default"},[s("button",{staticClass:"rounded shadow flex-shrink-0 h-12 flex items-center px-2 py-1 text-sm",on:{click:function(t){return e.openPendingOrdersPopup()}}},[s("i",{staticClass:"mr-1 text-xl lar la-user-circle"}),e._v(" "),s("span",[e._v(e._s(e.__("Customers")))])])])}),[],!1,null,null,null).exports},227:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});const n={name:"ns-pos-dashboard-button",methods:{__:s(7389).__,goToDashboard:function(){return document.location=POS.settings.getValue().urls.dashboard_url}}};const r=(0,s(1900).Z)(n,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-button success"},[s("button",{staticClass:"rounded shadow flex-shrink-0 h-12 flex items-center px-2 py-1 text-sm",on:{click:function(t){return e.goToDashboard()}}},[s("i",{staticClass:"mr-1 text-xl las la-tachometer-alt"}),e._v(" "),s("span",[e._v(e._s(e.__("Dashboard")))])])])}),[],!1,null,null,null).exports},9597:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var n=s(2242),r=s(8680);const i={name:"ns-pos-delivery-button",methods:{__:s(7389).__,openPendingOrdersPopup:function(){new n.G({primarySelector:"#pos-app",popupClass:"shadow-lg bg-white w-3/5 md:w-2/3 lg:w-2/5 xl:w-2/4"}).open(r.Z)}}};const o=(0,s(1900).Z)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-button default"},[s("button",{staticClass:"rounded shadow flex-shrink-0 h-12 flex items-center px-2 py-1 text-sm",on:{click:function(t){return e.openPendingOrdersPopup()}}},[s("i",{staticClass:"mr-1 text-xl las la-truck"}),e._v(" "),s("span",[e._v(e._s(e.__("Order Type")))])])])}),[],!1,null,null,null).exports},6845:(e,t,s)=>{"use strict";s.d(t,{Z:()=>_});var n=s(2242),r=s(9671),i=s(2833),o=s(7389);const a={data:function(){return{products:[],isLoading:!1}},computed:{order:function(){return this.$popupParams.order}},mounted:function(){this.loadProducts()},methods:{__:o.__,close:function(){this.$popupParams.reject(!1),this.$popup.close()},loadProducts:function(){var e=this;this.isLoading=!0;var t=this.$popupParams.order.id;r.ih.get("/api/nexopos/v4/orders/".concat(t,"/products")).subscribe((function(t){e.isLoading=!1,e.products=t}))},openOrder:function(){this.$popup.close(),this.$popupParams.resolve(this.order)}}};var c=s(1900);const u=(0,c.Z)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-lg ns-box w-6/7-screen md:w-3/5-screen lg:w-2/5-screen h-6/7-screen flex flex-col overflow-hidden"},[s("div",{staticClass:"p-2 flex justify-between text-primary items-center border-b ns-box-header"},[s("h3",{staticClass:"font-semibold"},[e._v(e._s(e.__("Products"))+" — "+e._s(e.order.code)+" "),e.order.title?s("span",[e._v("("+e._s(e.order.title)+")")]):e._e()]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.close()}}})],1)]),e._v(" "),s("div",{staticClass:"flex-auto p-2 overflow-y-auto ns-box-body"},[e.isLoading?s("div",{staticClass:"flex-auto relative"},[s("div",{staticClass:"h-full w-full flex items-center justify-center"},[s("ns-spinner")],1)]):e._e(),e._v(" "),e.isLoading?e._e():e._l(e.products,(function(t){return s("div",{key:t.id,staticClass:"item"},[s("div",{staticClass:"flex-col border-b border-info-primary py-2"},[s("div",{staticClass:"title font-semibold text-primary flex justify-between"},[s("span",[e._v(e._s(t.name)+" (x"+e._s(t.quantity)+")")]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(t.total_price)))])]),e._v(" "),s("div",{staticClass:"text-sm text-primary"},[s("ul",[s("li",[e._v(e._s(e.__("Unit"))+" : "+e._s(t.unit.name))])])])])])}))],2),e._v(" "),s("div",{staticClass:"flex justify-end p-2 border-t ns-box-footer"},[s("div",{staticClass:"px-1"},[s("div",{staticClass:"-mx-2 flex"},[s("div",{staticClass:"px-1"},[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.openOrder()}}},[e._v(e._s(e.__("Open")))])],1),e._v(" "),s("div",{staticClass:"px-1"},[s("ns-button",{attrs:{type:"error"},on:{click:function(t){return e.close()}}},[e._v(e._s(e.__("Close")))])],1)])])])])}),[],!1,null,null,null).exports;const l={props:["orders"],data:function(){return{searchField:""}},watch:{orders:function(){r.kq.doAction("ns-pos-pending-orders-refreshed",this.orders)}},mounted:function(){},name:"ns-pos-pending-order",methods:{__:o.__,previewOrder:function(e){this.$emit("previewOrder",e)},proceedOpenOrder:function(e){this.$emit("proceedOpenOrder",e)},searchOrder:function(){this.$emit("searchOrder",this.searchField)},printOrder:function(e){this.$emit("printOrder",e)}}};const d={components:{nsPosPendingOrders:(0,c.Z)(l,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex flex-auto flex-col overflow-hidden"},[s("div",{staticClass:"p-1"},[s("div",{staticClass:"flex rounded border-2 input-group info"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.searchField,expression:"searchField"}],staticClass:"p-2 outline-none flex-auto",attrs:{type:"text"},domProps:{value:e.searchField},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchOrder()},input:function(t){t.target.composing||(e.searchField=t.target.value)}}}),e._v(" "),s("button",{staticClass:"w-16 md:w-24",on:{click:function(t){return e.searchOrder()}}},[s("i",{staticClass:"las la-search"}),e._v(" "),s("span",{staticClass:"mr-1 hidden md:visible"},[e._v(e._s(e.__("Search")))])])])]),e._v(" "),s("div",{staticClass:"overflow-y-auto flex flex-auto"},[s("div",{staticClass:"flex p-2 flex-auto flex-col overflow-y-auto"},[e._l(e.orders,(function(t){return s("div",{key:t.id,staticClass:"border-b ns-box-body w-full py-2",attrs:{"data-order-id":t.id}},[s("h3",{staticClass:"text-primary"},[e._v(e._s(t.title||"Untitled Order"))]),e._v(" "),s("div",{staticClass:"px-2"},[s("div",{staticClass:"flex flex-wrap -mx-4"},[s("div",{staticClass:"w-full md:w-1/2 px-2"},[s("p",{staticClass:"text-sm text-primary"},[s("strong",[e._v(e._s(e.__("Code")))]),e._v(" : "+e._s(t.code))]),e._v(" "),s("p",{staticClass:"text-sm text-primary"},[s("strong",[e._v(e._s(e.__("Cashier")))]),e._v(" : "+e._s(t.nexopos_users_username))]),e._v(" "),s("p",{staticClass:"text-sm text-primary"},[s("strong",[e._v(e._s(e.__("Total")))]),e._v(" : "+e._s(e._f("currency")(t.total)))]),e._v(" "),s("p",{staticClass:"text-sm text-primary"},[s("strong",[e._v(e._s(e.__("Tendered")))]),e._v(" : "+e._s(e._f("currency")(t.tendered)))])]),e._v(" "),s("div",{staticClass:"w-full md:w-1/2 px-2"},[s("p",{staticClass:"text-sm text-primary"},[s("strong",[e._v(e._s(e.__("Customer")))]),e._v(" : "+e._s(t.nexopos_customers_name))]),e._v(" "),s("p",{staticClass:"text-sm text-primary"},[s("strong",[e._v(e._s(e.__("Date")))]),e._v(" : "+e._s(t.created_at))]),e._v(" "),s("p",{staticClass:"text-sm text-primary"},[s("strong",[e._v(e._s(e.__("Type")))]),e._v(" : "+e._s(t.type))])])])]),e._v(" "),s("div",{staticClass:"flex justify-end w-full mt-2"},[s("div",{staticClass:"flex rounded-lg overflow-hidden ns-buttons"},[s("button",{staticClass:"info outline-none px-2 py-1",on:{click:function(s){return e.proceedOpenOrder(t)}}},[s("i",{staticClass:"las la-lock-open"}),e._v(" "+e._s(e.__("Open")))]),e._v(" "),s("button",{staticClass:"success outline-none px-2 py-1",on:{click:function(s){return e.previewOrder(t)}}},[s("i",{staticClass:"las la-eye"}),e._v(" "+e._s(e.__("Products")))]),e._v(" "),s("button",{staticClass:"warning outline-none px-2 py-1",on:{click:function(s){return e.printOrder(t)}}},[s("i",{staticClass:"las la-print"}),e._v(" "+e._s(e.__("Print")))])])])])})),e._v(" "),0===e.orders.length?s("div",{staticClass:"h-full v-full items-center justify-center flex"},[s("h3",{staticClass:"text-semibold text-primary"},[e._v(e._s(e.__("Nothing to display...")))])]):e._e()],2)])])}),[],!1,null,null,null).exports},methods:{__:o.__,searchOrder:function(e){var t=this;r.ih.get("/api/nexopos/v4/crud/".concat(this.active,"?search=").concat(e)).subscribe((function(e){t.orders=e.data}))},setActiveTab:function(e){this.active=e,this.loadOrderFromType(e)},openOrder:function(e){POS.loadOrder(e.id),this.$popup.close()},loadOrderFromType:function(e){var t=this;r.ih.get("/api/nexopos/v4/crud/".concat(e)).subscribe((function(e){t.orders=e.data}))},previewOrder:function(e){var t=this;new Promise((function(t,s){Popup.show(u,{order:e,resolve:t,reject:s})})).then((function(s){t.proceedOpenOrder(e)}),(function(e){return e}))},printOrder:function(e){POS.printOrderReceipt(e)},proceedOpenOrder:function(e){var t=this;if(POS.products.getValue().length>0)return Popup.show(i.default,{title:"Confirm Your Action",message:"The cart is not empty. Opening an order will clear your cart would you proceed ?",onAction:function(s){s&&t.openOrder(e)}});this.openOrder(e)}},data:function(){return{active:"ns.hold-orders",searchField:"",orders:[]}},mounted:function(){var e=this;this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&e.$popup.close()})),this.loadOrderFromType(this.active)}};const p=(0,c.Z)(d,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-lg ns-box w-6/7-screen md:w-3/5-screen lg:w-2/5-screen h-6/7-screen flex flex-col overflow-hidden"},[s("div",{staticClass:"p-2 flex justify-between text-primary items-center ns-box-header border-b"},[s("h3",{staticClass:"font-semibold"},[e._v(e._s(e.__("Orders")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.$popup.close()}}})],1)]),e._v(" "),s("div",{staticClass:"p-2 flex overflow-hidden flex-auto ns-box-body"},[s("ns-tabs",{attrs:{active:e.active},on:{changeTab:function(t){return e.setActiveTab(t)}}},[s("ns-tabs-item",{staticClass:"flex flex-col overflow-hidden",attrs:{identifier:"ns.hold-orders",label:e.__("On Hold"),padding:"p-0"}},[s("ns-pos-pending-orders",{attrs:{orders:e.orders},on:{searchOrder:function(t){return e.searchOrder(t)},previewOrder:function(t){return e.previewOrder(t)},printOrder:function(t){return e.printOrder(t)},proceedOpenOrder:function(t){return e.proceedOpenOrder(t)}}})],1),e._v(" "),s("ns-tabs-item",{staticClass:"flex flex-col overflow-hidden",attrs:{identifier:"ns.unpaid-orders",label:e.__("Unpaid"),padding:"p-0"}},[s("ns-pos-pending-orders",{attrs:{orders:e.orders},on:{searchOrder:function(t){return e.searchOrder(t)},previewOrder:function(t){return e.previewOrder(t)},printOrder:function(t){return e.printOrder(t)},proceedOpenOrder:function(t){return e.proceedOpenOrder(t)}}})],1),e._v(" "),s("ns-tabs-item",{staticClass:"flex flex-col overflow-hidden",attrs:{identifier:"ns.partially-paid-orders",label:e.__("Partially Paid"),padding:"p-0"}},[s("ns-pos-pending-orders",{attrs:{orders:e.orders},on:{searchOrder:function(t){return e.searchOrder(t)},previewOrder:function(t){return e.previewOrder(t)},printOrder:function(t){return e.printOrder(t)},proceedOpenOrder:function(t){return e.proceedOpenOrder(t)}}})],1)],1)],1),e._v(" "),s("div",{staticClass:"p-2 flex justify-between ns-box-footer border-t"},[s("div"),e._v(" "),s("div",[s("ns-button",{attrs:{type:"info"}},[e._v(e._s(e.__("Close")))])],1)])])}),[],!1,null,null,null).exports,f={name:"ns-pos-pending-orders-button",methods:{__:o.__,openPendingOrdersPopup:function(){(new n.G).open(p)}}};const _=(0,c.Z)(f,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-button default"},[s("button",{staticClass:"rounded shadow flex-shrink-0 h-12 flex items-center px-2 py-1 text-sm",on:{click:function(t){return e.openPendingOrdersPopup()}}},[s("i",{staticClass:"mr-1 text-xl lar la-hand-pointer"}),e._v(" "),s("span",[e._v(e._s(e.__("Orders")))])])])}),[],!1,null,null,null).exports},8507:(e,t,s)=>{"use strict";s.d(t,{Z:()=>T});var n=s(7757),r=s.n(n),i=s(9671),o=s(4211),a=s(7266),c=s(8603),u=s(2833),l=s(7389);const d={components:{nsNumpad:o.Z},data:function(){return{amount:0,title:null,identifier:null,settingsSubscription:null,settings:null,action:null,loaded:!1,register_id:null,validation:new a.Z,fields:[]}},mounted:function(){var e=this;this.title=this.$popupParams.title,this.identifier=this.$popupParams.identifier,this.action=this.$popupParams.action,this.register_id=this.$popupParams.register_id,this.settingsSubscription=POS.settings.subscribe((function(t){e.settings=t})),this.loadFields()},destroyed:function(){this.settingsSubscription.unsubscribe()},methods:{popupCloser:c.Z,__:l.__,definedValue:function(e){this.amount=e},close:function(){this.$popup.close()},loadFields:function(){var e=this;this.loaded=!1,nsHttpClient.get("/api/nexopos/v4/fields/".concat(this.identifier)).subscribe((function(t){e.loaded=!0,e.fields=t}),(function(t){return e.loaded=!0,nsSnackBar.error(t.message,"OKAY",{duration:!1}).subscribe()}))},submit:function(e){var t=this;Popup.show(u.default,{title:"Confirm Your Action",message:this.$popupParams.confirmMessage||"Would you like to confirm your action.",onAction:function(e){e&&t.triggerSubmit()}})},triggerSubmit:function(){var e=this,t=this.validation.extractFields(this.fields);t.amount=""===this.amount?0:this.amount,nsHttpClient.post("/api/nexopos/v4/cash-registers/".concat(this.action,"/").concat(this.register_id||this.settings.register.id),t).subscribe((function(t){e.$popupParams.resolve(t),e.$popup.close(),nsSnackBar.success(t.message).subscribe()}),(function(e){nsSnackBar.error(e.message).subscribe()}))}}};var p=s(1900);const f=(0,p.Z)(d,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.loaded?s("div",{staticClass:"shadow-lg w-95vw md:w-2/5-screen ns-box"},[s("div",{staticClass:"border-b ns-box-header p-2 text-primary flex justify-between items-center"},[s("h3",{staticClass:"font-semibold"},[e._v(e._s(e.title))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.close()}}})],1)]),e._v(" "),s("div",{staticClass:"p-2"},[null!==e.settings&&e.settings.register?s("div",{staticClass:"mb-2 p-3 elevation-surface font-bold border text-right flex justify-between"},[s("span",[e._v(e._s(e.__("Balance"))+" ")]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.settings.register.balance)))])]):e._e(),e._v(" "),s("div",{staticClass:"mb-2 p-3 bg-success-primary font-bold text-white text-right flex justify-between"},[s("span",[e._v(e._s(e.__("Input")))]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.amount)))])]),e._v(" "),s("div",{staticClass:"mb-2"},[s("ns-numpad",{attrs:{floating:!0,value:e.amount},on:{next:function(t){return e.submit(t)},changed:function(t){return e.definedValue(t)}}})],1),e._v(" "),e._l(e.fields,(function(e,t){return s("ns-field",{key:t,attrs:{field:e}})}))],2)]):e._e(),e._v(" "),e.loaded?e._e():s("div",{staticClass:"h-full w-full flex items-center justify-center"},[s("ns-spinner")],1)])}),[],!1,null,null,null).exports;var _=s(6386);function v(e,t,s,n,r,i,o){try{var a=e[i](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(n,r)}const h={components:{nsNumpad:o.Z},data:function(){return{registers:[],priorVerification:!1,hasLoadedRegisters:!1,validation:new a.Z,amount:0,settings:null,settingsSubscription:null}},mounted:function(){var e=this;this.checkUsedRegister(),this.settingsSubscription=POS.settings.subscribe((function(t){e.settings=t}))},beforeDestroy:function(){this.settingsSubscription.unsubscribe()},computed:{},methods:{__:l.__,popupResolver:_.Z,selectRegister:function(e){var t,s=this;return(t=r().mark((function t(){var n;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("closed"===e.status){t.next=2;break}return t.abrupt("return",i.kX.error((0,l.__)("Unable to open this register. Only closed register can be opened.")).subscribe());case 2:return t.prev=2,t.next=5,new Promise((function(t,s){var n=(0,l.__)("Open Register : %s").replace("%s",e.name),r=e.id;Popup.show(f,{resolve:t,reject:s,title:n,identifier:"ns.cash-registers-opening",action:"open",register_id:r})}));case 5:n=t.sent,s.popupResolver(n),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[2,9]])})),function(){var e=this,s=arguments;return new Promise((function(n,r){var i=t.apply(e,s);function o(e){v(i,n,r,o,a,"next",e)}function a(e){v(i,n,r,o,a,"throw",e)}o(void 0)}))})()},checkUsedRegister:function(){var e=this;this.priorVerification=!1,i.ih.get("/api/nexopos/v4/cash-registers/used").subscribe({next:function(t){e.$popupParams.resolve(t),e.$popup.close()},error:function(t){e.priorVerification=!0,i.kX.error(t.message).subscribe(),e.loadRegisters()}})},loadRegisters:function(){var e=this;this.hasLoadedRegisters=!1,i.ih.get("/api/nexopos/v4/cash-registers").subscribe((function(t){e.registers=t,e.hasLoadedRegisters=!0}))},getClass:function(e){switch(e.status){case"in-use":return"elevation-surface warning cursor-not-allowed";case"disabled":return"elevation-surface cursor-not-allowed";case"available":return"elevation-surface success"}return"elevation-surface hoverable cursor-pointer"}}};const m=(0,p.Z)(h,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[!1===e.priorVerification?s("div",{staticClass:"h-full w-full py-10 flex justify-center items-center"},[s("ns-spinner",{attrs:{size:"24",border:"8"}})],1):e._e(),e._v(" "),e.priorVerification?s("div",{staticClass:"w-95vw md:w-3/5-screen lg:w-3/5-screen xl:w-2/5-screen flex flex-col overflow-hidden",class:e.priorVerification?"shadow-lg ns-box":""},[[s("div",{staticClass:"title p-2 border-b ns-box-header flex justify-between items-center"},[s("h3",{staticClass:"font-semibold"},[e._v(e._s(e.__("Open The Register")))]),e._v(" "),e.settings?s("div",[s("a",{staticClass:"rounded-full border ns-close-button px-3 text-sm py-1",attrs:{href:e.settings.urls.orders_url}},[e._v(e._s(e.__("Exit To Orders")))])]):e._e()]),e._v(" "),e.hasLoadedRegisters?e._e():s("div",{staticClass:"py-10 flex-auto overflow-y-auto flex items-center justify-center"},[s("ns-spinner",{attrs:{size:"16",border:"4"}})],1),e._v(" "),e.hasLoadedRegisters?s("div",{staticClass:"flex-auto overflow-y-auto"},[s("div",{staticClass:"grid grid-cols-3"},e._l(e.registers,(function(t,n){return s("div",{key:n,staticClass:"border flex items-center justify-center flex-col p-3",class:e.getClass(t),on:{click:function(s){return e.selectRegister(t)}}},[s("i",{staticClass:"las la-cash-register text-6xl"}),e._v(" "),s("h3",{staticClass:"text-semibold text-center"},[e._v(e._s(t.name))]),e._v(" "),s("span",{staticClass:"text-sm"},[e._v("("+e._s(t.status_label)+")")])])})),0),e._v(" "),0===e.registers.length?s("div",{staticClass:"p-2 bg-error-primary text-white"},[e._v("\n                    "+e._s(e.__("Looks like there is no registers. At least one register is required to proceed."))+" — "),s("a",{staticClass:"font-bold hover:underline",attrs:{href:e.settings.urls.registers_url}},[e._v(e._s(e.__("Create Cash Register")))])]):e._e()]):e._e()]],2):e._e()])}),[],!1,null,null,null).exports;const b={data:function(){return{totalIn:0,totalOut:0,settings:null,settingsSubscription:null,histories:[]}},mounted:function(){var e=this;this.settingsSubscription=POS.settings.subscribe((function(t){e.settings=t})),this.getHistory()},destroyed:function(){this.settingsSubscription.unsubscribe()},methods:{__:l.__,popupResolver:_.Z,closePopup:function(){this.popupResolver({status:"success"})},getHistory:function(){var e=this;i.ih.get("/api/nexopos/v4/cash-registers/session-history/".concat(this.settings.register.id)).subscribe((function(t){e.histories=t,e.totalIn=e.histories.filter((function(e){return["register-opening","register-sale","register-cash-in"].includes(e.action)})).map((function(e){return parseFloat(e.value)})).reduce((function(e,t){return e+t}),0),e.totalOut=e.histories.filter((function(e){return["register-closing","register-refund","register-cash-out"].includes(e.action)})).map((function(e){return parseFloat(e.value)})).reduce((function(e,t){return e+t}),0),console.log(e.totalOut)}))}}};const y=(0,p.Z)(b,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-box shadow-lg w-95vw md:w-4/6-screen lg:w-half overflow-hidden"},[s("div",{staticClass:"p-2 flex justify-between items-center ns-box-header",attrs:{id:"header"}},[s("h3",{staticClass:"font-bold"},[e._v(e._s(e.__("Register History")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:e.closePopup}})],1)]),e._v(" "),s("div",{staticClass:"flex w-full ns-box-body"},[s("div",{staticClass:"flex flex-auto"},[s("div",{staticClass:"w-full md:w-1/2 text-right bg-success-primary text-white font-bold text-3xl p-3"},[e._v(e._s(e._f("currency")(e.totalIn)))]),e._v(" "),s("div",{staticClass:"w-full md:w-1/2 text-right bg-error-primary text-white font-bold text-3xl p-3"},[e._v(e._s(e._f("currency")(e.totalOut)))])])]),e._v(" "),s("div",{staticClass:"flex flex-col overflow-y-auto h-120"},[e._l(e.histories,(function(t){return[["register-sale","register-cash-in"].includes(t.action)?s("div",{key:t.id,staticClass:"flex border-b elevation-surface success"},[s("div",{staticClass:"p-2 flex-auto"},[e._v(e._s(t.label))]),e._v(" "),s("div",{staticClass:"flex-auto text-right p-2"},[e._v(e._s(e._f("currency")(t.value)))])]):e._e(),e._v(" "),["register-opening"].includes(t.action)?s("div",{key:t.id,staticClass:"flex border-b elevation-surface"},[s("div",{staticClass:"p-2 flex-auto"},[e._v(e._s(t.label))]),e._v(" "),s("div",{staticClass:"flex-auto text-right p-2"},[e._v(e._s(e._f("currency")(t.value)))])]):e._e(),e._v(" "),["register-close"].includes(t.action)?s("div",{key:t.id,staticClass:"flex border-b elevation-surface info"},[s("div",{staticClass:"p-2 flex-auto"},[e._v(e._s(t.label))]),e._v(" "),s("div",{staticClass:"flex-auto text-right p-2"},[e._v(e._s(e._f("currency")(t.value)))])]):e._e(),e._v(" "),["register-refund","register-cash-out"].includes(t.action)?s("div",{key:t.id,staticClass:"flex border-b elevation-surface error"},[s("div",{staticClass:"p-2 flex-auto"},[e._v(e._s(t.label))]),e._v(" "),s("div",{staticClass:"flex-auto text-right p-2"},[e._v(e._s(e._f("currency")(t.value)))])]):e._e()]}))],2)])}),[],!1,null,null,null).exports;function x(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function g(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?x(Object(s),!0).forEach((function(t){w(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):x(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function w(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function C(e,t,s,n,r,i,o){try{var a=e[i](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(n,r)}function k(e){return function(){var t=this,s=arguments;return new Promise((function(n,r){var i=e.apply(t,s);function o(e){C(i,n,r,o,a,"next",e)}function a(e){C(i,n,r,o,a,"throw",e)}o(void 0)}))}}const P={mounted:function(){var e=this;this.settingsSubscriber=POS.settings.subscribe((function(t){e.settings=t})),this.popupCloser(),this.loadRegisterSummary()},beforeDestroy:function(){this.settingsSubscriber.unsubscribe()},data:function(){return{settings:null,settingsSubscriber:null,register:{}}},methods:{__:l.__,popupResolver:_.Z,popupCloser:c.Z,loadRegisterSummary:function(){var e=this;nsHttpClient.get("/api/nexopos/v4/cash-registers/".concat(this.settings.register.id)).subscribe((function(t){e.register=t}))},closePopup:function(){this.popupResolver({status:"failed",button:"close_popup"})},closeCashRegister:function(){var e=this;return k(r().mark((function t(){var s;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(e,t){Popup.show(f,{title:(0,l.__)("Close Register"),action:"close",identifier:"ns.cash-registers-closing",resolve:e,reject:t})}));case 3:s=t.sent,POS.unset("register"),e.popupResolver(g({button:"close_register"},s)),t.next=11;break;case 8:throw t.prev=8,t.t0=t.catch(0),t.t0;case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},cashIn:function(){var e=this;return k(r().mark((function t(){var s;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(e,t){Popup.show(f,{title:(0,l.__)("Cash In"),action:"register-cash-in",identifier:"ns.cash-registers-cashing",resolve:e,reject:t})}));case 3:s=t.sent,e.popupResolver(g({button:"close_register"},s)),t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},cashOut:function(){var e=this;return k(r().mark((function t(){var s;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(e,t){Popup.show(f,{title:(0,l.__)("Cash Out"),action:"register-cash-out",identifier:"ns.cash-registers-cashout",resolve:e,reject:t})}));case 3:s=t.sent,e.popupResolver(g({button:"close_register"},s)),t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},historyPopup:function(){return k(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,t){Popup.show(y,{resolve:e,reject:t})}));case 3:e.sent,e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))()}}};const j=(0,p.Z)(P,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-lg w-95vw md:w-3/5-screen lg:w-2/4-screen ns-box"},[s("div",{staticClass:"p-2 border-b ns-box-header flex items-center justify-between"},[s("h3",[e._v(e._s(e.__("Register Options")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)]),e._v(" "),void 0!==e.register.total_sale_amount&&void 0!==e.register.balance?s("div",[s("div",{staticClass:"h-16 text-3xl bg-info-primary text-white flex items-center justify-between px-3"},[s("span",{},[e._v(e._s(e.__("Sales")))]),e._v(" "),s("span",{staticClass:"font-bold"},[e._v(e._s(e._f("currency")(e.register.total_sale_amount)))])]),e._v(" "),s("div",{staticClass:"h-16 text-3xl bg-success-primary text-white flex items-center justify-between px-3"},[s("span",{},[e._v(e._s(e.__("Balance")))]),e._v(" "),s("span",{staticClass:"font-bold"},[e._v(e._s(e._f("currency")(e.register.balance)))])])]):e._e(),e._v(" "),void 0===e.register.total_sale_amount&&void 0===e.register.balance?s("div",{staticClass:"h-32 ns-box-body border-b py-1 flex items-center justify-center"},[s("div",[s("ns-spinner",{attrs:{border:"4",size:"16"}})],1)]):e._e(),e._v(" "),s("div",{staticClass:"grid grid-cols-2 text-primary"},[s("div",{staticClass:"border-r border-b py-4 ns-numpad-key info cursor-pointer px-2 flex items-center justify-center flex-col",on:{click:function(t){return e.closeCashRegister()}}},[s("i",{staticClass:"las la-sign-out-alt text-6xl"}),e._v(" "),s("h3",{staticClass:"text-xl font-bold"},[e._v(e._s(e.__("Close")))])]),e._v(" "),s("div",{staticClass:"ns-numpad-key success border-r border-b py-4 cursor-pointer px-2 flex items-center justify-center flex-col",on:{click:function(t){return e.cashIn()}}},[s("i",{staticClass:"las la-plus-circle text-6xl"}),e._v(" "),s("h3",{staticClass:"text-xl font-bold"},[e._v(e._s(e.__("Cash In")))])]),e._v(" "),s("div",{staticClass:"ns-numpad-key error border-r border-b py-4 cursor-pointer px-2 flex items-center justify-center flex-col",on:{click:function(t){return e.cashOut()}}},[s("i",{staticClass:"las la-minus-circle text-6xl"}),e._v(" "),s("h3",{staticClass:"text-xl font-bold"},[e._v(e._s(e.__("Cash Out")))])]),e._v(" "),s("div",{staticClass:"ns-numpad-key info border-r border-b py-4 cursor-pointer px-2 flex items-center justify-center flex-col",on:{click:function(t){return e.historyPopup()}}},[s("i",{staticClass:"las la-history text-6xl"}),e._v(" "),s("h3",{staticClass:"text-xl font-bold"},[e._v(e._s(e.__("History")))])])])])}),[],!1,null,null,null).exports;function O(e,t,s,n,r,i,o){try{var a=e[i](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(n,r)}function S(e){return function(){var t=this,s=arguments;return new Promise((function(n,r){var i=e.apply(t,s);function o(e){O(i,n,r,o,a,"next",e)}function a(e){O(i,n,r,o,a,"throw",e)}o(void 0)}))}}const $={data:function(){return{order:null,name:"",selectedRegister:null,orderSubscriber:null,settingsSubscriber:null}},watch:{},methods:{__:l.__,openRegisterOptions:function(){var e=this;return S(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(e,t){Popup.show(j,{resolve:e,reject:t})}));case 3:"close_register"===t.sent.button&&(delete e.settings.register,POS.settings.next(e.settings),POS.reset()),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),Object.keys(t.t0).length>0&&i.kX.error(t.t0.message).subscribe();case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},registerInitialQueue:function(){var e=this;POS.initialQueue.push(S(r().mark((function t(){var s;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,s){void 0===e.settings.register&&Popup.show(m,{resolve:t,reject:s})}));case 3:return s=t.sent,POS.set("register",s.data.register),e.setRegister(s.data.register),t.abrupt("return",s);case 9:throw t.prev=9,t.t0=t.catch(0),t.t0;case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))),POS.reset()},setButtonName:function(){if(void 0===this.settings.register)return this.name=(0,l.__)("Cash Register");this.name=(0,l.__)("Cash Register : {register}").replace("{register}",this.settings.register.name)},setRegister:function(e){if(void 0!==e){var t=POS.order.getValue();t.register_id=e.id,POS.order.next(t)}}},destroyed:function(){this.orderSubscriber.unsubscribe(),this.settingsSubscriber.unsubscribe()},mounted:function(){var e=this;this.registerInitialQueue(),this.orderSubscriber=POS.order.subscribe((function(t){e.order=t})),this.settingsSubscriber=POS.settings.subscribe((function(t){e.settings=t,e.setRegister(e.settings.register),e.setButtonName()}))}};const T=(0,p.Z)($,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-button default"},[s("button",{staticClass:"rounded shadow flex-shrink-0 h-12 flex items-center px-2 py-1 text-sm",on:{click:function(t){return e.openRegisterOptions()}}},[s("i",{staticClass:"mr-1 text-xl las la-cash-register"}),e._v(" "),s("span",[e._v(e._s(e.name))])])])}),[],!1,null,null,null).exports},8149:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var n=s(2242),r=(s(306),s(2833)),i=s(8603);const o={name:"ns-pos-customers-button",mounted:function(){this.popupCloser()},methods:{__,popupCloser:i.Z,reset:function(){n.G.show(r.default,{title:__("Confirm Your Action"),message:__("The current order will be cleared. But not deleted if it's persistent. Would you like to proceed ?"),onAction:function(e){e&&POS.reset()}})}}};const a=(0,s(1900).Z)(o,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-button error"},[s("button",{staticClass:"rounded shadow flex-shrink-0 h-12 flex items-center px-2 py-1 text-sm",on:{click:function(t){return e.reset()}}},[s("i",{staticClass:"mr-1 text-xl  las la-eraser"}),e._v(" "),s("span",[e._v(e._s(e.__("Reset")))])])])}),[],!1,null,null,null).exports},9110:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});const n={data:function(){return{title:"",message:""}},computed:{size:function(){return this.$popupParams.size||"h-full w-full"}},mounted:function(){var e=this;this.title=this.$popupParams.title,this.message=this.$popupParams.message,this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&(void 0!==e.$popupParams.onAction&&e.$popupParams.onAction(!1),e.$popup.close())}))},methods:{__:s(7389).__,emitAction:function(e){void 0!==this.$popupParams.onAction&&this.$popupParams.onAction(e),this.$popup.close()}}};const r=(0,s(1900).Z)(n,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"w-6/7-screen md:w-4/7-screen lg:w-3/7-screen flex flex-col shadow-lg",class:e.size,attrs:{id:"alert-popup"}},[s("div",{staticClass:"flex items-center justify-center flex-col flex-auto p-4"},[e.title?s("h2",{staticClass:"text-3xl font-body"},[e._v(e._s(e.title))]):e._e(),e._v(" "),s("p",{staticClass:"py-4  text-center"},[e._v(e._s(e.message))])]),e._v(" "),s("div",{staticClass:"action-buttons flex border-t justify-end items-center p-2"},[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.emitAction(!0)}}},[e._v(e._s(e.__("Ok")))])],1)])}),[],!1,null,null,null).exports},8018:(e,t,s)=>{"use strict";s.d(t,{Z:()=>H});var n=s(9671),r=s(1356),i=s(2277),o=s(7266),a=s(8603),c=s(7389);function u(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function l(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?u(Object(s),!0).forEach((function(t){d(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):u(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function d(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const p={mounted:function(){this.popuCloser(),this.loadFields(),this.product=this.$popupParams.product},data:function(){return{formValidation:new o.Z,fields:[],product:null}},methods:{__:c.__,popuCloser:a.Z,close:function(){this.$popupParams.reject(!1),this.$popup.close()},addProduct:function(){if(this.formValidation.validateFields(this.fields),this.formValidation.fieldsValid(this.fields)){var e=this.formValidation.extractFields(this.fields),t=l(l({},this.product),e);return this.$popupParams.resolve(t),console.log(e,t),this.close()}n.kX.error((0,c.__)("The form is not valid.")).subscribe()},loadFields:function(){var e=this;n.ih.get("/api/nexopos/v4/fields/ns.refund-product").subscribe((function(t){e.fields=e.formValidation.createFields(t),e.fields.forEach((function(t){t.value=e.product[t.name]||""}))}))}}};var f=s(1900);const _=(0,f.Z)(p,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-xl ns-box w-95vw md:w-3/5-screen lg:w-3/7-screen h-95vh md:h-3/5-screen lg:h-3/7-screen overflow-hidden flex flex-col"},[s("div",{staticClass:"p-2 flex justify-between border-b ns-box-header items-center"},[s("h3",{staticClass:"text-semibold"},[e._v(e._s(e.__("Products")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.close()}}})],1)]),e._v(" "),s("div",{staticClass:"flex-auto overflow-y-auto relative ns-scrollbar"},[s("div",{staticClass:"p-2"},e._l(e.fields,(function(e,t){return s("ns-field",{key:t,attrs:{field:e}})})),1),e._v(" "),0===e.fields.length?s("div",{staticClass:"h-full w-full flex items-center justify-center"},[s("ns-spinner")],1):e._e()]),e._v(" "),s("div",{staticClass:"p-2 flex justify-between items-center border-t ns-box-body"},[s("div"),e._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.addProduct()}}},[e._v(e._s(e.__("Add Product")))])],1)])])}),[],!1,null,null,null).exports;var v=s(6386),h=s(4211);const m={components:{nsNumpad:h.Z},data:function(){return{product:null,seeValue:0,availableQuantity:0}},mounted:function(){this.product=this.$popupParams.product,this.availableQuantity=this.$popupParams.availableQuantity,this.seeValue=this.product.quantity},methods:{__:c.__,popupResolver:v.Z,close:function(){this.$popupParams.reject(!1),this.$popup.close()},setChangedValue:function(e){this.seeValue=e},updateQuantity:function(e){if(e>this.availableQuantity)return n.kX.error("Unable to proceed as the quantity provided is exceed the available quantity.").subscribe();this.product.quantity=parseFloat(e),this.$popupParams.resolve(this.product),this.$popup.close()}}};const b=(0,f.Z)(m,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-xl ns-box overflow-hidden w-95vw md:w-4/6-screen lg:w-3/7-screen"},[s("div",{staticClass:"p-2 flex justify-between ns-box-header"},[s("h3",{staticClass:"font-semibold"},[e._v(e._s(e.__("Quantity")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.close()}}})],1)]),e._v(" "),e.product?s("div",{staticClass:"border-t border-b ns-box-body py-2 flex items-center justify-center text-2xl font-semibold"},[s("span",[e._v(e._s(e.seeValue))]),e._v(" "),s("span",{staticClass:"text-primary text-sm"},[e._v("("+e._s(e.availableQuantity)+" "+e._s(e.__("available"))+")")])]):e._e(),e._v(" "),e.product?s("div",{staticClass:"flex-auto overflow-y-auto p-2"},[s("ns-numpad",{attrs:{value:e.product.quantity},on:{next:function(t){return e.updateQuantity(t)},changed:function(t){return e.setChangedValue(t)}}})],1):e._e()])}),[],!1,null,null,null).exports;var y=s(3472),x=s(2833),g=s(2242),w=s(1703);function C(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function k(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?C(Object(s),!0).forEach((function(t){P(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):C(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function P(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const j={components:{nsNumpad:h.Z},props:["order"],computed:{screenValue:function(){var e=parseInt(1+new Array(parseInt(ns.currency.ns_currency_precision)).fill("").map((function(e){return 0})).join(""));return this.screen/e},total:function(){return this.refundables.length>0?this.refundables.map((function(e){return parseFloat(e.unit_price)*parseFloat(e.quantity)})).reduce((function(e,t){return e+t}))+this.shippingFees:0+this.shippingFees},shippingFees:function(){return this.refundShipping?this.order.shipping:0}},data:function(){return{isSubmitting:!1,formValidation:new o.Z,refundables:[],paymentOptions:[],paymentField:[],print:new w.Z({settings:systemSettings,options:systemOptions,type:"refund"}),refundShipping:!1,selectedPaymentGateway:!1,screen:0,selectFields:[{type:"select",options:this.order.products.map((function(e){return{label:"".concat(e.name," - ").concat(e.unit.name," (x").concat(e.quantity,")"),value:e.id}})),validation:"required",name:"product_id",label:(0,c.__)("Product"),description:(0,c.__)("Select the product to perform a refund.")}]}},methods:{__:c.__,updateScreen:function(e){this.screen=e},toggleRefundShipping:function(e){this.refundShipping=e,this.refundShipping},proceedPayment:function(){var e=this;return!1===this.selectedPaymentGateway?n.kX.error((0,c.__)("Please select a payment gateway before proceeding.")).subscribe():0===this.total?n.kX.error((0,c.__)("There is nothing to refund.")).subscribe():0===this.screenValue?n.kX.error((0,c.__)("Please provide a valid payment amount.")).subscribe():void g.G.show(x.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("The refund will be made on the current order."),onAction:function(t){t&&e.doProceed()}})},doProceed:function(){var e=this,t={products:this.refundables,total:this.screenValue,payment:this.selectedPaymentGateway,refund_shipping:this.refundShipping};this.isSubmitting=!0,n.ih.post("/api/nexopos/v4/orders/".concat(this.order.id,"/refund"),t).subscribe({next:function(t){e.isSubmitting=!1,e.$emit("changed",!0),e.print.printOrder(t.data.orderRefund.id),n.kX.success(t.message).subscribe()},error:function(t){e.isSubmitting=!1,n.kX.error(t.message).subscribe()}})},addProduct:function(){var e=this;if(this.formValidation.validateFields(this.selectFields),!this.formValidation.fieldsValid(this.selectFields))return n.kX.error((0,c.__)("Please select a product before proceeding.")).subscribe();var t=this.formValidation.extractFields(this.selectFields),s=this.order.products.filter((function(e){return e.id===t.product_id})),r=this.refundables.filter((function(e){return e.id===t.product_id}));if(r.length>0){var i=r.map((function(e){return parseInt(e.quantity)})).reduce((function(e,t){return e+t}));if(i===s[0].quantity)return n.kX.error((0,c.__)("Not enough quantity to proceed.")).subscribe()}if(0===s[0].quantity)return n.kX.error((0,c.__)("Not enough quantity to proceed.")).subscribe();var o=k(k({},s[0]),{condition:"",description:""});new Promise((function(e,t){g.G.show(_,{resolve:e,reject:t,product:o})})).then((function(t){t.quantity=e.getProductOriginalQuantity(t.id)-e.getProductUsedQuantity(t.id),e.refundables.push(t)}),(function(e){return e}))},getProductOriginalQuantity:function(e){var t=this.order.products.filter((function(t){return t.id===e}));return t.length>0?t.map((function(e){return parseFloat(e.quantity)})).reduce((function(e,t){return e+t})):0},getProductUsedQuantity:function(e){var t=this.refundables.filter((function(t){return t.id===e}));return t.length>0?t.map((function(e){return parseFloat(e.quantity)})).reduce((function(e,t){return e+t})):0},openSettings:function(e){var t=this;new Promise((function(t,s){g.G.show(_,{resolve:t,reject:s,product:e})})).then((function(s){var n=t.refundables.indexOf(e);t.$set(t.refundables,n,s)}),(function(e){return e}))},selectPaymentGateway:function(){var e=this;new Promise((function(t,s){g.G.show(y.Z,k({resolve:t,reject:s,value:[e.selectedPaymentOption]},e.paymentField[0]))})).then((function(t){e.selectedPaymentGateway=t[0]}),(function(e){return e}))},changeQuantity:function(e){var t=this;new Promise((function(s,n){var r=t.getProductOriginalQuantity(e.id)-t.getProductUsedQuantity(e.id)+parseFloat(e.quantity);g.G.show(b,{resolve:s,reject:n,product:e,availableQuantity:r})})).then((function(s){if(s.quantity>t.getProductUsedQuantity(e.id)-e.quantity){var n=t.refundables.indexOf(e);t.$set(t.refundables,n,s)}}))},deleteProduct:function(e){var t=this;new Promise((function(s,n){g.G.show(x.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("Would you like to delete this product ?"),onAction:function(s){if(s){var n=t.refundables.indexOf(e);t.refundables.splice(n,1)}}})}))}},mounted:function(){var e=this;this.selectFields=this.formValidation.createFields(this.selectFields),n.ih.get("/api/nexopos/v4/orders/payments").subscribe((function(t){e.paymentField=t}))}};const O=(0,f.Z)(j,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"-m-4 flex-auto flex flex-wrap relative"},[e.isSubmitting?s("div",{staticClass:"bg-overlay h-full w-full flex items-center justify-center absolute z-30"},[s("ns-spinner")],1):e._e(),e._v(" "),s("div",{staticClass:"px-4 w-full lg:w-1/2"},[s("h3",{staticClass:"py-2 border-b-2 text-primary border-info-primary"},[e._v(e._s(e.__("Refund With Products")))]),e._v(" "),s("div",{staticClass:"my-2"},[s("ul",[s("li",{staticClass:"border-b border-info-primary flex justify-between items-center mb-2"},[s("div",{staticClass:"flex-auto flex-col flex"},[s("div",{staticClass:"p-2 flex"},e._l(e.selectFields,(function(e,t){return s("ns-field",{key:t,attrs:{field:e}})})),1),e._v(" "),s("div",{staticClass:"flex justify-between p-2"},[s("div",{staticClass:"flex items-center text-primary"},[e.order.shipping>0?s("span",{staticClass:"mr-2"},[e._v(e._s(e.__("Refund Shipping")))]):e._e(),e._v(" "),e.order.shipping>0?s("ns-checkbox",{attrs:{checked:e.refundShipping},on:{change:function(t){return e.toggleRefundShipping(t)}}}):e._e()],1),e._v(" "),s("div",[s("button",{staticClass:"border rounded-full px-2 py-1 ns-inset-button info",on:{click:function(t){return e.addProduct()}}},[e._v(e._s(e.__("Add Product")))])])])])]),e._v(" "),s("li",[s("h4",{staticClass:"py-1 border-b-2 text-primary border-info-primary"},[e._v(e._s(e.__("Products")))])]),e._v(" "),e._l(e.refundables,(function(t){return s("li",{key:t.id,staticClass:"elevation-surface border flex justify-between items-center mb-2"},[s("div",{staticClass:"px-2 text-primary flex justify-between flex-auto"},[s("div",{staticClass:"flex flex-col"},[s("p",{staticClass:"py-2"},[s("span",[e._v(e._s(t.name))]),e._v(" "),"damaged"===t.condition?s("span",{staticClass:"rounded-full px-2 py-1 text-xs bg-error-primary mx-2 text-white"},[e._v(e._s(e.__("Damaged")))]):e._e(),e._v(" "),"unspoiled"===t.condition?s("span",{staticClass:"rounded-full px-2 py-1 text-xs bg-success-primary mx-2 text-white"},[e._v(e._s(e.__("Unspoiled")))]):e._e()]),e._v(" "),s("small",[e._v(e._s(t.unit.name))])]),e._v(" "),s("div",{staticClass:"flex items-center justify-center"},[s("span",{staticClass:"py-1 flex items-center cursor-pointer border-b border-dashed border-info-primary"},[e._v(e._s(e._f("currency")(t.unit_price*t.quantity)))])])]),e._v(" "),s("div",{staticClass:"flex"},[s("p",{staticClass:"p-2 border-l border-info-primary cursor-pointer text-primary ns-numpad-key w-16 h-16 flex items-center justify-center",on:{click:function(s){return e.openSettings(t)}}},[s("i",{staticClass:"las la-cog text-xl"})]),e._v(" "),s("p",{staticClass:"p-2 border-l border-info-primary cursor-pointer text-primary ns-numpad-key w-16 h-16 flex items-center justify-center",on:{click:function(s){return e.deleteProduct(t)}}},[s("i",{staticClass:"las la-trash"})]),e._v(" "),s("p",{staticClass:"p-2 border-l border-info-primary cursor-pointer text-primary ns-numpad-key w-16 h-16 flex items-center justify-center",on:{click:function(s){return e.changeQuantity(t)}}},[e._v(e._s(t.quantity))])])])}))],2)])]),e._v(" "),s("div",{staticClass:"px-4 w-full lg:w-1/2"},[s("h3",{staticClass:"py-2 border-b-2 text-primary border-info-primary"},[e._v(e._s(e.__("Summary")))]),e._v(" "),s("div",{staticClass:"py-2"},[s("div",{staticClass:"elevation-surface border font-semibold flex mb-2 p-2 justify-between"},[s("span",[e._v(e._s(e.__("Total")))]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.total)))])]),e._v(" "),s("div",{staticClass:"elevation-surface border success font-semibold flex mb-2 p-2 justify-between"},[s("span",[e._v(e._s(e.__("Paid")))]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.order.tendered)))])]),e._v(" "),s("div",{staticClass:"elevation-surface border info font-semibold flex mb-2 p-2 justify-between cursor-pointer",on:{click:function(t){return e.selectPaymentGateway()}}},[s("span",[e._v(e._s(e.__("Payment Gateway")))]),e._v(" "),s("span",[e._v(e._s(e.selectedPaymentGateway?e.selectedPaymentGateway.label:"N/A"))])]),e._v(" "),s("div",{staticClass:"elevation-surface border font-semibold flex mb-2 p-2 justify-between"},[s("span",[e._v(e._s(e.__("Screen")))]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.screenValue)))])]),e._v(" "),s("div",[s("ns-numpad",{attrs:{currency:!0,value:e.screen},on:{changed:function(t){return e.updateScreen(t)},next:function(t){return e.proceedPayment(t)}}})],1)])])])}),[],!1,null,null,null).exports;var S=s(9089);function $(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var T=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,s,n;return t=e,(s=[{key:"getTypeLabel",value:function(e){var t=typeLabels.filter((function(t){return t.value===e}));return t.length>0?t[0].label:(0,c.__)("Unknown Status")}},{key:"getDeliveryStatus",value:function(e){var t=deliveryStatuses.filter((function(t){return t.value===e}));return t.length>0?t[0].label:(0,c.__)("Unknown Status")}},{key:"getProcessingStatus",value:function(e){var t=processingStatuses.filter((function(t){return t.value===e}));return t.length>0?t[0].label:(0,c.__)("Unknown Status")}},{key:"getPaymentStatus",value:function(e){var t=paymentLabels.filter((function(t){return t.value===e}));return t.length>0?t[0].label:(0,c.__)("Unknown Status")}}])&&$(t.prototype,s),n&&$(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function V(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function A(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?V(Object(s),!0).forEach((function(t){E(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):V(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function E(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const F={props:["order"],data:function(){return{labels:new T,validation:new o.Z,inputValue:0,fields:[],paymentTypes}},computed:{paymentsLabels:function(){var e=new Object;return this.paymentTypes.forEach((function(t){e[t.value]=t.label})),e}},methods:{__:c.__,updateValue:function(e){this.inputValue=e},loadPaymentFields:function(){var e=this;n.ih.get("/api/nexopos/v4/orders/payments").subscribe((function(t){e.fields=e.validation.createFields(t)}))},submitPayment:function(e){var t=this;if(this.validation.validateFields(this.fields),!this.validation.fieldsValid(this.fields))return n.kX.error((0,c.__)("Unable to proceed the form is not valid")).subscribe();if(0==parseFloat(e))return n.kX.error((0,c.__)("Please provide a valid value")).subscribe();e=parseFloat(e);var s=A(A({},this.validation.extractFields(this.fields)),{},{value:e});Popup.show(x.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("You make a payment for {amount}. A payment can't be canceled. Would you like to proceed ?").replace("{amount}",this.$options.filters.currency(e)),onAction:function(e){e&&n.ih.post("/api/nexopos/v4/orders/".concat(t.order.id,"/payments"),s).subscribe((function(e){n.kX.success(e.message).subscribe(),t.$emit("changed")}),(function(e){n.kX.error(e.message).subscribe()}))}})}},components:{nsNumpad:h.Z},mounted:function(){this.loadPaymentFields()}};const q=(0,f.Z)(F,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{},[s("div",{staticClass:"flex -mx-4 flex-wrap"},[s("div",{staticClass:"px-2 w-full md:w-1/2"},[s("div",{staticClass:"my-1 h-12 py-1 px-2 flex justify-between items-center elevation-surface info border text-xl font-bold"},[s("span",[e._v(e._s(e.__("Total")))]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.order.total)))])])]),e._v(" "),s("div",{staticClass:"px-2 w-full md:w-1/2"},[s("div",{staticClass:"my-1 h-12 py-1 px-2 flex justify-between items-center  elevation-surface success border text-xl font-bold"},[s("span",[e._v(e._s(e.__("Paid")))]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.order.tendered)))])])]),e._v(" "),s("div",{staticClass:"px-2 w-full md:w-1/2"},[s("div",{staticClass:"my-1 h-12 py-1 px-2 flex justify-between items-center  elevation-surface error border text-xl font-bold"},[s("span",[e._v(e._s(e.__("Unpaid")))]),e._v(" "),e.order.total-e.order.tendered>0?s("span",[e._v(e._s(e._f("currency")(e.order.total-e.order.tendered)))]):e._e(),e._v(" "),e.order.total-e.order.tendered<=0?s("span",[e._v(e._s(e._f("currency")(0)))]):e._e()])]),e._v(" "),s("div",{staticClass:"px-2 w-full md:w-1/2"},[s("div",{staticClass:"my-1 h-12 py-1 px-2 flex justify-between items-center  elevation-surface warning border text-xl font-bold"},[s("span",[e._v(e._s(e.__("Customer Account")))]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.order.customer.account_amount)))])])])]),e._v(" "),s("div",{staticClass:"flex -mx-4 flex-wrap"},[s("div",{staticClass:"px-2 w-full mb-4 md:w-1/2"},["paid"!==e.order.payment_status?s("div",[s("h3",{staticClass:"font-semibold border-b-2 border-info-primary py-2"},[e._v("\n                    "+e._s(e.__("Payment"))+"\n                ")]),e._v(" "),s("div",{staticClass:"py-2"},[e._l(e.fields,(function(e,t){return s("ns-field",{key:t,attrs:{field:e}})})),e._v(" "),s("div",{staticClass:"my-2 px-2 h-12 flex justify-end items-center border elevation-surface"},[e._v("\n                        "+e._s(e._f("currency")(e.inputValue))+"\n                    ")]),e._v(" "),s("ns-numpad",{attrs:{floating:!0,value:e.inputValue},on:{next:function(t){return e.submitPayment(t)},changed:function(t){return e.updateValue(t)}}})],2)]):e._e(),e._v(" "),"paid"===e.order.payment_status?s("div",{staticClass:"flex items-center justify-center h-full"},[s("h3",{staticClass:"text-primary font-semibold"},[e._v(e._s(e.__("No payment possible for paid order.")))])]):e._e()]),e._v(" "),s("div",{staticClass:"px-2 w-full mb-4 md:w-1/2"},[s("h3",{staticClass:"font-semibold border-b-2 border-info-primary py-2 mb-2"},[e._v("\n                "+e._s(e.__("Payment History"))+"\n            ")]),e._v(" "),s("ul",e._l(e.order.payments,(function(t){return s("li",{key:t.id,staticClass:"p-2 flex items-center justify-between text-shite border elevation-surface mb-2"},[s("span",[e._v(e._s(e.paymentsLabels[t.identifier]||e.__("Unknown")))]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(t.value)))])])})),0)])])])}),[],!1,null,null,null).exports;var Z=s(3306);const R={props:["order"],data:function(){return{processingStatuses,deliveryStatuses,labels:new T,showProcessingSelect:!1,showDeliverySelect:!1}},mounted:function(){},methods:{__:c.__,submitProcessingChange:function(){var e=this;g.G.show(x.default,{title:(0,c.__)("Would you proceed ?"),message:(0,c.__)("The processing status of the order will be changed. Please confirm your action."),onAction:function(t){t&&n.ih.post("/api/nexopos/v4/orders/".concat(e.order.id,"/processing"),{process_status:e.order.process_status}).subscribe({next:function(t){e.showProcessingSelect=!1,n.kX.success(t.message).subscribe()},error:function(e){n.kX.error(e.message||(0,c.__)("Unexpected error occured.")).subscribe()}})}})},openRefunds:function(){var e=this;try{new Promise((function(t,s){var n=e.order;g.G.show(Z.Z,{order:n,resolve:t,reject:s})}))}catch(e){}},submitDeliveryStatus:function(){var e=this;g.G.show(x.default,{title:(0,c.__)("Would you proceed ?"),message:(0,c.__)("The delivery status of the order will be changed. Please confirm your action."),onAction:function(t){t&&n.ih.post("/api/nexopos/v4/orders/".concat(e.order.id,"/delivery"),{delivery_status:e.order.delivery_status}).subscribe({next:function(t){e.showDeliverySelect=!1,n.kX.success(t.message).subscribe()},error:function(e){n.kX.error(e.message||(0,c.__)("Unexpected error occured.")).subscribe()}})}})}}};const X=(0,f.Z)(R,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"-mx-4 flex flex-wrap"},[s("div",{staticClass:"flex-auto"},[s("div",{staticClass:"w-full mb-2 flex-wrap flex"},[s("div",{staticClass:"w-full mb-2 px-4"},[s("h3",{staticClass:"font-semibold text-secondary pb-2 border-b border-info-primary"},[e._v(e._s(e.__("Payment Summary")))])]),e._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"elevation-surface border p-2 flex justify-between items-start"},[s("div",[s("h4",{staticClass:"text-semibold text-primary"},[e._v(e._s(e.__("Sub Total")))])]),e._v(" "),s("div",{staticClass:"font-semibold text-secondary"},[e._v(e._s(e._f("currency")(e.order.subtotal)))])])]),e._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start ns-notice error"},[s("div",[s("h4",{staticClass:"text-semibold"},[s("span",{staticClass:"text-white"},[e._v(e._s(e.__("Discount")))]),e._v(" "),"percentage"===e.order.discount_type?s("span",{staticClass:"text-white ml-1"},[e._v("("+e._s(e.order.discount_percentage)+"%)")]):e._e(),e._v(" "),"flat"===e.order.discount_type?s("span",{staticClass:"text-white ml-1"},[e._v("(Flat)")]):e._e()])]),e._v(" "),s("div",{staticClass:"font-semibold"},[e._v(e._s(e._f("currency")(e.order.discount)))])])]),e._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start elevation-surface border"},[s("div",[s("h4",{staticClass:"text-semibold text-primary"},[e._v(e._s(e.__("Shipping")))])]),e._v(" "),s("div",{staticClass:"font-semibold text-secondary"},[e._v(e._s(e._f("currency")(e.order.shipping)))])])]),e._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start ns-notice error"},[s("div",[s("h4",{staticClass:"text-semibold"},[e._v("\n                            "+e._s(e.__("Coupons"))+"\n                        ")])]),e._v(" "),s("div",{staticClass:"font-semibold"},[e._v(e._s(e._f("currency")(e.order.total_coupons)))])])]),e._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start ns-notice info"},[s("div",[s("h4",{staticClass:"text-semibold"},[e._v(e._s(e.__("Total")))])]),e._v(" "),s("div",{staticClass:"font-semibold"},[e._v(e._s(e._f("currency")(e.order.total)))])])]),e._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start ns-notice warning"},[s("div",[s("h4",{staticClass:"text-semibold"},[e._v(e._s(e.__("Taxes")))])]),e._v(" "),s("div",{staticClass:"font-semibold"},[e._v(e._s(e._f("currency")(e.order.tax_value)))])])]),e._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start text-primary elevation-surface error border"},[s("div",[s("h4",{staticClass:"text-semibold"},[e._v(e._s(e.__("Change")))])]),e._v(" "),s("div",{staticClass:"font-semibold"},[e._v(e._s(e._f("currency")(e.order.change)))])])]),e._v(" "),s("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[s("div",{staticClass:"p-2 flex justify-between items-start elevation-surface border"},[s("div",[s("h4",{staticClass:"text-semibold"},[e._v(e._s(e.__("Paid")))])]),e._v(" "),s("div",{staticClass:"font-semibold"},[e._v(e._s(e._f("currency")(e.order.tendered)))])])])])]),e._v(" "),s("div",{staticClass:"px-4 w-full md:w-1/2 lg:w-2/4 mb-2"},[s("div",{staticClass:"mb-2"},[s("h3",{staticClass:"font-semibold text-secondary pb-2 border-b border-info-primary"},[e._v(e._s(e.__("Order Status")))])]),e._v(" "),s("div",{staticClass:"mb-2 p-2 flex justify-between items-start elevation-surface border"},[s("div",[s("h4",{staticClass:"text-semibold text-primary"},[s("span",[e._v(e._s(e.__("Customer")))])])]),e._v(" "),s("div",{staticClass:"font-semibold text-secondary"},[e._v(e._s(e.order.nexopos_customers_name))])]),e._v(" "),s("div",{staticClass:"mb-2 p-2 flex justify-between items-start elevation-surface border"},[s("div",[s("h4",{staticClass:"text-semibold text-primary"},[s("span",[e._v(e._s(e.__("Type")))])])]),e._v(" "),s("div",{staticClass:"font-semibold text-secondary"},[e._v(e._s(e.labels.getTypeLabel(e.order.type)))])]),e._v(" "),s("div",{staticClass:"mb-2 p-2 flex justify-between items-start elevation-surface border"},[s("div",[s("h4",{staticClass:"text-semibold text-primary"},[s("span",[e._v(e._s(e.__("Delivery Status")))])])]),e._v(" "),s("div",{staticClass:"font-semibold text-secondary mt-2 md:mt-0 w-full md:w-auto"},[s("div",{staticClass:"w-full text-center"},[e.showDeliverySelect?e._e():s("span",{staticClass:"font-semibold text-secondary border-b border-info-primary cursor-pointer border-dashed",on:{click:function(t){e.showDeliverySelect=!0}}},[e._v(e._s(e.labels.getDeliveryStatus(e.order.delivery_status)))])]),e._v(" "),e.showDeliverySelect?s("div",{staticClass:"flex-auto flex"},[s("div",{staticClass:"ns-select flex items-center justify-center"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.order.delivery_status,expression:"order.delivery_status"}],ref:"process_status",staticClass:"flex-auto border-info-primary rounded-lg",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.order,"delivery_status",t.target.multiple?s:s[0])}}},e._l(e.deliveryStatuses,(function(t,n){return s("option",{key:n,domProps:{value:t.value}},[e._v(e._s(t.label))])})),0)]),e._v(" "),s("div",{staticClass:"pl-2 flex"},[s("ns-close-button",{on:{click:function(t){e.showDeliverySelect=!1}}}),e._v(" "),s("button",{staticClass:"bg-success-primary text-white rounded-full px-2 py-1",on:{click:function(t){return e.submitDeliveryStatus(e.order)}}},[e._v(e._s(e.__("Save")))])],1)]):e._e()])]),e._v(" "),s("div",{staticClass:"mb-2 p-2 flex flex-col md:flex-row justify-between items-center elevation-surface border"},[s("div",[s("h4",{staticClass:"text-semibold text-primary"},[s("span",[e._v(e._s(e.__("Processing Status")))])])]),e._v(" "),s("div",{staticClass:"font-semibold text-secondary mt-2 md:mt-0 w-full md:w-auto"},[s("div",{staticClass:"w-full text-center"},[e.showProcessingSelect?e._e():s("span",{staticClass:"border-b border-info-primary cursor-pointer border-dashed",on:{click:function(t){e.showProcessingSelect=!0}}},[e._v(e._s(e.labels.getProcessingStatus(e.order.process_status)))])]),e._v(" "),e.showProcessingSelect?s("div",{staticClass:"flex-auto flex"},[s("div",{staticClass:"ns-select flex items-center justify-center"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.order.process_status,expression:"order.process_status"}],ref:"process_status",staticClass:"flex-auto border-info-primary rounded-lg",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.order,"process_status",t.target.multiple?s:s[0])}}},e._l(e.processingStatuses,(function(t,n){return s("option",{key:n,domProps:{value:t.value}},[e._v(e._s(t.label))])})),0)]),e._v(" "),s("div",{staticClass:"pl-2 flex"},[s("ns-close-button",{on:{click:function(t){e.showProcessingSelect=!1}}}),e._v(" "),s("button",{staticClass:"bg-success-primary text-white rounded-full px-2 py-1",on:{click:function(t){return e.submitProcessingChange(e.order)}}},[e._v(e._s(e.__("Save")))])],1)]):e._e()])]),e._v(" "),s("div",{staticClass:"mb-2 p-2 flex justify-between items-start elevation-surface border"},[s("div",[s("h4",{staticClass:"text-semibold text-primary"},[s("span",[e._v(e._s(e.__("Payment Status")))])])]),e._v(" "),s("div",{staticClass:"font-semibold text-secondary"},[e._v(e._s(e.labels.getPaymentStatus(e.order.payment_status)))])])]),e._v(" "),s("div",{staticClass:"px-4 w-full md:w-1/2 lg:w-2/4 mb-2"},[s("div",{staticClass:"mb-2"},[s("h3",{staticClass:"font-semibold text-secondary pb-2 border-b border-info-primary"},[e._v(e._s(e.__("Products")))])]),e._v(" "),e._l(e.order.products,(function(t){return s("div",{key:t.id,staticClass:"p-2 flex justify-between items-start elevation-surface border mb-6"},[s("div",[s("h4",{staticClass:"text-semibold text-primary"},[e._v(e._s(t.name)+" (x"+e._s(t.quantity)+")")]),e._v(" "),s("p",{staticClass:"text-secondary text-sm"},[e._v(e._s(t.unit.name||"N/A"))])]),e._v(" "),s("div",{staticClass:"font-semibold text-secondary"},[e._v(e._s(e._f("currency")(t.total_price)))])])})),e._v(" "),s("div",{staticClass:"mb-2"},[s("h3",{staticClass:"font-semibold text-secondary pb-2 border-b border-info-primary flex justify-between"},[s("span",[e._v(e._s(e.__("Refunded Products")))]),e._v(" "),s("a",{staticClass:"border-b border-info-primary border-dashed",attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.openRefunds()}}},[e._v(e._s(e.__("All Refunds")))])])]),e._v(" "),e._l(e.order.refunded_products,(function(t){return s("div",{key:t.id,staticClass:"p-2 flex justify-between items-start elevation-surface border  mb-6"},[s("div",[s("h4",{staticClass:"text-semibold text-primary"},[e._v(e._s(t.order_product.name)+" (x"+e._s(t.quantity)+")")]),e._v(" "),s("p",{staticClass:"text-secondary text-sm"},[e._v(e._s(t.unit.name||"N/A")+" | "),s("span",{staticClass:"rounded-full px-2",class:"damaged"===t.condition?"bg-error-primary text-white":"bg-info-primary text-white"},[e._v(e._s(t.condition))])])]),e._v(" "),s("div",{staticClass:"font-semibold text-secondary"},[e._v(e._s(e._f("currency")(t.total_price)))])])}))],2)])}),[],!1,null,null,null).exports;var D=s(7757),I=s.n(D);function N(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function L(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Q={name:"ns-order-instalments-payment",data:function(){return{paymentTypes,fields:[{type:"select",name:"payment_type",description:(0,c.__)("Select the payment type that must apply to the current order."),label:(0,c.__)("Payment Type"),validation:"required",options:paymentTypes}],print:new w.Z({settings:systemSettings,options:systemOptions,type:"payment"}),validation:new o.Z,order:null,instalment:null}},methods:{__:c.__,popupResolver:v.Z,popupCloser:a.Z,close:function(){this.popupResolver(!1)},submitPayment:function(){var e=this;if(!this.validation.validateFields(this.fields))return n.kX.error(__m("The form is not valid.")).subcribe();nsHttpClient.post("/api/nexopos/v4/orders/".concat(this.order.id,"/instalments/").concat(this.instalment.id,"/pay"),function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?N(Object(s),!0).forEach((function(t){L(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):N(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},this.validation.extractFields(this.fields))).subscribe({next:function(t){e.popupResolver(!0),e.print.printOrder(t.data.payment.id),n.kX.success(t.message).subscribe()},error:function(e){n.kX.error(e.message||(0,c.__)("An unexpected error has occured")).subscribe()}})}},mounted:function(){this.popupCloser(),this.order=this.$popupParams.order,this.instalment=this.$popupParams.instalment,this.fields=this.validation.createFields(this.fields)}};const U=(0,f.Z)(Q,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-lg ns-box w-95vw md:w-1/3-screen"},[s("div",{staticClass:"p-2 flex justify-between border-b"},[s("h3",[e._v(e._s(e.__("Payment Method")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.close()}}})],1)]),e._v(" "),s("div",{staticClass:"p-2 ns-box-body"},[s("ns-notice",{staticClass:"py-2 p-4 text-center border text-primary rounded-lg",attrs:{color:"info"}},[e._v(e._s(e.__("Before submitting the payment, choose the payment type used for that order.")))]),e._v(" "),e._l(e.fields,(function(e,t){return s("ns-field",{key:t,attrs:{field:e}})}))],2),e._v(" "),s("div",{staticClass:"border-t ns-box-footer p-2 flex justify-end"},[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.submitPayment()}}},[e._v(e._s(e.__("Submit Payment")))])],1)])}),[],!1,null,null,null).exports;function z(e,t,s,n,r,i,o){try{var a=e[i](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(n,r)}const W={props:["order"],name:"ns-order-instalments",data:function(){return{labels:new T,original:[],instalments:[],print:new w.Z({settings:systemSettings,options:systemOptions,type:"payment"})}},mounted:function(){this.loadInstalments()},computed:{totalInstalments:function(){return this.instalments.length>0?this.instalments.map((function(e){return e.amount})).reduce((function(e,t){return parseFloat(e)+parseFloat(t)})):0}},methods:{__:c.__,loadInstalments:function(){var e=this;n.ih.get("/api/nexopos/v4/orders/".concat(this.order.id,"/instalments")).subscribe((function(t){e.original=t,e.instalments=t.map((function(e){return e.price_clicked=!1,e.date_clicked=!1,e.date=moment(e.date).format("YYYY-MM-DD"),e}))}))},showReceipt:function(e){if(null===e.payment_id)return n.kX.error((0,c.__)("This instalment doesn't have any payment attached.")).subscribe();this.print.printOrder(e.payment_id)},addInstalment:function(){this.instalments.push({date:ns.date.moment.format("YYYY-MM-DD"),amount:this.order.total-this.totalInstalments,paid:!1})},createInstalment:function(e){var t=this;Popup.show(x.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("Would you like to create this instalment ?"),onAction:function(s){s&&n.ih.post("/api/nexopos/v4/orders/".concat(t.order.id,"/instalments"),{instalment:e}).subscribe({next:function(e){t.loadInstalments(),n.kX.success(e.message).subscribe()},error:function(e){n.kX.error(e.message||(0,c.__)("An unexpected error has occured")).subscribe()}})}})},deleteInstalment:function(e){var t=this;Popup.show(x.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("Would you like to delete this instalment ?"),onAction:function(s){s&&n.ih.delete("/api/nexopos/v4/orders/".concat(t.order.id,"/instalments/").concat(e.id)).subscribe({next:function(s){var r=t.instalments.indexOf(e);t.instalments.splice(r,1),n.kX.success(s.message).subscribe()},error:function(e){n.kX.error(e.message||(0,c.__)("An unexpected error has occured")).subscribe()}})}})},markAsPaid:function(e){var t,s=this;return(t=I().mark((function t(){return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,n){Popup.show(U,{order:s.order,instalment:e,resolve:t,reject:n})}));case 3:t.sent,s.loadInstalments(),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})),function(){var e=this,s=arguments;return new Promise((function(n,r){var i=t.apply(e,s);function o(e){z(i,n,r,o,a,"next",e)}function a(e){z(i,n,r,o,a,"throw",e)}o(void 0)}))})()},togglePriceEdition:function(e){var t=this;e.paid||(e.price_clicked=!e.price_clicked,this.$forceUpdate(),e.price_clicked&&setTimeout((function(){t.$refs.amount[0].select()}),100))},updateInstalment:function(e){var t=this;Popup.show(x.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("Would you like to update that instalment ?"),onAction:function(s){s&&n.ih.put("/api/nexopos/v4/orders/".concat(t.order.id,"/instalments/").concat(e.id),{instalment:e}).subscribe({next:function(e){n.kX.success(e.message).subscribe()},error:function(e){n.kX.error(e.message||(0,c.__)("An unexpected error has occured")).subscribe()}})}})},toggleDateEdition:function(e){var t=this;e.paid||(e.date_clicked=!e.date_clicked,this.$forceUpdate(),e.date_clicked&&setTimeout((function(){t.$refs.date[0].select()}),200))}}};const B=(0,f.Z)(W,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"-mx-4 flex-auto flex flex-wrap"},[s("div",{staticClass:"flex flex-auto"},[s("div",{staticClass:"w-full mb-2 flex-wrap"},[s("div",{staticClass:"w-full mb-2 px-4"},[s("h3",{staticClass:"font-semibold text-secondary pb-2 border-b border-info-primary"},[e._v(e._s(e.__("Instalments")))])]),e._v(" "),s("div",{staticClass:"px-4"},[s("ul",{staticClass:"border-table-th-edge border-t text-primary"},[e._l(e.instalments,(function(t){return s("li",{key:t.id,staticClass:"border-b border-l flex justify-between elevation-surface",class:t.paid?"success":"info"},[s("span",{staticClass:"p-2"},[t.date_clicked?e._e():s("span",{on:{click:function(s){return e.toggleDateEdition(t)}}},[e._v(e._s(t.date))]),e._v(" "),t.date_clicked?s("span",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.date,expression:"instalment.date"}],ref:"date",refInFor:!0,staticClass:"border border-info-primary rounded",attrs:{type:"date"},domProps:{value:t.date},on:{blur:function(s){return e.toggleDateEdition(t)},input:function(s){s.target.composing||e.$set(t,"date",s.target.value)}}})]):e._e()]),e._v(" "),s("div",{staticClass:"flex items-center"},[s("div",{staticClass:"flex items-center px-2 h-full border-r"},[t.price_clicked?e._e():s("span",{on:{click:function(s){return e.togglePriceEdition(t)}}},[e._v(e._s(e._f("currency")(t.amount)))]),e._v(" "),t.price_clicked?s("span",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"instalment.amount"}],ref:"amount",refInFor:!0,staticClass:"border border-info-primary p-1",attrs:{type:"text"},domProps:{value:t.amount},on:{blur:function(s){return e.togglePriceEdition(t)},input:function(s){s.target.composing||e.$set(t,"amount",s.target.value)}}})]):e._e()]),e._v(" "),!t.paid&&t.id?s("div",{staticClass:"w-36 justify-center flex items-center px-2 h-full border-r"},[s("div",{staticClass:"px-2"},[s("ns-icon-button",{attrs:{type:"success",className:"la-money-bill-wave-alt"},on:{click:function(s){return e.markAsPaid(t)}}})],1),e._v(" "),s("div",{staticClass:"px-2"},[s("ns-icon-button",{attrs:{type:"info",className:"la-save"},on:{click:function(s){return e.updateInstalment(t)}}})],1),e._v(" "),s("div",{staticClass:"px-2"},[s("ns-icon-button",{attrs:{type:"error",className:"la-trash-alt"},on:{click:function(s){return e.deleteInstalment(t)}}})],1)]):e._e(),e._v(" "),t.paid||t.id?e._e():s("div",{staticClass:"w-36 justify-center flex items-center px-2 h-full border-r"},[s("div",{staticClass:"px-2"},[s("div",{staticClass:"ns-button info"},[s("button",{staticClass:"px-3 py-1 rounded-full",on:{click:function(s){return e.createInstalment(t)}}},[s("i",{staticClass:"las la-plus"}),e._v("\n                                            "+e._s(e.__("Create"))+"\n                                        ")])])])]),e._v(" "),t.paid?s("div",{staticClass:"w-36 justify-center flex items-center px-2 h-full"},[s("div",{staticClass:"ns-button info"},[s("button",{staticClass:"px-3 text-xs py-1 rounded-full",on:{click:function(s){return e.showReceipt(t)}}},[s("i",{staticClass:"las la-print"}),e._v("\n                                        "+e._s(e.__("Receipt"))+"\n                                    ")])])]):e._e()])])})),e._v(" "),s("li",{staticClass:"flex justify-between p-2 border-r border-b border-l elevation-surface"},[s("div",{staticClass:"flex items-center justify-center"},[s("span",[e._v("\n                                "+e._s(e.__("Total :"))+" "+e._s(e._f("currency")(e.order.total))+"\n                            ")]),e._v(" "),s("span",{staticClass:"ml-1 text-sm"},[e._v("\n                                ("+e._s(e.__("Remaining :"))+" "+e._s(e._f("currency")(e.order.total-e.totalInstalments))+")\n                            ")])]),e._v(" "),s("div",{staticClass:"-mx-2 flex flex-wrap items-center"},[s("span",{staticClass:"px-2"},[e._v("\n                                "+e._s(e.__("Instalments:"))+" "+e._s(e._f("currency")(e.totalInstalments))+"\n                            ")]),e._v(" "),s("span",{staticClass:"px-2"},[s("div",{staticClass:"ns-button info"},[s("button",{staticClass:"rounded-full px-3 py-1",on:{click:function(t){return e.addInstalment()}}},[e._v(e._s(e.__("Add Instalment")))])])])])])],2)])])])])}),[],!1,null,null,null).exports;var G={filters:{nsCurrency:r.W},name:"ns-preview-popup",data:function(){return{active:"details",order:new Object,products:[],payments:[]}},components:{nsOrderRefund:O,nsOrderPayment:q,nsOrderDetails:X,nsOrderInstalments:B},computed:{isVoidable:function(){return["paid","partially_paid","unpaid"].includes(this.order.payment_status)},isDeleteAble:function(){return["hold"].includes(this.order.payment_status)}},methods:{__:c.__,popupResolver:v.Z,popupCloser:a.Z,closePopup:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.popupResolver(e)},setActive:function(e){this.active=e},refresh:function(){this.$popupParams.component.$emit("updated"),this.loadOrderDetails(this.$popupParams.order.id)},printOrder:function(){var e=this.$popupParams.order;n.ih.get("/api/nexopos/v4/orders/".concat(e.id,"/print/receipt")).subscribe((function(e){n.kX.success(e.message).subscribe()}))},loadOrderDetails:function(e){var t=this;(0,i.D)([n.ih.get("/api/nexopos/v4/orders/".concat(e)),n.ih.get("/api/nexopos/v4/orders/".concat(e,"/products")),n.ih.get("/api/nexopos/v4/orders/".concat(e,"/payments"))]).subscribe((function(e){t.order=e[0],t.products=e[1],t.payments=e[2]}))},deleteOrder:function(){var e=this;Popup.show(x.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("Would you like to delete this order"),onAction:function(t){t&&n.ih.delete("/api/nexopos/v4/orders/".concat(e.$popupParams.order.id)).subscribe({next:function(t){n.kX.success(t.message).subscribe(),e.refreshCrudTable(),e.closePopup(!0)},error:function(e){n.kX.error(e.message).subscribe()}})}})},voidOrder:function(){var e=this;try{new Promise((function(t,s){Popup.show(S.default,{resolve:t,reject:s,title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("The current order will be void. This action will be recorded. Consider providing a reason for this operation"),onAction:function(t){!1!==t&&n.ih.post("/api/nexopos/v4/orders/".concat(e.$popupParams.order.id,"/void"),{reason:t}).subscribe({next:function(t){n.kX.success(t.message).subscribe(),e.refreshCrudTable(),e.closePopup(!0)},error:function(e){n.kX.error(e.message).subscribe()}})}})}))}catch(e){console.log(e)}},refreshCrudTable:function(){this.$popupParams.component.$emit("updated",!0)}},watch:{active:function(){"details"===this.active&&this.loadOrderDetails(this.$popupParams.order.id)}},mounted:function(){this.loadOrderDetails(this.$popupParams.order.id),this.popupCloser()}};window.nsOrderPreviewPopup=G;const Y=G;const H=(0,f.Z)(Y,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"h-95vh w-95vw md:h-6/7-screen md:w-6/7-screen overflow-hidden shadow-xl ns-box flex flex-col"},[s("div",{staticClass:"border-b ns-box-header p-3 flex items-center justify-between"},[s("div",[s("h3",[e._v(e._s(e.__("Order Options")))])]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.closePopup(!0)}}})],1)]),e._v(" "),s("div",{staticClass:"p-2 overflow-scroll ns-box-body flex flex-auto"},[e.order.id?s("ns-tabs",{attrs:{active:e.active},on:{active:function(t){return e.setActive(t)}}},[s("ns-tabs-item",{staticClass:"overflow-y-auto",attrs:{label:e.__("Details"),identifier:"details"}},[s("ns-order-details",{attrs:{order:e.order}})],1),e._v(" "),["order_void","hold","refunded","partially_refunded"].includes(e.order.payment_status)?e._e():s("ns-tabs-item",{staticClass:"overflow-y-auto",attrs:{label:e.__("Payments"),identifier:"payments"}},[s("ns-order-payment",{attrs:{order:e.order},on:{changed:function(t){return e.refresh()}}})],1),e._v(" "),["order_void","hold","refunded"].includes(e.order.payment_status)?e._e():s("ns-tabs-item",{staticClass:"flex overflow-y-auto",attrs:{label:e.__("Refund & Return"),identifier:"refund"}},[s("ns-order-refund",{attrs:{order:e.order},on:{changed:function(t){return e.refresh()}}})],1),e._v(" "),["partially_paid"].includes(e.order.payment_status)?s("ns-tabs-item",{staticClass:"flex overflow-y-auto",attrs:{label:e.__("Installments"),identifier:"instalments"}},[s("ns-order-instalments",{attrs:{order:e.order},on:{changed:function(t){return e.refresh()}}})],1):e._e()],1):e._e(),e._v(" "),e.order.id?e._e():s("div",{staticClass:"h-full w-full flex items-center justify-center"},[s("ns-spinner")],1)],1),e._v(" "),s("div",{staticClass:"p-2 flex justify-between border-t ns-box-footer"},[s("div",[e.isVoidable?s("ns-button",{attrs:{type:"error"},on:{click:function(t){return e.voidOrder()}}},[s("i",{staticClass:"las la-ban"}),e._v("\n                "+e._s(e.__("Void"))+"\n            ")]):e._e(),e._v(" "),e.isDeleteAble?s("ns-button",{attrs:{type:"error"},on:{click:function(t){return e.deleteOrder()}}},[s("i",{staticClass:"las la-trash"}),e._v("\n                "+e._s(e.__("Delete"))+"\n            ")]):e._e()],1),e._v(" "),s("div")])])}),[],!1,null,null,null).exports},3306:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var n=s(7389),r=s(8603),i=s(6386),o=s(9671),a=s(1703);const c={name:"ns-orders-refund-popup",data:function(){return{order:null,refunds:[],view:"summary",previewed:null,loaded:!1,options:systemOptions,settings:systemSettings,print:new a.Z({settings:systemSettings,options:systemOptions,type:"refund"})}},methods:{__:n.__,popupCloser:r.Z,popupResolver:i.Z,toggleProductView:function(e){this.view="details",this.previewed=e},loadOrderRefunds:function(){var e=this;nsHttpClient.get("/api/nexopos/v4/orders/".concat(this.order.id,"/refunds")).subscribe((function(t){e.loaded=!0,e.refunds=t.refunds}),(function(e){o.kX.error(e.message).subscribe()}))},close:function(){this.$popup.close()},printRefundReceipt:function(e){this.print.printOrder(e.id)}},mounted:function(){this.order=this.$popupParams.order,this.popupCloser(),this.loadOrderRefunds()}};const u=(0,s(1900).Z)(c,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-lg w-95vw h-95vh md:w-3/5-screen md:h-3/5-screen ns-box flex flex-col overflow-hidden"},[s("div",{staticClass:"border-b p-2 flex items-center justify-between ns-box-header"},[s("h3",[e._v(e._s(e.__("Order Refunds")))]),e._v(" "),s("div",{staticClass:"flex"},["details"===e.view?s("div",{staticClass:"flex items-center justify-center cursor-pointer rounded-full px-3 border hover:bg-info-primary hover:text-white mr-1",on:{click:function(t){e.view="summary"}}},[e._v(e._s(e.__("Go Back")))]):e._e(),e._v(" "),s("ns-close-button",{on:{click:function(t){return e.close()}}})],1)]),e._v(" "),s("div",{staticClass:"overflow-auto flex-auto ns-box-body"},["summary"===e.view?[e.loaded?e._e():s("div",{staticClass:"flex h-full w-full items-center justify-center"},[s("ns-spinner",{attrs:{size:"24"}})],1),e._v(" "),e.loaded&&0===e.refunds.length?s("div",{staticClass:"flex h-full w-full items-center justify-center"},[s("i",{staticClass:"lar la-frown-open"})]):e._e(),e._v(" "),e.loaded&&e.refunds.length>0?e._l(e.refunds,(function(t){return s("div",{key:t.id,staticClass:"border-b flex flex-col md:flex-row"},[s("div",{staticClass:"w-full md:flex-auto p-2"},[s("h3",{staticClass:"font-semibold mb-1"},[e._v(e._s(e.order.code))]),e._v(" "),s("div",[s("ul",{staticClass:"flex -mx-1 text-sm text-primary"},[s("li",{staticClass:"px-1"},[e._v(e._s(e.__("Total"))+" : "+e._s(e._f("currency")(t.total)))]),e._v(" "),s("li",{staticClass:"px-1"},[e._v(e._s(e.__("By"))+" : "+e._s(t.author.username))])])])]),e._v(" "),s("div",{staticClass:"w-full md:w-16 cursor-pointer hover:bg-info-primary hover:border-info-primary hover:text-white text-lg flex items-center justify-center md:border-l",on:{click:function(s){return e.toggleProductView(t)}}},[s("i",{staticClass:"las la-eye"})]),e._v(" "),s("div",{staticClass:"w-full md:w-16 cursor-pointer hover:bg-info-primary hover:border-info-primary hover:text-white text-lg flex items-center justify-center md:border-l",on:{click:function(s){return e.printRefundReceipt(t)}}},[s("i",{staticClass:"las la-print"})])])})):e._e()]:e._e(),e._v(" "),"details"===e.view?e._l(e.previewed.refunded_products,(function(t){return s("div",{key:t.id,staticClass:"border-b flex flex-col md:flex-row"},[s("div",{staticClass:"w-full md:flex-auto p-2"},[s("h3",{staticClass:"font-semibold mb-1"},[e._v(e._s(t.product.name))]),e._v(" "),s("div",[s("ul",{staticClass:"flex -mx-1 text-sm text-primary"},[s("li",{staticClass:"px-1"},[e._v(e._s(e.__("Condition"))+" : "+e._s(t.condition))]),e._v(" "),s("li",{staticClass:"px-1"},[e._v(e._s(e.__("Quantity"))+" : "+e._s(t.quantity))]),e._v(" "),s("li",{staticClass:"px-1"},[e._v(e._s(e.__("Total"))+" : "+e._s(e._f("currency")(t.total_price)))])])])])])})):e._e()],2)])}),[],!1,null,null,null).exports},2833:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});const n={data:function(){return{title:"",message:""}},computed:{size:function(){return this.$popupParams.size||"h-full w-full"}},mounted:function(){var e=this;this.title=this.$popupParams.title,this.message=this.$popupParams.message,this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&(e.$popupParams.onAction(!1),e.$popup.close())}))},methods:{__:s(7389).__,emitAction:function(e){this.$popupParams.onAction(e),this.$popup.close()}}};const r=(0,s(1900).Z)(n,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex flex-col shadow-lg w-5/7-screen md:w-4/7-screen lg:w-2/7-screen",class:e.size,attrs:{id:"confirm-popup"}},[s("div",{staticClass:"flex items-center justify-center flex-col flex-auto p-4"},[s("h2",{staticClass:"text-xl md:text-3xl font-body text-center"},[e._v(e._s(e.title))]),e._v(" "),s("p",{staticClass:"py-4 text-sm md:text-base text-center"},[e._v(e._s(e.message))])]),e._v(" "),s("div",{staticClass:"action-buttons flex border-t"},[s("button",{staticClass:"flex-auto rounded-none w-1/2 h-16 flex items-center justify-center uppercase",on:{click:function(t){return e.emitAction(!0)}}},[e._v(e._s(e.__("Yes")))]),e._v(" "),s("hr",{staticClass:"border-r h-16"}),e._v(" "),s("button",{staticClass:"flex-auto rounded-none w-1/2 h-16 flex items-center justify-center uppercase",on:{click:function(t){return e.emitAction(!1)}}},[e._v(e._s(e.__("No")))])])])}),[],!1,null,null,null).exports},2459:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var n=s(8603),r=s(6386),i=s(9671),o=s(7389),a=s(7581);s(9624);const c={name:"ns-pos-coupons-load-popup",components:{nsNotice:s(8058).Z},data:function(){return{placeHolder:(0,o.__)("Coupon Code"),couponCode:null,order:null,activeTab:"apply-coupon",orderSubscriber:null,customerCoupon:null}},mounted:function(){var e=this;this.popupCloser(),this.$refs.coupon.select(),this.orderSubscriber=POS.order.subscribe((function(t){e.order=t,e.order.coupons.length>0&&(e.activeTab="active-coupons")})),this.$popupParams&&this.$popupParams.apply_coupon&&(this.couponCode=this.$popupParams.apply_coupon,this.getCoupon(this.couponCode).subscribe({next:function(t){e.customerCoupon=t,e.apply()}}))},destroyed:function(){this.orderSubscriber.unsubscribe()},methods:{__:o.__,popupCloser:n.Z,popupResolver:r.Z,selectCustomer:function(){Popup.show(a.Z)},cancel:function(){this.customerCoupon=null,this.couponCode=null},removeCoupon:function(e){this.order.coupons.splice(e,1),POS.refreshCart()},apply:function(){var e=this;try{var t=this.customerCoupon;if(null!==this.customerCoupon.coupon.valid_hours_start&&!ns.date.moment.isAfter(this.customerCoupon.coupon.valid_hours_start)&&this.customerCoupon.coupon.valid_hours_start.length>0)return i.kX.error((0,o.__)("The coupon is out from validity date range.")).subscribe();if(null!==this.customerCoupon.coupon.valid_hours_end&&!ns.date.moment.isBefore(this.customerCoupon.coupon.valid_hours_end)&&this.customerCoupon.coupon.valid_hours_end.length>0)return i.kX.error((0,o.__)("The coupon is out from validity date range.")).subscribe();var s=this.customerCoupon.coupon.products;if(s.length>0){var n=s.map((function(e){return e.product_id}));if(0===this.order.products.filter((function(e){return n.includes(e.product_id)})).length)return i.kX.error((0,o.__)("This coupon requires products that aren't available on the cart at the moment.")).subscribe()}var r=this.customerCoupon.coupon.categories;if(r.length>0){var a=r.map((function(e){return e.category_id}));if(0===this.order.products.filter((function(e){return a.includes(e.$original().category_id)})).length)return i.kX.error((0,o.__)("This coupon requires products that belongs to specific categories that aren't included at the moment.").replace("%s")).subscribe()}this.cancel();var c={active:t.coupon.active,customer_coupon_id:t.id,minimum_cart_value:t.coupon.minimum_cart_value,maximum_cart_value:t.coupon.maximum_cart_value,name:t.coupon.name,type:t.coupon.type,value:0,limit_usage:t.coupon.limit_usage,code:t.coupon.code,discount_value:t.coupon.discount_value,categories:t.coupon.categories,products:t.coupon.products};POS.pushCoupon(c),this.activeTab="active-coupons",setTimeout((function(){e.popupResolver(c)}),500),i.kX.success((0,o.__)("The coupon has applied to the cart.")).subscribe()}catch(e){console.log(e)}},getCouponType:function(e){switch(e){case"percentage_discount":return(0,o.__)("Percentage");case"flat_discount":return(0,o.__)("Flat");default:return(0,o.__)("Unknown Type")}},getDiscountValue:function(e){switch(e.type){case"percentage_discount":return e.discount_value+"%";case"flat_discount":return this.$options.filters.currency(e.discount_value)}},closePopup:function(){this.popupResolver(!1)},setActiveTab:function(e){this.activeTab=e},getCoupon:function(e){return!this.order.customer_id>0?i.kX.error((0,o.__)("You must select a customer before applying a coupon.")).subscribe():i.ih.post("/api/nexopos/v4/customers/coupons/".concat(e),{customer_id:this.order.customer_id})},loadCoupon:function(){var e=this,t=this.couponCode;this.getCoupon(t).subscribe({next:function(t){e.customerCoupon=t,i.kX.success((0,o.__)("The coupon has been loaded.")).subscribe()},error:function(e){i.kX.error(e.message||(0,o.__)("An unexpected error occured.")).subscribe()}})}}};const u=(0,s(1900).Z)(c,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-lg ns-box w-95vw md:w-3/6-screen lg:w-2/6-screen"},[s("div",{staticClass:"border-b ns-box-header p-2 flex justify-between items-center"},[s("h3",{staticClass:"font-bold"},[e._v(e._s(e.__("Load Coupon")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)]),e._v(" "),s("div",{staticClass:"p-1 ns-box-body"},[s("ns-tabs",{attrs:{active:e.activeTab},on:{changeTab:function(t){return e.setActiveTab(t)}}},[s("ns-tabs-item",{attrs:{label:e.__("Apply A Coupon"),padding:"p-2",identifier:"apply-coupon"}},[s("div",{staticClass:"border-2 input-group info rounded flex"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.couponCode,expression:"couponCode"}],ref:"coupon",staticClass:"w-full text-primary p-2 outline-none",attrs:{type:"text",placeholder:e.placeHolder},domProps:{value:e.couponCode},on:{input:function(t){t.target.composing||(e.couponCode=t.target.value)}}}),e._v(" "),s("button",{staticClass:"px-3 py-2",on:{click:function(t){return e.loadCoupon()}}},[e._v(e._s(e.__("Load")))])]),e._v(" "),s("div",{staticClass:"pt-2"},[s("ns-notice",{attrs:{color:"info"},scopedSlots:e._u([{key:"description",fn:function(){return[e._v(e._s(e.__("Input the coupon code that should apply to the POS. If a coupon is issued for a customer, that customer must be selected priorly.")))]},proxy:!0}])})],1),e._v(" "),e.order&&void 0===e.order.customer_id?s("div",{staticClass:"pt-2 flex"},[s("button",{staticClass:"w-full border p-2 outline-none ns-numpad-key info cursor-pointer text-center",on:{click:function(t){return e.selectCustomer()}}},[e._v(e._s(e.__("Click here to choose a customer.")))])]):e._e(),e._v(" "),e.order&&void 0!==e.order.customer_id?s("div",{staticClass:"pt-2"},[s("ns-notice",{attrs:{color:"success"},scopedSlots:e._u([{key:"description",fn:function(){return[e._v(e._s(e.__("Loading Coupon For : ")+e.order.customer.name+" "+e.order.customer.surname))]},proxy:!0}],null,!1,2531213351)})],1):e._e(),e._v(" "),s("div",{staticClass:"overflow-hidden"},[e.customerCoupon?s("div",{staticClass:"pt-2 fade-in-entrance anim-duration-500 overflow-y-auto ns-scrollbar h-64"},[s("table",{staticClass:"w-full ns-table"},[s("tbody",[s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.__("Coupon Name")))]),e._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.customerCoupon.name))])]),e._v(" "),s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.__("Discount"))+" ("+e._s(e.getCouponType(e.customerCoupon.coupon.type))+")")]),e._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.getDiscountValue(e.customerCoupon.coupon)))])]),e._v(" "),s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.__("Usage")))]),e._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.customerCoupon.usage+"/"+(e.customerCoupon.limit_usage||e.__("Unlimited"))))])]),e._v(" "),s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.__("Valid From")))]),e._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.customerCoupon.coupon.valid_hours_start))])]),e._v(" "),s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.__("Valid Till")))]),e._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.customerCoupon.coupon.valid_hours_end))])]),e._v(" "),s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.__("Categories")))]),e._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[s("ul",e._l(e.customerCoupon.coupon.categories,(function(t){return s("li",{key:t.id,staticClass:"rounded-full px-3 py-1 border"},[e._v(e._s(t.category.name))])})),0)])]),e._v(" "),s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.__("Products")))]),e._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[s("ul",e._l(e.customerCoupon.coupon.products,(function(t){return s("li",{key:t.id,staticClass:"rounded-full px-3 py-1 border"},[e._v(e._s(t.product.name))])})),0)])])])])]):e._e()])]),e._v(" "),s("ns-tabs-item",{attrs:{label:e.__("Active Coupons"),padding:"p-1",identifier:"active-coupons"}},[e.order?s("ul",[e._l(e.order.coupons,(function(t,n){return s("li",{key:n,staticClass:"flex justify-between elevation-surface border items-center px-2 py-1"},[s("div",{staticClass:"flex-auto"},[s("h3",{staticClass:"font-semibold text-primary p-2 flex justify-between"},[s("span",[e._v(e._s(t.name))]),e._v(" "),s("span",[e._v(e._s(e.getDiscountValue(t)))])])]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.removeCoupon(n)}}})],1)])})),e._v(" "),0===e.order.coupons.length?s("li",{staticClass:"flex justify-between elevation-surface border items-center p-2"},[e._v("\n                        "+e._s(e.__("No coupons applies to the cart."))+"\n                    ")]):e._e()],2):e._e()])],1)],1),e._v(" "),e.customerCoupon?s("div",{staticClass:"flex"},[s("button",{staticClass:"w-1/2 px-3 py-2 bg-success-primary text-white font-bold",on:{click:function(t){return e.apply()}}},[e._v("\n            "+e._s(e.__("Apply"))+"\n        ")]),e._v(" "),s("button",{staticClass:"w-1/2 px-3 py-2 bg-error-primary text-white font-bold",on:{click:function(t){return e.cancel()}}},[e._v("\n            "+e._s(e.__("Cancel"))+"\n        ")])]):e._e()])}),[],!1,null,null,null).exports},7581:(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var n=s(9671),r=s(6386),i=s(2242),o=s(306);const a={data:function(){return{searchCustomerValue:"",orderSubscription:null,order:{},debounceSearch:null,customers:[],isLoading:!1}},computed:{customerSelected:function(){return!1}},watch:{searchCustomerValue:function(e){var t=this;clearTimeout(this.debounceSearch),this.debounceSearch=setTimeout((function(){t.searchCustomer(e)}),500)}},mounted:function(){var e=this;this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&e.resolveIfQueued(!1)})),this.orderSubscription=POS.order.subscribe((function(t){e.order=t})),this.getRecentCustomers(),this.$refs.searchField.focus()},destroyed:function(){this.orderSubscription.unsubscribe()},methods:{__:s(7389).__,resolveIfQueued:r.Z,attemptToChoose:function(){if(1===this.customers.length)return this.selectCustomer(this.customers[0]);n.kX.info("Too many result.").subscribe()},openCustomerHistory:function(e,t){t.stopImmediatePropagation(),this.$popup.close(),i.G.show(o.Z,{customer:e,activeTab:"account-payment"})},selectCustomer:function(e){var t=this;this.customers.forEach((function(e){return e.selected=!1})),e.selected=!0,this.isLoading=!0,POS.selectCustomer(e).then((function(s){t.isLoading=!1,t.resolveIfQueued(e)})).catch((function(e){t.isLoading=!1}))},searchCustomer:function(e){var t=this;n.ih.post("/api/nexopos/v4/customers/search",{search:e}).subscribe((function(e){e.forEach((function(e){return e.selected=!1})),t.customers=e}))},createCustomerWithMatch:function(e){this.resolveIfQueued(!1),i.G.show(o.Z,{name:e})},getRecentCustomers:function(){var e=this;this.isLoading=!0,n.ih.get("/api/nexopos/v4/customers").subscribe((function(t){e.isLoading=!1,t.forEach((function(e){return e.selected=!1})),e.customers=t}),(function(t){e.isLoading=!1}))}}};const c=(0,s(1900).Z)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-box shadow-xl w-4/5-screen md:w-2/5-screen xl:w-108",attrs:{id:"ns-pos-customer-select-popup"}},[s("div",{staticClass:"border-b ns-box-header text-center font-semibold text-2xl py-2",attrs:{id:"header"}},[s("h2",[e._v(e._s(e.__("Select Customer")))])]),e._v(" "),s("div",{staticClass:"relative"},[s("div",{staticClass:"p-2 border-b ns-box-body items-center flex justify-between"},[s("span",[e._v(e._s(e.__("Selected"))+" : ")]),e._v(" "),s("div",{staticClass:"flex items-center justify-between"},[s("span",[e._v(e._s(e.order.customer?e.order.customer.name:"N/A"))]),e._v(" "),e.order.customer?s("button",{staticClass:"mx-2 rounded-full h-8 w-8 flex items-center justify-center border ns-inset-button hover:border-transparent",on:{click:function(t){return e.openCustomerHistory(e.order.customer,t)}}},[s("i",{staticClass:"las la-eye"})]):e._e()])]),e._v(" "),s("div",{staticClass:"p-2 border-b ns-box-body flex justify-between text-primary"},[s("div",{staticClass:"input-group flex-auto border-2 rounded"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.searchCustomerValue,expression:"searchCustomerValue"}],ref:"searchField",staticClass:"outline-none w-full p-2",attrs:{placeholder:"Search Customer",type:"text"},domProps:{value:e.searchCustomerValue},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.attemptToChoose()},input:function(t){t.target.composing||(e.searchCustomerValue=t.target.value)}}})])]),e._v(" "),s("div",{staticClass:"h-3/5-screen xl:h-2/5-screen overflow-y-auto ns-scrollbar"},[s("ul",{staticClass:"ns-vertical-menu"},[e.customers&&0===e.customers.length?s("li",{staticClass:"p-2 text-center text-primary"},[e._v("\n                    "+e._s(e.__("No customer match your query..."))+"\n                ")]):e._e(),e._v(" "),e.customers&&0===e.customers.length?s("li",{staticClass:"p-2 cursor-pointer text-center text-primary",on:{click:function(t){return e.createCustomerWithMatch(e.searchCustomerValue)}}},[s("span",{staticClass:"border-b border-dashed border-info-primary"},[e._v(e._s(e.__("Create a customer")))])]):e._e(),e._v(" "),e._l(e.customers,(function(t){return s("li",{key:t.id,staticClass:"cursor-pointer p-2 border-b text-primary flex justify-between items-center",on:{click:function(s){return e.selectCustomer(t)}}},[s("span",[e._v(e._s(t.name))]),e._v(" "),s("p",{staticClass:"flex items-center"},[t.owe_amount>0?s("span",{staticClass:"text-error-primary"},[e._v("-"+e._s(e._f("currency")(t.owe_amount)))]):e._e(),e._v(" "),t.owe_amount>0?s("span",[e._v("/")]):e._e(),e._v(" "),s("span",{staticClass:"purchase-amount"},[e._v(e._s(e._f("currency")(t.purchases_amount)))]),e._v(" "),s("button",{staticClass:"mx-2 rounded-full h-8 w-8 flex items-center justify-center border ns-inset-button info",on:{click:function(s){return e.openCustomerHistory(t,s)}}},[s("i",{staticClass:"las la-eye"})])])])}))],2)]),e._v(" "),e.isLoading?s("div",{staticClass:"z-10 top-0 absolute w-full h-full flex items-center justify-center"},[s("ns-spinner",{attrs:{size:"24",border:"8"}})],1):e._e()])])}),[],!1,null,null,null).exports},306:(e,t,s)=>{"use strict";s.d(t,{Z:()=>g});var n=s(7757),r=s.n(n),i=s(8603),o=s(9671),a=s(2242),c=s(7581),u=s(7266),l=s(7389);const d={mounted:function(){this.closeWithOverlayClicked(),this.loadTransactionFields()},data:function(){return{fields:[],isSubmiting:!1,formValidation:new u.Z}},methods:{__:l.__,closeWithOverlayClicked:i.Z,proceed:function(){var e=this,t=this.$popupParams.customer,s=this.formValidation.extractFields(this.fields);this.isSubmiting=!0,o.ih.post("/api/nexopos/v4/customers/".concat(t.id,"/account-history"),s).subscribe({next:function(t){e.isSubmiting=!1,o.kX.success(t.message).subscribe(),e.$popupParams.resolve(t),e.$popup.close()},error:function(t){e.isSubmiting=!1,o.kX.error(t.message).subscribe(),e.$popupParams.reject(t)}})},close:function(){this.$popup.close(),this.$popupParams.reject(!1)},loadTransactionFields:function(){var e=this;o.ih.get("/api/nexopos/v4/fields/ns.customers-account").subscribe({next:function(t){e.fields=e.formValidation.createFields(t)}})}}};var p=s(1900);const f=(0,p.Z)(d,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"w-6/7-screen md:w-5/7-screen lg:w-4/7-screen h-6/7-screen md:h-5/7-screen lg:h-5/7-screen overflow-hidden shadow-lg ns-box flex flex-col relative"},[s("div",{staticClass:"p-2 border-b ns-box-header flex justify-between items-center"},[s("h2",{staticClass:"font-semibold"},[e._v(e._s(e.__("New Transaction")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.close()}}})],1)]),e._v(" "),s("div",{staticClass:"flex-auto overflow-y-auto"},[0===e.fields.length?s("div",{staticClass:"h-full w-full flex items-center justify-center"},[s("ns-spinner")],1):e._e(),e._v(" "),e.fields.length>0?s("div",{staticClass:"p-2"},e._l(e.fields,(function(e,t){return s("ns-field",{key:t,attrs:{field:e}})})),1):e._e()]),e._v(" "),s("div",{staticClass:"p-2 ns-box-footer justify-between border-t flex"},[s("div"),e._v(" "),s("div",{staticClass:"px-1"},[s("div",{staticClass:"-mx-2 flex flex-wrap"},[s("div",{staticClass:"px-1"},[s("ns-button",{attrs:{type:"error"},on:{click:function(t){return e.close()}}},[e._v(e._s(e.__("Close")))])],1),e._v(" "),s("div",{staticClass:"px-1"},[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.proceed()}}},[e._v(e._s(e.__("Proceed")))])],1)])])]),e._v(" "),0===e.isSubmiting?s("div",{staticClass:"h-full w-full absolute flex items-center justify-center",staticStyle:{background:"rgb(0 98 171 / 45%)"}},[s("ns-spinner")],1):e._e()])}),[],!1,null,null,null).exports;var _=s(2459),v=s(2833),h=s(6386),m=s(5834),b=s(8018);function y(e,t,s,n,r,i,o){try{var a=e[i](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(n,r)}const x={name:"ns-pos-customers",data:function(){return{activeTab:"create-customers",customer:null,subscription:null,orders:[],options:{},optionsSubscriber:null,selectedTab:"orders",isLoadingCoupons:!1,isLoadingRewards:!1,coupons:[],rewardsResponse:[],order:null}},components:{nsPaginate:m.Z},destroyed:function(){this.subscription.unsubscribe(),this.optionsSubscriber.unsubscribe()},mounted:function(){var e=this;this.closeWithOverlayClicked(),this.optionsSubscriber=POS.options.subscribe((function(t){e.options=t})),this.subscription=POS.order.subscribe((function(t){e.order=t,void 0!==e.$popupParams.customer?(e.activeTab="account-payment",e.customer=e.$popupParams.customer,e.loadCustomerOrders(e.customer.id)):void 0!==t.customer&&(e.activeTab="account-payment",e.customer=t.customer,e.loadCustomerOrders(e.customer.id))})),this.popupCloser()},methods:{__:l.__,reload:function(){this.loadCustomerOrders(this.customer.id)},popupResolver:h.Z,popupCloser:i.Z,getType:function(e){switch(e){case"percentage_discount":return(0,l.__)("Percentage Discount");case"flat_discount":return(0,l.__)("Flat Discount")}},closeWithOverlayClicked:i.Z,openOrderOptions:function(e){var t,s=this;return(t=r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,s){a.G.show(b.Z,{order:e,resolve:t,reject:s})}));case 3:t.sent,s.reload(),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),o.kX.error((0,l.__)("An error occured while opening the order options")).subscribe();case 10:case"end":return t.stop()}}),t,null,[[0,7]])})),function(){var e=this,s=arguments;return new Promise((function(n,r){var i=t.apply(e,s);function o(e){y(i,n,r,o,a,"next",e)}function a(e){y(i,n,r,o,a,"throw",e)}o(void 0)}))})()},doChangeTab:function(e){this.selectedTab=e,"coupons"===e&&this.loadCoupons(),"rewards"===e&&this.loadRewards()},loadCoupons:function(){var e=this;this.isLoadingCoupons=!0,o.ih.get("/api/nexopos/v4/customers/".concat(this.customer.id,"/coupons")).subscribe({next:function(t){e.coupons=t,e.isLoadingCoupons=!1},error:function(t){e.isLoadingCoupons=!1}})},loadRewards:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/api/nexopos/v4/customers/".concat(this.customer.id,"/rewards");this.isLoadingRewards=!0,o.ih.get(t).subscribe({next:function(t){e.rewardsResponse=t,e.isLoadingRewards=!1},error:function(t){e.isLoadingRewards=!1}})},prefillForm:function(e){void 0!==this.$popupParams.name&&(e.main.value=this.$popupParams.name)},openCustomerSelection:function(){this.$popup.close(),a.G.show(c.Z)},loadCustomerOrders:function(e){var t=this;o.ih.get("/api/nexopos/v4/customers/".concat(e,"/orders")).subscribe((function(e){t.orders=e}))},newTransaction:function(e){new Promise((function(t,s){a.G.show(f,{customer:e,resolve:t,reject:s})})).then((function(t){POS.loadCustomer(e.id).subscribe((function(e){POS.selectCustomer(e)}))}))},applyCoupon:function(e){var t=this;void 0===this.order.customer?a.G.show(v.default,{title:(0,l.__)("Use Customer ?"),message:(0,l.__)("No customer is selected. Would you like to proceed with this customer ?"),onAction:function(s){s&&POS.selectCustomer(t.customer).then((function(s){t.proceedApplyingCoupon(e)}))}}):this.order.customer.id===this.customer.id?this.proceedApplyingCoupon(e):this.order.customer.id!==this.customer.id&&a.G.show(v.default,{title:(0,l.__)("Change Customer ?"),message:(0,l.__)("Would you like to assign this customer to the ongoing order ?"),onAction:function(s){s&&POS.selectCustomer(t.customer).then((function(s){t.proceedApplyingCoupon(e)}))}})},proceedApplyingCoupon:function(e){var t=this;new Promise((function(t,s){a.G.show(_.Z,{apply_coupon:e.code,resolve:t,reject:s})})).then((function(e){t.popupResolver(!1)})).catch((function(e){}))},handleSavedCustomer:function(e){o.kX.success(e.message).subscribe(),POS.selectCustomer(e.entry),this.$popup.close()}}};const g=(0,p.Z)(x,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-lg rounded w-95vw h-95vh lg:w-3/5-screen flex flex-col overflow-hidden",attrs:{id:"ns-pos-customers"}},[s("div",{staticClass:"ns-header p-2 flex justify-between items-center border-b"},[s("h3",{staticClass:"font-semibold"},[e._v(e._s(e.__("Customers")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.$popup.close()}}})],1)]),e._v(" "),s("div",{staticClass:"ns-body flex-auto flex p-2 overflow-y-auto"},[s("ns-tabs",{attrs:{active:e.activeTab},on:{active:function(t){e.activeTab=t}}},[s("ns-tabs-item",{attrs:{identifier:"create-customers",label:"New Customer"}},["yes"===e.options.ns_pos_customers_creation_enabled?s("ns-crud-form",{attrs:{"submit-url":"/api/nexopos/v4/crud/ns.customers",src:"/api/nexopos/v4/crud/ns.customers/form-config"},on:{updated:function(t){return e.prefillForm(t)},save:function(t){return e.handleSavedCustomer(t)}},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(e._s(e.__("Customer Name")))]},proxy:!0},{key:"save",fn:function(){return[e._v(e._s(e.__("Save Customer")))]},proxy:!0}],null,!1,2432171054)}):e._e(),e._v(" "),"yes"!==e.options.ns_pos_customers_creation_enabled?s("div",{staticClass:"h-full flex-col w-full flex items-center justify-center text-primary"},[s("i",{staticClass:"lar la-hand-paper ns-icon text-6xl"}),e._v(" "),s("h3",{staticClass:"font-medium text-2xl"},[e._v(e._s(e.__("Not Authorized")))]),e._v(" "),s("p",[e._v(e._s(e.__("Creating customers has been explicitly disabled from the settings.")))])]):e._e()],1),e._v(" "),s("ns-tabs-item",{staticClass:"flex",staticStyle:{padding:"0!important"},attrs:{identifier:"account-payment",label:e.__("Customer Account")}},[null===e.customer?s("div",{staticClass:"flex-auto w-full flex items-center justify-center flex-col p-4"},[s("i",{staticClass:"lar la-frown text-6xl"}),e._v(" "),s("h3",{staticClass:"font-medium text-2xl"},[e._v(e._s(e.__("No Customer Selected")))]),e._v(" "),s("p",[e._v(e._s(e.__("In order to see a customer account, you need to select one customer.")))]),e._v(" "),s("div",{staticClass:"my-2"},[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.openCustomerSelection()}}},[e._v(e._s(e.__("Select Customer")))])],1)]):e._e(),e._v(" "),e.customer?s("div",{staticClass:"flex flex-col flex-auto"},[s("div",{staticClass:"flex-auto p-2 flex flex-col"},[s("div",{staticClass:"-mx-4 flex flex-wrap"},[s("div",{staticClass:"px-4 mb-4 w-full"},[s("h2",{staticClass:"font-semibold"},[e._v(e._s(e.__("Summary For"))+" : "+e._s(e.customer.name))])]),e._v(" "),s("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[s("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-success-primary to-green-700 p-2 flex flex-col text-white"},[s("h3",{staticClass:"font-medium text-lg"},[e._v(e._s(e.__("Total Purchases")))]),e._v(" "),s("div",{staticClass:"w-full flex justify-end"},[s("h2",{staticClass:"font-bold"},[e._v(e._s(e._f("currency")(e.customer.purchases_amount)))])])])]),e._v(" "),s("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[s("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-error-secondary to-red-700 p-2 text-white"},[s("h3",{staticClass:"font-medium text-lg"},[e._v(e._s(e.__("Total Owed")))]),e._v(" "),s("div",{staticClass:"w-full flex justify-end"},[s("h2",{staticClass:"text-2xl font-bold"},[e._v(e._s(e._f("currency")(e.customer.owed_amount)))])])])]),e._v(" "),s("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[s("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-blue-500 to-blue-700 p-2 text-white"},[s("h3",{staticClass:"font-medium text-lg"},[e._v(e._s(e.__("Account Amount")))]),e._v(" "),s("div",{staticClass:"w-full flex justify-end"},[s("h2",{staticClass:"text-2xl font-bold"},[e._v(e._s(e._f("currency")(e.customer.account_amount)))])])])]),e._v(" "),s("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[s("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-teal-500 to-teal-700 p-2 text-white"},[s("h3",{staticClass:"font-medium text-lg"},[e._v(e._s(e.__("Credit Limit")))]),e._v(" "),s("div",{staticClass:"w-full flex justify-end"},[s("h2",{staticClass:"text-2xl font-bold"},[e._v(e._s(e._f("currency")(e.customer.credit_limit_amount)))])])])])]),e._v(" "),s("div",{staticClass:"flex flex-auto flex-col overflow-hidden"},[s("ns-tabs",{attrs:{active:e.selectedTab},on:{changeTab:function(t){return e.doChangeTab(t)}}},[s("ns-tabs-item",{attrs:{identifier:"orders",label:e.__("Orders")}},[s("div",{staticClass:"py-2 w-full"},[s("h2",{staticClass:"font-semibold text-primary"},[e._v(e._s(e.__("Last Purchases")))])]),e._v(" "),s("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[s("div",{staticClass:"flex-auto overflow-y-auto"},[s("table",{staticClass:"table ns-table w-full"},[s("thead",[s("tr",{staticClass:"text-primary"},[s("th",{staticClass:"p-2 border font-semibold",attrs:{colspan:"3",width:"150"}},[e._v(e._s(e.__("Order")))]),e._v(" "),s("th",{staticClass:"p-2 border font-semibold",attrs:{width:"50"}},[e._v(e._s(e.__("Options")))])])]),e._v(" "),s("tbody",{staticClass:"text-primary"},[0===e.orders.length?s("tr",[s("td",{staticClass:"border p-2 text-center",attrs:{colspan:"4"}},[e._v(e._s(e.__("No orders...")))])]):e._e(),e._v(" "),e._l(e.orders,(function(t){return s("tr",{key:t.id},[s("td",{staticClass:"border p-2 text-center",attrs:{colspan:"3"}},[s("div",{staticClass:"flex flex-col items-start"},[s("h3",{staticClass:"font-bold"},[e._v(e._s(e.__("Code"))+": "+e._s(t.code))]),e._v(" "),s("div",{staticClass:"md:-mx-2 w-full flex flex-col md:flex-row"},[s("div",{staticClass:"md:px-2 flex items-start w-full md:w-1/4"},[s("small",[e._v(e._s(e.__("Total"))+": "+e._s(e._f("currency")(t.total)))])]),e._v(" "),s("div",{staticClass:"md:px-2 flex items-start w-full md:w-1/4"},[s("small",[e._v(e._s(e.__("Status"))+": "+e._s(t.human_status))])]),e._v(" "),s("div",{staticClass:"md:px-2 flex items-start w-full md:w-1/4"},[s("small",[e._v(e._s(e.__("Delivery"))+": "+e._s(t.human_delivery_status))])])])])]),e._v(" "),s("td",{staticClass:"border p-2 text-center"},[s("button",{staticClass:"hover:bg-info-primary hover:border-transparent hover:text-white rounded-full h-8 px-2 flex items-center justify-center border border-gray ns-inset-button",on:{click:function(s){return e.openOrderOptions(t)}}},[s("i",{staticClass:"las la-wallet"}),e._v(" "),s("span",{staticClass:"ml-1"},[e._v(e._s(e.__("Options")))])])])])}))],2)])])])]),e._v(" "),s("ns-tabs-item",{attrs:{identifier:"coupons",label:e.__("Coupons")}},[e.isLoadingCoupons?s("div",{staticClass:"flex-auto h-full justify-center flex items-center"},[s("ns-spinner",{attrs:{size:"36"}})],1):e._e(),e._v(" "),e.isLoadingCoupons?e._e():[s("div",{staticClass:"py-2 w-full"},[s("h2",{staticClass:"font-semibold text-primary"},[e._v(e._s(e.__("Coupons")))])]),e._v(" "),s("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[s("div",{staticClass:"flex-auto overflow-y-auto"},[s("table",{staticClass:"table ns-table w-full"},[s("thead",[s("tr",{staticClass:"text-primary"},[s("th",{staticClass:"p-2 border font-semibold",attrs:{width:"150"}},[e._v(e._s(e.__("Name")))]),e._v(" "),s("th",{staticClass:"p-2 border font-semibold"},[e._v(e._s(e.__("Type")))]),e._v(" "),s("th",{staticClass:"p-2 border font-semibold"})])]),e._v(" "),s("tbody",{staticClass:"text-primary text-sm"},[0===e.coupons.length?s("tr",[s("td",{staticClass:"border p-2 text-center",attrs:{colspan:"4"}},[e._v(e._s(e.__("No coupons for the selected customer...")))])]):e._e(),e._v(" "),e._l(e.coupons,(function(t){return s("tr",{key:t.id},[s("td",{staticClass:"border p-2",attrs:{width:"300"}},[s("h3",[e._v(e._s(t.name))]),e._v(" "),s("div",{},[s("ul",{staticClass:"-mx-2 flex"},[s("li",{staticClass:"text-xs text-primary px-2"},[e._v(e._s(e.__("Usage :"))+" "+e._s(t.usage)+"/"+e._s(t.limit_usage))]),e._v(" "),s("li",{staticClass:"text-xs text-primary px-2"},[e._v(e._s(e.__("Code :"))+" "+e._s(t.code))])])])]),e._v(" "),s("td",{staticClass:"border p-2 text-center"},[e._v(e._s(e.getType(t.coupon.type))+" \n                                                                "),"percentage_discount"===t.coupon.type?s("span",[e._v("\n                                                                    ("+e._s(t.coupon.discount_value)+"%)\n                                                                ")]):e._e(),e._v(" "),"flat_discount"===t.coupon.type?s("span",[e._v("\n                                                                    ("+e._s(e._f("currency")(t.coupon.discount_value))+")\n                                                                ")]):e._e()]),e._v(" "),s("td",{staticClass:"border p-2 text-right"},[s("ns-button",{attrs:{type:"info"},on:{click:function(s){return e.applyCoupon(t)}}},[e._v(e._s(e.__("Use Coupon")))])],1)])}))],2)])])])]],2),e._v(" "),s("ns-tabs-item",{attrs:{identifier:"rewards",label:e.__("Rewards")}},[e.isLoadingRewards?s("div",{staticClass:"flex-auto h-full justify-center flex items-center"},[s("ns-spinner",{attrs:{size:"36"}})],1):e._e(),e._v(" "),e.isLoadingRewards?e._e():[s("div",{staticClass:"py-2 w-full"},[s("h2",{staticClass:"font-semibold text-primary"},[e._v(e._s(e.__("Rewards")))])]),e._v(" "),s("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[s("div",{staticClass:"flex-auto overflow-y-auto"},[s("table",{staticClass:"table ns-table w-full"},[s("thead",[s("tr",{staticClass:"text-primary"},[s("th",{staticClass:"p-2 border font-semibold",attrs:{width:"150"}},[e._v(e._s(e.__("Name")))]),e._v(" "),s("th",{staticClass:"p-2 border font-semibold"},[e._v(e._s(e.__("Points")))]),e._v(" "),s("th",{staticClass:"p-2 border font-semibold"},[e._v(e._s(e.__("Target")))])])]),e._v(" "),e.rewardsResponse.data?s("tbody",{staticClass:"text-primary text-sm"},[0===e.rewardsResponse.data.length?s("tr",[s("td",{staticClass:"border p-2 text-center",attrs:{colspan:"4"}},[e._v(e._s(e.__("No rewards available the selected customer...")))])]):e._e(),e._v(" "),e._l(e.rewardsResponse.data,(function(t){return s("tr",{key:t.id},[s("td",{staticClass:"border p-2",attrs:{width:"300"}},[s("h3",{staticClass:"text-center"},[e._v(e._s(t.reward_name))])]),e._v(" "),s("td",{staticClass:"border p-2",attrs:{width:"300"}},[s("h3",{staticClass:"text-center"},[e._v(e._s(t.points))])]),e._v(" "),s("td",{staticClass:"border p-2",attrs:{width:"300"}},[s("h3",{staticClass:"text-center"},[e._v(e._s(t.target))])])])}))],2):e._e()])])]),e._v(" "),s("div",{staticClass:"py-1 flex justify-end"},[s("ns-paginate",{attrs:{pagination:e.rewardsResponse},on:{load:function(t){return e.loadRewards(t)}}})],1)]],2)],1)],1)]),e._v(" "),s("div",{staticClass:"p-2 border-t border-box-edge flex justify-between"},[s("div"),e._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.newTransaction(e.customer)}}},[e._v(e._s(e.__("Account Transaction")))])],1)])]):e._e()])],1)],1)])}),[],!1,null,null,null).exports},6689:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var n=s(7266),r=s(9671),i=s(7389);function o(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function a(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?o(Object(s),!0).forEach((function(t){c(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function c(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}const l={name:"ns-pos-layaway-popup",data:function(){return{fields:[],instalments:[],formValidation:new n.Z,subscription:null,totalPayments:0}},mounted:function(){var e=this;this.loadFields(),this.subscription=this.$popup.event.subscribe((function(t){["click-overlay","press-esc"].includes(t.event)&&e.close()}))},updated:function(){var e=this;setTimeout((function(){document.querySelector(".is-popup #total_instalments").addEventListener("change",(function(){var t=e.formValidation.extractFields(e.fields).total_instalments;e.generatePaymentFields(t)})),document.querySelector(".is-popup #total_instalments").addEventListener("focus",(function(){document.querySelector(".is-popup #total_instalments").select()}))}),200)},computed:{expectedPayment:function(){var e=this.order.customer.group.minimal_credit_payment;return nsRawCurrency(this.order.total*e/100)},order:function(){return this.$popupParams.order.instalments=this.$popupParams.order.instalments.map((function(e){for(var t in e)if("object"!==u(e[t]))if("date"===t){var s={type:"date",name:t,label:(0,i.__)("Date"),disabled:1===e.paid,value:moment(e.date).format("YYYY-MM-DD")};e[t]=s}else if("amount"===t){var n={type:"number",name:t,label:(0,i.__)("Amount"),disabled:1===e.paid,value:e.amount};e[t]=n}else if(!["paid","id"].includes(t)){var r={type:"hidden",name:t,value:e[t]};e[t]=r}return e})),this.$popupParams.order}},destroyed:function(){this.subscription.unsubscribe()},methods:{__:i.__,refreshTotalPayments:function(){if(this.order.instalments.length>0){var e=nsRawCurrency(this.order.instalments.map((function(e){return parseFloat(e.amount.value)||0})).reduce((function(e,t){return parseFloat(e)+parseFloat(t)})));this.totalPayments=this.order.total-e}else this.totalPayments=0},generatePaymentFields:function(e){var t=this;this.order.instalments=new Array(parseInt(e)).fill("").map((function(e,s){return{date:{type:"date",name:"date",label:"Date",value:0===s?ns.date.moment.format("YYYY-MM-DD"):""},amount:{type:"number",name:"amount",label:"Amount",value:0===s?t.expectedPayment:0},readonly:{type:"hidden",name:"readonly",value:t.expectedPayment>0&&0===s}}})),this.$forceUpdate(),this.refreshTotalPayments()},close:function(){this.$popupParams.reject({status:"failed",message:(0,i.__)("You must define layaway settings before proceeding.")}),this.$popup.close()},updateOrder:function(){var e=this;if(0===this.order.instalments.length)return r.kX.error((0,i.__)("Please provide instalments before proceeding.")).subscribe();if(this.fields.forEach((function(t){return e.formValidation.validateField(t)})),!this.formValidation.fieldsValid(this.fields))return r.kX.error((0,i.__)("Unable to procee the form is not valid")).subscribe();this.$forceUpdate();var t=this.order.instalments.map((function(e){return{amount:parseFloat(e.amount.value),date:e.date.value}})),s=nsRawCurrency(t.map((function(e){return e.amount})).reduce((function(e,t){return parseFloat(e)+parseFloat(t)})));if(t.filter((function(e){return void 0===e.date||""===e.date})).length>0)return r.kX.error((0,i.__)("One or more instalments has an invalid date.")).subscribe();if(t.filter((function(e){return!(e.amount>0)})).length>0)return r.kX.error((0,i.__)("One or more instalments has an invalid amount.")).subscribe();if(t.filter((function(e){return moment(e.date).isBefore(ns.date.moment.startOf("day"))})).length>0)return r.kX.error((0,i.__)("One or more instalments has a date prior to the current date.")).subscribe();var n=t.filter((function(e){return moment(e.date).isSame(ns.date.moment.startOf("day"),"day")})),o=0;if(n.forEach((function(e){o+=parseFloat(e.amount)})),o<this.expectedPayment)return r.kX.error((0,i.__)("The payment to be made today is less than what is expected.")).subscribe();if(s<nsRawCurrency(this.order.total))return r.kX.error((0,i.__)("Total instalments must be equal to the order total.")).subscribe();t.sort((function(e,t){var s=moment(e.date),n=moment(t.date);return s.isBefore(n)?-1:s.isAfter(n)?1:0}));var c=this.formValidation.extractFields(this.fields);c.final_payment_date=t.reverse()[0].date,c.total_instalments=t.length;var u=a(a(a({},this.$popupParams.order),c),{},{instalments:t}),l=this.$popupParams,d=l.resolve;l.reject;return this.$popup.close(),POS.order.next(u),d(u)},loadFields:function(){var e=this;r.ih.get("/api/nexopos/v4/fields/ns.layaway").subscribe((function(t){e.fields=e.formValidation.createFields(t),e.fields.forEach((function(t){"total_instalments"===t.name&&(t.value=e.order.total_instalments||0)}))}))}}};const d=(0,s(1900).Z)(l,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-lg h-95vh md:h-5/6-screen lg:h-5/6-screen w-95vw md:w-4/6-screen lg:w-3/6-screen ns-box flex flex-col"},[s("div",{staticClass:"p-2 border-b ns-box-header flex justify-between items-center"},[s("h3",{staticClass:"font-semibold"},[e._v(e._s(e.__("Layaway Parameters")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.close()}}})],1)]),e._v(" "),s("div",{staticClass:"p-2 flex-auto flex flex-col relative overflow-y-auto"},[0===e.fields.length?s("div",{staticClass:"absolute h-full w-full flex items-center justify-center"},[s("ns-spinner")],1):e._e(),e._v(" "),s("div",{staticClass:"p-2 elevation-surface info mb-2 text-center text-2xl font-bold flex justify-between"},[s("span",[e._v(e._s(e.__("Minimum Payment")))]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.expectedPayment)))])]),e._v(" "),s("div",e._l(e.fields,(function(e,t){return s("ns-field",{key:t,attrs:{field:e}})})),1),e._v(" "),s("div",{staticClass:"flex flex-col flex-auto overflow-hidden"},[s("div",{staticClass:"border-b ns-box-body"},[s("h3",{staticClass:"text-2xl flex justify-between py-2 text-primary"},[s("span",[e._v(e._s(e.__("Instalments & Payments")))]),e._v(" "),s("p",[s("span",{staticClass:"text-sm"},[e._v("("+e._s(e._f("currency")(e.totalPayments))+")")]),e._v(" "),s("span",[e._v("\n                        "+e._s(e._f("currency")(e.order.total))+"\n                        ")])])]),e._v(" "),s("p",{staticClass:"p-2 mb-2 text-center bg-green-200 text-green-700"},[e._v("\n                    "+e._s(e.__("The final payment date must be the last within the instalments."))+"\n                ")])]),e._v(" "),s("div",{staticClass:"flex-auto overflow-y-auto"},[e._l(e.order.instalments,(function(t,n){return s("div",{key:n,staticClass:"flex w-full -mx-1 py-2"},[s("div",{staticClass:"flex flex-auto"},[s("div",{staticClass:"px-1 w-full md:w-1/2"},[s("ns-field",{attrs:{field:t.date},on:{change:function(t){return e.refreshTotalPayments()}}})],1),e._v(" "),s("div",{staticClass:"px-1 w-full md:w-1/2"},[s("ns-field",{attrs:{field:t.amount},on:{change:function(t){return e.refreshTotalPayments()}}})],1)]),e._v(" "),e._m(0,!0)])})),e._v(" "),0===e.order.instalments.length?s("div",{staticClass:"my-2"},[s("p",{staticClass:"p-2 elevation-surface border text-primary text-center"},[e._v(e._s(e.__("There is no instalment defined. Please set how many instalments are allowed for this order")))])]):e._e()],2)])]),e._v(" "),s("div",{staticClass:"p-2 flex border-t ns-box-footer justify-between flex-shrink-0"},[s("div"),e._v(" "),s("div",{staticClass:"-mx-1 flex"},[s("div",{staticClass:"px-1"},[s("ns-button",{attrs:{type:"error"},on:{click:function(t){return e.close()}}},[e._v(e._s(e.__("Cancel")))])],1),e._v(" "),s("div",{staticClass:"px-1"},[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.updateOrder()}}},[e._v(e._s(e.__("Proceed")))])],1)])])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"flex items-center"},[t("button",{staticClass:"items-center flex justify-center h-8 w-8 rounded border text-primary ns-inset-button error"},[t("i",{staticClass:"las la-times"})])])}],!1,null,null,null).exports},2004:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});const n={name:"ns-pos-loading-popup"};const r=(0,s(1900).Z)(n,(function(){var e=this.$createElement;return(this._self._c||e)("ns-spinner")}),[],!1,null,null,null).exports},8680:(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var n=s(7757),r=s.n(n),i=s(6386);function o(e,t,s,n,r,i,o){try{var a=e[i](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(n,r)}const a={data:function(){return{types:[],typeSubscription:null}},mounted:function(){var e=this;this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&e.resolveIfQueued(!1)})),this.typeSubscription=POS.types.subscribe((function(t){e.types=t,1===Object.values(e.types).length&&e.select(Object.keys(e.types)[0])}))},destroyed:function(){this.typeSubscription.unsubscribe()},methods:{__:s(7389).__,resolveIfQueued:i.Z,select:function(e){var t,s=this;return(t=r().mark((function t(){var n;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Object.values(s.types).forEach((function(e){return e.selected=!1})),s.types[e].selected=!0,n=s.types[e],t.prev=3,t.next=6,POS.triggerOrderTypeSelection(n);case 6:t.sent,POS.types.next(s.types),s.resolveIfQueued(n),t.next=13;break;case 11:t.prev=11,t.t0=t.catch(3);case 13:case"end":return t.stop()}}),t,null,[[3,11]])})),function(){var e=this,s=arguments;return new Promise((function(n,r){var i=t.apply(e,s);function a(e){o(i,n,r,a,c,"next",e)}function c(e){o(i,n,r,a,c,"throw",e)}a(void 0)}))})()}}};const c=(0,s(1900).Z)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"h-full w-4/5-screen md:w-2/5-screen lg:w-2/5-screen xl:w-2/6-screen shadow-lg",attrs:{id:"ns-order-type"}},[s("div",{staticClass:"h-16 flex justify-center items-center",attrs:{id:"header"}},[s("h3",{staticClass:"font-bold"},[e._v(e._s(e.__("Define The Order Type")))])]),e._v(" "),0===Object.values(e.types).length?s("div",{staticClass:"ns-box-body grid grid-flow-row grid-cols-1 grid-rows-1"},[s("div",{staticClass:"h-full w-full flex items-center justify-center flex-col"},[s("i",{staticClass:"las la-frown text-7xl"}),e._v(" "),s("div",{staticClass:"p-4 md:w-2/3"},[s("p",{staticClass:"text-center "},[e._v(e._s(e.__("No payment type has been selected on the settings. Please check your POS features and choose the supported order type")))]),e._v(" "),s("div",{staticClass:"flex justify-center py-1"},[s("ns-link",{attrs:{target:"_blank",type:"info",href:"https://my.nexopos.com/en/documentation/components/order-types"}},[e._v(e._s(e.__("Read More")))])],1)])])]):e._e(),e._v(" "),Object.values(e.types).length>0?s("div",{staticClass:"ns-box-body grid grid-flow-row grid-cols-2 grid-rows-2"},e._l(e.types,(function(t){return s("div",{key:t.identifier,staticClass:"ns-numpad-key info h-56 flex items-center justify-center flex-col cursor-pointer border",class:t.selected?"active":"",on:{click:function(s){return e.select(t.identifier)}}},[s("img",{staticClass:"w-32 h-32",attrs:{src:t.icon,alt:""}}),e._v(" "),s("h4",{staticClass:"font-semibold text-xl my-2"},[e._v(e._s(t.label))])])})),0):e._e()])}),[],!1,null,null,null).exports},567:(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var n=s(9671),r=s(7389);function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,n=new Array(t);s<t;s++)n[s]=e[s];return n}const a={data:function(){return{finalValue:1,virtualStock:null,allSelected:!0,isLoading:!1,keys:[].concat(i([1,2,3].map((function(e){return{identifier:e,value:e}}))),i([4,5,6].map((function(e){return{identifier:e,value:e}}))),i([7,8,9].map((function(e){return{identifier:e,value:e}}))),[{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}])}},mounted:function(){var e=this;this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&(e.$popupParams.reject(!1),e.$popup.close())})),this.$popupParams.product.quantity&&(this.finalValue=this.$popupParams.product.quantity),document.addEventListener("keyup",this.handleKeyPress)},destroyed:function(){document.removeEventListener("keypress",this.handleKeyPress)},methods:{__:r.__,closePopup:function(){this.$popupParams.reject(!1),this.$popup.close()},handleKeyPress:function(e){13===e.keyCode&&this.inputValue({identifier:"next"})},inputValue:function(e){if("next"===e.identifier){var t=this.$popupParams,s=t.product,i=t.data,o=parseFloat(this.finalValue);if(0===o)return n.kX.error((0,r.__)("Please provide a quantity")).subscribe();if("enabled"===s.$original().stock_management){var a=POS.getStockUsage(s.$original().id,i.unit_quantity_id)-(s.quantity||0);if(o>parseFloat(i.$quantities().quantity)-a)return n.kX.error((0,r.__)("Unable to add the product, there is not enough stock. Remaining %s").replace("%s",i.$quantities().quantity-a)).subscribe()}this.resolve({quantity:o})}else"backspace"===e.identifier?this.allSelected?(this.finalValue=0,this.allSelected=!1):(this.finalValue=this.finalValue.toString(),this.finalValue=this.finalValue.substr(0,this.finalValue.length-1)||0):this.allSelected?(this.finalValue=e.value,this.finalValue=parseFloat(this.finalValue),this.allSelected=!1):(this.finalValue+=""+e.value,this.finalValue=parseFloat(this.finalValue))},resolve:function(e){this.$popupParams.resolve(e),this.$popup.close()}}};const c=(0,s(1900).Z)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-box shadow min-h-2/5-screen w-3/4-screen md:w-3/5-screen lg:w-2/5-screen xl:w-2/5-screen relative"},[e.isLoading?s("div",{staticClass:"flex w-full h-full absolute top-O left-0 items-center justify-center",staticStyle:{background:"rgb(202 202 202 / 49%)"},attrs:{id:"loading-overlay"}},[s("ns-spinner")],1):e._e(),e._v(" "),s("div",{staticClass:"flex-shrink-0 flex justify-between items-center p-2 border-b ns-box-header"},[s("div",[s("h1",{staticClass:"text-xl font-bold text-primary text-center"},[e._v(e._s(e.__("Define Quantity")))])]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)]),e._v(" "),s("div",{staticClass:"h-16 border-b primary ns-box-body flex items-center justify-center",attrs:{id:"screen"}},[s("h1",{staticClass:"font-bold text-3xl"},[e._v(e._s(e.finalValue))])]),e._v(" "),s("div",{staticClass:"ns-box-body grid grid-flow-row grid-cols-3 grid-rows-3",attrs:{id:"numpad"}},e._l(e.keys,(function(t,n){return s("div",{key:n,staticClass:"ns-numpad-key info text-xl font-bold border h-24 flex items-center justify-center cursor-pointer",on:{click:function(s){return e.inputValue(t)}}},[void 0!==t.value?s("span",[e._v(e._s(t.value))]):e._e(),e._v(" "),t.icon?s("i",{staticClass:"las",class:t.icon}):e._e()])})),0)])}),[],!1,null,null,null).exports},9702:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var n=s(9671),r=s(6386),i=s(7266);function o(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function a(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?o(Object(s),!0).forEach((function(t){c(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function c(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const u={name:"ns-pos-shipping-popup",computed:{activeTabFields:function(){if(null!==this.tabs)for(var e in this.tabs)if(this.tabs[e].active)return this.tabs[e].fields;return[]},useBillingInfo:function(){return null!==this.tabs?this.tabs.billing.fields[0].value:new Object},useShippingInfo:function(){return null!==this.tabs?this.tabs.shipping.fields[0].value:new Object}},destroyed:function(){this.orderSubscription.unsubscribe()},mounted:function(){var e=this;this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&e.resolveIfQueued(!1)})),this.orderSubscription=POS.order.subscribe((function(t){return e.order=t})),this.loadForm()},data:function(){return{tabs:null,orderSubscription:null,order:null,formValidation:new i.Z}},watch:{useBillingInfo:function(e){var t=this;1===e&&this.tabs.billing.fields.forEach((function(e){"_use_customer_billing"!==e.name&&(e.value=t.order.customer.billing?t.order.customer.billing[e.name]:e.value)}))},useShippingInfo:function(e){var t=this;1===e&&this.tabs.shipping.fields.forEach((function(e){"_use_customer_shipping"!==e.name&&(e.value=t.order.customer.shipping?t.order.customer.shipping[e.name]:e.value)}))}},methods:{__,resolveIfQueued:r.Z,submitInformations:function(){var e=this.formValidation.extractForm({tabs:this.tabs});for(var t in e.general)["shipping","shipping_rate"].includes(t)&&(e.general[t]=parseFloat(e.general[t]));this.order=a(a({},this.order),e.general),delete e.general,delete e.shipping._use_customer_shipping,delete e.billing._use_customer_billing,this.order.addresses=e,POS.order.next(this.order),POS.refreshCart(),this.resolveIfQueued(!0)},closePopup:function(){this.resolveIfQueued(!1)},toggle:function(e){for(var t in this.tabs)this.tabs[t].active=!1;this.tabs[e].active=!0},loadForm:function(){var e=this;n.ih.get("/api/nexopos/v4/forms/ns.pos-addresses").subscribe((function(t){var s=t.tabs,n=function(t){"general"===t?s[t].fields.forEach((function(t){t.value=e.order[t.name]||""})):s[t].fields.forEach((function(s){s.value=e.order.addresses[t]?e.order.addresses[t][s.name]:""}))};for(var r in s)n(r);e.tabs=e.formValidation.initializeTabs(s)}))}}};const l=(0,s(1900).Z)(u,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-box w-6/7-screen md:w-4/5-screen lg:w-3/5-screen h-6/7-screen md:h-4/5-screen shadow-lg flex flex-col overflow-hidden"},[s("div",{staticClass:"p-2 border-b ns-box-header flex justify-between items-center"},[s("h3",{staticClass:"font-bold text-primary"},[e._v(e._s(e.__("Shipping & Billing")))]),e._v(" "),s("div",{staticClass:"tools"},[s("button",{staticClass:"ns-close-button rounded-full h-8 w-8 border items-center justify-center",on:{click:function(t){return e.closePopup()}}},[s("i",{staticClass:"las la-times"})])])]),e._v(" "),s("div",{staticClass:"flex-auto ns-box-body p-2 overflow-y-auto ns-tab"},[s("div",{attrs:{id:"tabs-container"}},[s("div",{staticClass:"header flex",staticStyle:{"margin-bottom":"-1px"}},e._l(e.tabs,(function(t,n){return s("div",{key:n,staticClass:"tab rounded-tl rounded-tr border tab  px-3 py-2 text-primary cursor-pointer",class:t.active?"border-b-0 active":"inactive",staticStyle:{"margin-right":"-1px"},on:{click:function(t){return e.toggle(n)}}},[e._v(e._s(t.label))])})),0),e._v(" "),s("div",{staticClass:"border ns-tab-item"},[s("div",{staticClass:"px-4"},[s("div",{staticClass:"-mx-4 flex flex-wrap"},e._l(e.activeTabFields,(function(t,n){return s("div",{key:n,class:"p-4 w-full md:w-1/2 lg:w-1/3"},[s("ns-field",{attrs:{field:t},on:{blur:function(s){return e.formValidation.checkField(t)},change:function(s){return e.formValidation.checkField(t)}}})],1)})),0)])])])]),e._v(" "),s("div",{staticClass:"p-2 flex justify-between border-t ns-box-footer"},[s("div"),e._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.submitInformations()}}},[e._v(e._s(e.__("Save")))])],1)])])}),[],!1,null,null,null).exports},9089:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});const n={data:function(){return{title:"",message:"",input:""}},computed:{size:function(){return this.$popupParams.size||"h-full w-full"}},mounted:function(){var e=this;this.input=this.$popupParams.input||"",this.title=this.$popupParams.title,this.message=this.$popupParams.message,this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&(e.$popupParams.reject(!1),e.$popup.close())}))},methods:{__:s(7389).__,emitAction:function(e){this.$popupParams.onAction(e?this.input:e),this.$popup.close()},reject:function(e){void 0!==this.$popupParams.reject&&this.$popupParams.reject(e),this.$popup.close()}}};const r=(0,s(1900).Z)(n,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"w-5/7-screen md:w-3/7-screen flex flex-col shadow-lg",class:e.size,attrs:{id:"prompt-popup"}},[s("div",{staticClass:"flex items-center justify-center flex-col flex-auto p-2"},[s("h2",{staticClass:"text-3xl font-body"},[e._v(e._s(e.title))]),e._v(" "),s("p",{staticClass:"w-full md:mx-auto md:w-2/3 py-4 text-center"},[e._v(e._s(e.message))])]),e._v(" "),s("div",{staticClass:"p-2"},[s("div",{staticClass:"ns-input"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.input,expression:"input"}],staticClass:"w-full border-2 p-2",attrs:{name:"",id:"",cols:"30",rows:"10"},domProps:{value:e.input},on:{input:function(t){t.target.composing||(e.input=t.target.value)}}})])]),e._v(" "),s("div",{staticClass:"flex border-t action-buttons"},[s("button",{staticClass:"flex-auto w-1/2 h-16 flex items-center justify-center uppercase",on:{click:function(t){return e.emitAction(!0)}}},[e._v(e._s(e.__("Ok")))]),e._v(" "),s("hr",{staticClass:"border-r"}),e._v(" "),s("button",{staticClass:"flex-auto w-1/2 h-16 flex items-center justify-center uppercase",on:{click:function(t){return e.reject(!1)}}},[e._v(e._s(e.__("Cancel")))])])])}),[],!1,null,null,null).exports},3472:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var n=s(8603),r=s(7389);const i={data:function(){return{value:[],options:[],label:null,type:"select"}},computed:{},mounted:function(){this.popupCloser(),this.value=this.$popupParams.value||[],this.options=this.$popupParams.options,this.label=this.$popupParams.label,this.type=this.$popupParams.type||this.type},methods:{popupCloser:n.Z,__:r.__,toggle:function(e){var t=this.value.indexOf(e);-1===t?this.value.unshift(e):this.value.splice(t,1)},isSelected:function(e){return this.value.indexOf(e)>=0},close:function(){this.$popupParams.reject(!1),this.$popup.close()},select:function(e){void 0!==e&&(this.value=[e]),this.$popupParams.resolve(this.value),this.close()}}};const o=(0,s(1900).Z)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-xl ns-box w-6/7-screen md:w-4/7-screen lg:w-3/7-screen overflow-hidden"},[s("div",{staticClass:"p-2 flex justify-between border-b items-center ns-box-header"},[s("span",{staticClass:"text-semibold text-primary"},[e._v("\n            "+e._s(e.label)+"\n        ")]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.close()}}})],1)]),e._v(" "),s("div",{staticClass:"flex-auto overflow-y-auto"},[s("ul",{staticClass:"ns-vertical-menu"},["select"===e.type?e._l(e.options,(function(t){return s("li",{key:t.value,staticClass:"p-2 border-b border-box-edge text-primary cursor-pointer",on:{click:function(s){return e.select(t)}}},[e._v(e._s(t.label))])})):e._e(),e._v(" "),"multiselect"===e.type?e._l(e.options,(function(t){return s("li",{key:t.value,staticClass:"p-2 border-b text-primary cursor-pointer",class:e.isSelected(t)?"active":"",on:{click:function(s){return e.toggle(t)}}},[e._v(e._s(t.label))])})):e._e()],2)]),e._v(" "),"multiselect"===e.type?s("div",{staticClass:"flex justify-between"},[s("div"),e._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.select()}}},[e._v(e._s(e.__("Select")))])],1)]):e._e()])}),[],!1,null,null,null).exports}},e=>{e.O(0,[898],(()=>{return t=6985,e(e.s=t);var t}));e.O()}]);